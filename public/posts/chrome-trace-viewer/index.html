<!DOCTYPE html>
<html>

<head>
  <meta content="width=device-width,initial-scale=1" name="viewport" />
  <meta charset="UTF-8">
  <link rel="icon" href="https://fav.farm/ğŸ‘»" />
  <title>
å¼ºå¤§çš„å¯è§†åŒ–åˆ©å™¨ Chrome Trace Viewer ä½¿ç”¨è¯¦è§£
</title>
  <link rel="stylesheet" href="/assets/main.css?gkCPK9ibGk2PIXzFp9c+CG7gIjpFY2pNyZ+E7aXMGlU=" />
  <script async defer data-domain="limboy.me" src="https://analytics.limboy.me/js/plausible.js"></script>
  
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@_limboy">
<meta name="twitter:site" content="@_limboy">
<meta property="og:url" content="https://limboy.me/posts/chrome-trace-viewer/">

<meta name="twitter:title" content="å¼ºå¤§çš„å¯è§†åŒ–åˆ©å™¨ Chrome Trace Viewer ä½¿ç”¨è¯¦è§£">
<meta property="og:title" content="å¼ºå¤§çš„å¯è§†åŒ–åˆ©å™¨ Chrome Trace Viewer ä½¿ç”¨è¯¦è§£">

<meta property="og:description" content="">
<meta name="twitter:description" content="">



</head>

<body class="  ">
  <nav class="flex justify-center items-center opacity-80 bg-black h-12 py-0 ">
    <div class="inner flex justify-between flex-row mx-1">
      <ul class="color-white flex flex-row justify-start gap-4">
        <li><a class="nav-link opacity-90 text-2xl" href="/">Limboy</a></li>
        <!--<li><a class="nav-link" href="/coodle">Coodle</a></li>-->
      </ul>
      <ul class="color-white flex flex-row gap-4 items-center text-base">
        <!--<li> <a class="nav-link" href="/books" class="decoration-0"> Books </a> </li>-->
        <li> <a class="nav-link" href="/highlights" class="decoration-0"> Highlights </a> </li>
        <li> <a class="nav-link" href="/projects" class="decoration-0"> Projects </a> </li>
        <li> <a class="nav-link" href="/about" class="decoration-0"> About </a> </li>
      </ul>
    </div>
  </nav>

  <div class="flex flex-col">
    <div id="wrapper" class="flex justify-center" style="min-height: calc(100vh - 6.5rem);">
      <div class="inner mb-2">
        
<div class="mt-4 lg:mt-6">
  

  <h1 class="title font-medium text-3xl"><a href="https:&#x2F;&#x2F;limboy.me&#x2F;posts&#x2F;chrome-trace-viewer&#x2F;">å¼ºå¤§çš„å¯è§†åŒ–åˆ©å™¨ Chrome Trace Viewer ä½¿ç”¨è¯¦è§£</a></h1>
  <div class="flex gap-4 items-center my-1">
    <time class="text-gray-500">2020-03-21</time>

  </div>
  <hr class="border-t-[3px]" />

  <div class="prose lg:prose-xl max-w-full my-6">
    
<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;chrome-trace-viewer&#x2F;b580eea70090ee05b7c8885712df2b271395a8b4.png"
        width="1390" /></p>
<p>æœ€è¿‘ç ”ç©¶äº†ä¸‹ Chrome è‡ªå¸¦çš„ Trace Viewerï¼Œå‘ç°åŠŸèƒ½è¿˜æŒºå¼ºå¤§çš„ï¼Œç”¨æ¥åš Performance Profileï¼ŒTimeline Tracing ç­‰å¾ˆæ–¹ä¾¿ï¼Œä½†å®˜æ–¹çš„ä½¿ç”¨æ–‡æ¡£æ¯”è¾ƒæ™¦æ¶©ï¼Œèµ„æ–™ä¹Ÿæ¯”è¾ƒåŒ®ä¹å’Œåˆ†æ•£ï¼Œå°±ä¸“é—¨æ•´ç†äº†ä¸‹ã€‚</p>
<blockquote>
<p>æ³¨ï¼šTrace Viewer å…¶å®å¯ä»¥è„±ç¦» <code>chrome://tracing</code> åœ¨çº¿ä½¿ç”¨ï¼Œå…·ä½“æ“ä½œåé¢ä¼šè®²åˆ°</p>
</blockquote>
<h2 id="trace-viewer-jie-shao">Trace Viewer ä»‹ç»</h2>
<blockquote>
<p>Trace-Viewer is the javascript frontend for Chrome <code>about:tracing</code> and Android <code>systrace</code>. providing rich analysis and visualization capabilities for trace files, supporting both the linux kernel trace format and Chrome's base/trace_event.</p>
</blockquote>
<p>å®ƒæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¯è§†åŒ–å±•ç¤ºå’Œåˆ†æå·¥å…·ï¼Œä¹‹å‰ google æœ‰ä¸€ä¸ªä¸“é—¨çš„ trace-viewer é¡¹ç›®ï¼Œç°åœ¨è¯¥é¡¹ç›®åˆå¹¶åˆ°äº† <a href="https://github.com/catapult-project/catapult/blob/master/tracing/README.md">catapult</a> ä¸­, catapult æ˜¯ Chromium å·¥ç¨‹å¸ˆå¼€å‘çš„ä¸€ç³»åˆ—æ€§èƒ½å·¥å…·çš„åˆé›†ï¼Œå¯ä»¥ç”¨æ¥æ”¶é›†ã€å±•ç¤ºã€åˆ†æ Chromeã€Website ç”šè‡³ Android çš„æ€§èƒ½ã€‚</p>
<p>catapult æºç é‡ŒåŒ…å«äº†å¾ˆå¤š test caseï¼Œgit clone ä¸‹æ¥åï¼Œè¿è¡Œ <code>$CATAPULT/bin/run_dev_server</code>. ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <code>http://localhost:8003/tracing_examples/trace_viewer.html</code> èƒ½çœ‹åˆ°å¾ˆå¤š Demo</p>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;chrome-trace-viewer&#x2F;b45847555835cc49338b5d58c50fd5f656b4e681.jpg"
        width="1377" /></p>
<p>ä¸è¿‡ Google ç›®å‰æ­£åœ¨å¼€å‘å¦ä¸€å¥—å·¥å…· <a href="https://ui.perfetto.dev/#!/">perfetto</a> æ‰“ç®—æ›¿æ¢ Trace Viewerï¼Œæˆ‘åˆæ­¥ä½¿ç”¨äº†ä¸‹ï¼Œæ„Ÿè§‰ä¸å¦‚ Trace Viewer ç®€æ´ã€‚</p>
<h2 id="zai-kai-yuan-xiang-mu-zhong-de-shi-yong">åœ¨å¼€æºé¡¹ç›®ä¸­çš„ä½¿ç”¨</h2>
<p>Golang ç”¨å®ƒæ¥å¯è§†åŒ–å±•ç¤ºæ‰§è¡Œè¿‡ç¨‹ https://golang.org/cmd/trace/</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>go test -trace trace.out pkg
</span><span>go tool trace trace.out
</span></code></pre>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;chrome-trace-viewer&#x2F;49df6cdfe957da75a44c5a074e02d5e7b80dedc1.jpg"
        width="2098" /></p>
<p>Facebook çš„ Buck Build ç³»ç»Ÿï¼Œç”¨å®ƒæ¥å±•ç¤º Build æ—¶å‘ç”Ÿäº†ä»€ä¹ˆ</p>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;chrome-trace-viewer&#x2F;a3adb318505c4c13881b90eb2b031f8afb977da7.png"
        width="900" /></p>
<p>ä»è¿™ä¸¤ä¸ªé¡¹ç›®å¯ä»¥çœ‹å‡ºæ¥ Trace Viewer å¯¹äºå‘ˆç°ã€ŒæŸæ®µæ—¶é—´å‘ç”Ÿäº†ä»€ä¹ˆã€ è¿˜æ˜¯æœ‰è¿‡äººä¹‹å¤„ã€‚</p>
<h2 id="trace-viewer-format">Trace Viewer Format</h2>
<p>Trace Viewer æœ‰ä¸€å¥—è‡ªå·±çš„ <a href="https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/edit">Trace Event Format</a>ï¼Œåªè¦æ–‡ä»¶éµå¾ªè¿™ä¸ªæ ¼å¼ï¼Œå°±å¯ä»¥è¢«å±•ç¤ºã€‚æ¯”å¦‚ï¼š</p>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;chrome-trace-viewer&#x2F;23d3a314c8c47e6ea8bf35f46d0e58ea7c9a62be.png"
        width="1630" /></p>
<p>å¯¹åº”çš„ json æ–‡ä»¶å†…å®¹ï¼š</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>[ {&quot;name&quot;: &quot;å‡ºæ–¹æ¡ˆ&quot;, &quot;ph&quot;: &quot;B&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 0},
</span><span>  {&quot;name&quot;: &quot;å‡ºæ–¹æ¡ˆ&quot;, &quot;ph&quot;: &quot;E&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 28800000000},
</span><span>  {&quot;name&quot;: &quot;çœ‹ç”µå½±&quot;, &quot;ph&quot;: &quot;B&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;ä¼‘é—²&quot;, &quot;ts&quot;: 28800000000},
</span><span>  {&quot;name&quot;: &quot;çœ‹ç”µå½±&quot;, &quot;ph&quot;: &quot;E&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;ä¼‘é—²&quot;, &quot;ts&quot;: 32400000000},
</span><span>  {&quot;name&quot;: &quot;å†™ä»£ç &quot;, &quot;ph&quot;: &quot;B&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 32400000000},
</span><span>  {&quot;name&quot;: &quot;å†™ä»£ç &quot;, &quot;ph&quot;: &quot;E&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 36000000000},
</span><span>  {&quot;name&quot;: &quot;é›ç‹—&quot;, &quot;ph&quot;: &quot;B&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;ä¼‘é—²&quot;, &quot;ts&quot;: 36000000000},
</span><span>  {&quot;name&quot;: &quot;é›ç‹—&quot;, &quot;ph&quot;: &quot;E&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;ä¼‘é—²&quot;, &quot;ts&quot;: 37800000000}
</span><span>]
</span></code></pre>
<p>æ¯ä¸€ä¸ª Event ä¸»è¦ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>{
</span><span>  &quot;name&quot;: &quot;myName&quot;, // äº‹ä»¶åï¼Œä¼šå±•ç¤ºåœ¨ timeline ä¸Š
</span><span>  &quot;cat&quot;: &quot;category,list&quot;, // äº‹ä»¶åˆ†ç±»ï¼Œç±»ä¼¼ Tagï¼Œä½† UI ä¸Šä¸æ”¯æŒé€‰æ‹© Tag
</span><span>  &quot;ph&quot;: &quot;B&quot;, // phaseï¼Œåé¢ç€é‡ä¼šè®²åˆ°
</span><span>  &quot;ts&quot;: 12345, // äº‹ä»¶å‘ç”Ÿæ—¶çš„æ—¶é—´æˆ³ï¼Œä»¥å¾®ç§’è¡¨ç¤º
</span><span>  &quot;pid&quot;: 123, // è¿›ç¨‹å
</span><span>  &quot;tid&quot;: 456, // çº¿ç¨‹å
</span><span>  &quot;args&quot;: { // é¢å¤–å‚æ•°ï¼Œå½“é€‰ä¸­æŸä¸ª event åï¼Œä¼šåœ¨åº•éƒ¨çš„é¢æ¿å±•ç¤º
</span><span>    &quot;someArg&quot;: 1,
</span><span>    &quot;anotherArg&quot;: {
</span><span>      &quot;value&quot;: &quot;my value&quot;
</span><span>    }
</span><span>  }
</span><span>}
</span></code></pre>
<p>å…¶ä¸­æœ€é‡è¦çš„æ˜¯ <code>ph</code>ï¼Œæœ€å¸¸ç”¨çš„ç»„åˆæ˜¯ <code>B</code> å’Œ <code>E</code>ï¼Œåˆ†åˆ«è¡¨ç¤º <code>Begin</code> å’Œ <code>End</code>ï¼Œæœ‰äº†è¿™ä¸¤ä¸ªä¿¡æ¯ï¼ŒTrace Viewer å°±èƒ½åœ¨ timeline ä¸Šæ‰¾åˆ°èµ·æ­¢ç‚¹ï¼Œå°†å®ƒç»˜åˆ¶å‡ºæ¥ã€‚ä¹Ÿå¯ä»¥ç®€åŒ–ä¸º <code>X</code>ï¼Œç„¶ååŠ ä¸Š <code>dur</code> è¡¨ç¤º duration</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>[ {&quot;name&quot;: &quot;å‡ºæ–¹æ¡ˆ&quot;, &quot;ph&quot;: &quot;X&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 0, &quot;dur&quot;: 28800000000},
</span><span>  {&quot;name&quot;: &quot;çœ‹ç”µå½±&quot;, &quot;ph&quot;: &quot;X&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;ä¼‘é—²&quot;, &quot;ts&quot;: 28800000000, &quot;dur&quot;: 360000000},
</span><span>  {&quot;name&quot;: &quot;å†™ä»£ç &quot;, &quot;ph&quot;: &quot;X&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 32400000000, &quot;dur&quot;: 360000000},
</span><span>  {&quot;name&quot;: &quot;é›ç‹—&quot;, &quot;ph&quot;: &quot;X&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;ä¼‘é—²&quot;, &quot;ts&quot;: 36000000000, &quot;dur&quot;: 180000000},
</span><span>]
</span></code></pre>
<p>ä½†é¢œè‰²çœ‹èµ·æ¥æœ‰ç‚¹éšæœºï¼Œèƒ½ä¸èƒ½è‡ªå®šä¹‰å‘¢ï¼Œå¯ä»¥çš„ï¼Œè¿™æ—¶å°±è¦ç”¨åˆ° <code>cname</code> è¿™ä¸ªå‚æ•°ï¼š</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span> {&quot;name&quot;: &quot;å‡ºæ–¹æ¡ˆ&quot;, &quot;cname&quot;: &quot;good&quot;, &quot;ph&quot;: &quot;X&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 0, &quot;dur&quot;: 28800000000},
</span></code></pre>
<p>å°† <code>cname</code> è®¾ç½®ä¸º <code>good</code>ï¼Œè§†è§‰ä¸Šä¼šçœ‹åˆ°ç»¿è‰²ï¼Œåœ¨<a href="https://github.com/catapult-project/catapult/blob/master/tracing/tracing/base/color_scheme.html">è¿™é‡Œ</a>æœ‰å¯é€‰çš„ cname åˆ—è¡¨ï¼ˆè—çš„çœŸå¤Ÿæ·±Â·Â·Â·ï¼‰</p>
<p>å·¦è¾¹çš„ <code>Process Main</code> èƒ½ä¸èƒ½ä¹Ÿè¿›è¡Œä¸ªæ€§åŒ–å®šåˆ¶ä»¥æ˜¾å¾—ä¸é‚£ä¹ˆçªå…€å‘¢ï¼Ÿæ¯”å¦‚å°†å®ƒæ”¹æˆã€Œæ—¶é—´çº¿ã€</p>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;chrome-trace-viewer&#x2F;2b199fda93a030e4ceaa09317e67bfd4407a08b1.png"
        width="1478" /></p>
<p>è¿™å°±è¦ä½¿ç”¨ MetaData Phase äº†</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>{&quot;name&quot;: &quot;process_name&quot;, &quot;ph&quot;: &quot;M&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;args&quot;: {&quot;name&quot;: &quot;æ—¶é—´çº¿&quot;}}
</span></code></pre>
<p>å®ƒçš„è¡¨ç¤ºæ–¹å¼æ˜¯å°† <code>ph</code> è®¾ä¸º <code>M</code>ï¼Œç„¶åå°† <code>name</code> è®¾ä¸º <a href="https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/edit#heading=h.xqopa5m0e28f">5 ç§å¯é€‰å€¼</a>ä¸­çš„ä¸€ç§ï¼Œæ¯”å¦‚ <code>process_name</code> åˆ™è¡¨ç¤ºè¦å¯¹è¿›ç¨‹ååšä¸€äº›å®šåˆ¶ã€‚metadata ä¸»è¦æ˜¯ç”¨æ¥ä¸ºæŸä¸€ç±» event æä¾›æ›´å¤šçš„ä¿¡æ¯ï¼Œæ¯”å¦‚è‡ªå®šä¹‰åå­—æˆ–é‡æ–°è®¾ç½®æ’åºä¼˜å…ˆçº§ã€‚</p>
<p>æœ‰ä¸€äº›äº‹ä»¶ï¼Œå®ƒä¸æ˜¯æ‰§è¡Œè€—æ—¶ï¼Œä½†åŒ…å«äº†å…¶ä»–äº‹ä»¶ï¼Œæ¯”å¦‚ã€Œæˆ‘çš„ä¸€å¤©ã€ï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªå¯è¢«æ‰§è¡Œçš„äº‹ä»¶ï¼Œä½†å°†ä¸€å¤©åšçš„äº‹æƒ…åŒ…å«è¿›æ¥ã€‚è¿™äº›è¢«ç§°ä¸ºã€Œå¼‚æ­¥äº‹ä»¶ã€ï¼Œè¡¨ç°ä¸Šå°±åƒè¿™æ ·ï¼š</p>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;chrome-trace-viewer&#x2F;b918640dca619c8e393599f7096a26043fd70f72.png"
        width="1514" /></p>
<p>ç‹¬å ä¸€æ ï¼ŒåŒæ—¶ä½¿ç”¨äº†æ–œä½“å­—ï¼Œå¦‚æœä»”ç»†çœ‹ï¼Œè¿˜ä¼šå‘ç°é¡¶éƒ¨å¤šäº†ä¸€æ¡é»‘è‰²çš„çº¿ã€‚å¼‚æ­¥äº‹ä»¶çš„ <code>ph</code> ä¸º <code>b</code> å’Œ <code>e</code> ä¹Ÿæ˜¯ Begin å’Œ Endï¼Œåªä¸è¿‡å˜æˆäº†å°å†™ï¼ŒåŒæ—¶è¿˜è¦æä¾› <code>id</code> å’Œ <code>cat</code></p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>[
</span><span>  {&quot;name&quot;: &quot;æˆ‘çš„ä¸€å¤©&quot;, &quot;ph&quot;: &quot;b&quot;, &quot;cat&quot;: &quot;daily&quot;, &quot;id&quot;: &quot;my-day&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 0},
</span><span>  {&quot;name&quot;: &quot;æˆ‘çš„ä¸€å¤©&quot;, &quot;ph&quot;: &quot;e&quot;, &quot;cat&quot;: &quot;daily&quot;, &quot;id&quot;: &quot;my-day&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 37800000000},
</span><span>]
</span></code></pre>
<p>id ç”¨æ¥å”¯ä¸€æ ‡è¯†ä¸¤ä¸ªå¼‚æ­¥äº‹ä»¶æ˜¯ä¸æ˜¯åº”è¯¥è¢«ä½œä¸ºåŒä¸€ä¸ªæ¥çœ‹å¾…ï¼ˆæœ‰å¯èƒ½å¤šä¸ªå¼‚æ­¥äº‹ä»¶åå­—éƒ½ä¸€æ ·ï¼‰ï¼Œcat ä¹Ÿæ˜¯å¿…é€‰é¡¹ï¼Œè¿™ä¸ªä¸å¤ªç†è§£ï¼Œå¯èƒ½ç­‰å¾…çš„æ—¶é—´å¤ªå­¤ç‹¬ï¼Œéœ€è¦ä¸€åªçŒ«æ¥é™ªä¼´å§ã€‚</p>
<p>ä¸€ä»¶äº‹å¯èƒ½ä¼šè¢«æ‹†åˆ†ä¸ºæ›´å°çš„å•å…ƒï¼Œç„¶åæ‰§è¡Œè¿‡ç¨‹ä¸­ä¹Ÿä¼šç©¿æ’ç€å…¶ä»–çš„äº‹ä»¶ï¼Œé’ˆå¯¹è¿™æ ·çš„åœºæ™¯ï¼Œå¯ä»¥é€šè¿‡ <code>Flow Event</code> æ¥è¡¨ç¤º</p>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;chrome-trace-viewer&#x2F;7a54bb4d237b14089e5bc83a2f9329b686c941c8.jpg"
        width="1434" /></p>
<p>æ³¨æ„ï¼Œåœ¨ã€Œå‡ºæ–¹æ¡ˆã€å’Œã€Œå†™ä»£ç ã€ä¹‹é—´å¤šäº†ä¸€æ¡çº¿</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>  {&quot;name&quot;: &quot;å‡ºæ–¹æ¡ˆ&quot;, &quot;cname&quot;: &quot;good&quot;,&quot;ph&quot;: &quot;X&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 0, &quot;dur&quot;: 28800000000},
</span><span>  {&quot;name&quot;: &quot;connect&quot;, &quot;ph&quot;: &quot;s&quot;, &quot;id&quot;: &quot;my-work&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 28800000000},
</span><span>  {&quot;name&quot;: &quot;connect&quot;, &quot;ph&quot;: &quot;f&quot;, &quot;bp&quot;: &quot;e&quot;, &quot;id&quot;: &quot;my-work&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 32400000000},
</span><span>  {&quot;name&quot;: &quot;å†™ä»£ç &quot;, &quot;ph&quot;: &quot;X&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 32400000000, &quot;dur&quot;: 3600000000},
</span></code></pre>
<p><code>Flow Event</code> ph çš„å¼€å§‹å’Œç»“æŸåˆ†åˆ«ä¸º <code>s(start)</code> å’Œ <code>f(finish)</code>ï¼Œè·Ÿ <code>Async Event</code> æœ‰ç‚¹åƒï¼Œä½†æœ‰å‡ ç‚¹ä¸åŒï¼š</p>
<ul>
<li>ä¸éœ€è¦å¸¦ä¸Š cat</li>
<li>åŒä¸€ä¸ª Flow Eventï¼Œé™¤äº† id ç›¸åŒå¤–ï¼Œåå­—ä¹Ÿå¿…é¡»ç›¸åŒ</li>
<li>ç»“æŸæ—¶ç”¨ <code>&quot;bp&quot;: &quot;e&quot;</code> æ¥è¡¨ç¤º</li>
</ul>
<p>Flow Event éœ€è¦ä¾é™„åœ¨å·²æœ‰çš„ Event ä¸Šï¼Œä¾é™„çš„è¿‡ç¨‹å…¶å®å°±æ˜¯ ts åŒ¹é…ï¼Œç›¸åŒ/æœ€è¿‘ ts çš„ Event ä¼šè‡ªåŠ¨è¢«åŒ¹é…åˆ°ã€‚</p>
<p>å‡ºæ–¹æ¡ˆçš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šæœ‰çºªå¿µæ„ä¹‰çš„äº‹ä»¶éœ€è¦è®°å½•ä¸‹ï¼Œæ¯”å¦‚æƒ³åˆ°äº†æŸä¸ªç‚¹å­ï¼Œè¿™æ—¶å¯ä»¥ç”¨ <code>ph: &quot;I&quot;</code> æ¥è¡¨ç¤ºï¼ˆInstantï¼‰</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>{&quot;name&quot;: &quot;æƒ³åˆ°ä¸€ä¸ªç‚¹å­&quot;, &quot;ph&quot;: &quot;I&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 18800000000}
</span></code></pre>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;chrome-trace-viewer&#x2F;9fafe4e26805bce1fde36f7970389735fa66ec5a.jpg"
        width="1482" /></p>
<p>ä¸­é—´é‚£æ ¹çº¢çº¿å°±æ˜¯æˆ‘ä»¬åˆšåŠ çš„äº‹ä»¶ï¼Œé€‰ä¸­ä¹‹åä¼šåœ¨åº•éƒ¨å‡ºç°è¯¥äº‹ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªä¸Šè¿›çš„é’å¹´ï¼Œä¸€å¤©ä¸‹æ¥ä¹‹åï¼Œéœ€è¦ç•™ä¸€æ®µæ—¶é—´åæ€ä»Šå¤©åšçš„å¥½çš„å’Œä¸å¥½çš„ï¼Œè¿™å¯ä»¥é€šè¿‡ Snapshot æ¥ä½“ç°ï¼Œå°±åƒè¿™æ ·</p>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;chrome-trace-viewer&#x2F;200ba2a883121853011e9e0c22757929ee257a84.png"
        width="1272" /></p>
<p>å³ä¸Šè§’é‚£ä¸ªåœ†ç‚¹å°±æ˜¯ Snapshot åœ¨ Timeline ä¸Šçš„è¡¨ç°ï¼Œç‚¹å‡»ä¹‹åå¯ä»¥åœ¨åº•éƒ¨çœ‹åˆ°è¯¦ç»†å†…å®¹ã€‚</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>{&quot;name&quot;: &quot;åæ€&quot;, &quot;ph&quot;: &quot;O&quot;, &quot;id&quot;: &quot;Ref&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å…¶ä»–&quot;, &quot;ts&quot;: 37800000000, &quot;args&quot;: {&quot;snapshot&quot;: &quot;å……å®çš„ä¸€å¤©å‘¢&quot;}}
</span></code></pre>
<p>Snapshot çš„ ph ä¸º <code>O</code> ï¼ˆå­—æ¯ Oï¼‰ï¼Œæ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Œè¯¦ç»†çš„å†…å®¹å¾€ <code>args.snapshot</code> é‡Œæ”¾å°±å¯ä»¥äº†ã€‚</p>
<p>è¿™äº›å·®ä¸å¤šå°±æ˜¯å¸¸ç”¨çš„ ph äº†ï¼Œéƒ¨åˆ† ph ä¼šæœ‰é™„å¸¦çš„è§„åˆ™ï¼Œå†ç®€å•æ€»ç»“ä¸‹ï¼š</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>ph B/E // æ­£å¸¸çš„å¼€å§‹/ç»“æŸäº‹ä»¶ï¼Œæœ€å¸¸è§ï¼Œä¹Ÿå¯ä»¥ç”¨ X + dur æ¥è¡¨ç¤º
</span><span>ph M // Metadata ç”¨æ¥å¯¹ä¸€ç±» Event é™„åŠ æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œå¯ä»¥å¸¦æ¥ UI ä¸Šçš„å˜åŒ–
</span><span>ph I // ç¬æ—¶äº‹ä»¶ï¼Œç±»ä¼¼ Mark ä¸€ä¸‹
</span><span>ph s/e // å¼‚æ­¥äº‹ä»¶ï¼Œè¡¨ç¤ºè‡ªå®šä¹‰çš„ä¸€ä¸ªäº‹ä»¶ï¼Œè¡¨ç°ä¸Šè·Ÿæ­£å¸¸äº‹ä»¶ä¼šæœ‰åŒºåˆ«
</span><span>ph s/f // Flow äº‹ä»¶ï¼Œä¼šå‡ºç°ç®­å¤´ï¼Œè¦é€šè¿‡ ts åŒ¹é…æœ€è¿‘çš„ eventï¼Œç»“æŸè¦ä½¿ç”¨ bp: e
</span><span>ph O // Snapshotï¼Œè¡¨ç°ä¸Šæ˜¯ä¸€ä¸ªé†’ç›®çš„åœ†ç‚¹ï¼Œå¯ä»¥åœ¨ `args.snapshot` é‡Œæ”¾ä»»æ„æ•°æ®
</span></code></pre>
<p>ä»¥ä¸‹æ˜¯ Demo å¯¹åº”çš„ Event å†…å®¹ï¼Œåªè¦èƒ½ç”Ÿæˆè¿™æ ·çš„ JSON æ–‡ä»¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ Trace Viewer å¼ºå¤§çš„å¯è§†åŒ–èƒ½åŠ›ã€‚</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>[
</span><span>  {&quot;name&quot;: &quot;æˆ‘çš„ä¸€å¤©&quot;, &quot;ph&quot;: &quot;b&quot;, &quot;cat&quot;: &quot;daily&quot;, &quot;id&quot;: &quot;my-day&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 0},
</span><span>  {&quot;name&quot;: &quot;æˆ‘çš„ä¸€å¤©1&quot;, &quot;ph&quot;: &quot;e&quot;, &quot;cat&quot;: &quot;daily&quot;, &quot;id&quot;: &quot;my-day&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 37800000000},
</span><span>
</span><span>  {&quot;name&quot;: &quot;å‡ºæ–¹æ¡ˆ&quot;, &quot;cname&quot;: &quot;good&quot;,&quot;ph&quot;: &quot;X&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 0, &quot;dur&quot;: 28800000000},
</span><span>  {&quot;name&quot;: &quot;æƒ³åˆ°ä¸€ä¸ªç‚¹å­&quot;, &quot;ph&quot;: &quot;I&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 18800000000},
</span><span>  {&quot;name&quot;: &quot;connect&quot;, &quot;ph&quot;: &quot;s&quot;, &quot;id&quot;: &quot;my-work&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 28800000000},
</span><span>  {&quot;name&quot;: &quot;connect&quot;, &quot;ph&quot;: &quot;f&quot;, &quot;bp&quot;: &quot;e&quot;, &quot;id&quot;: &quot;my-work&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 32400000000},
</span><span>  {&quot;name&quot;: &quot;å†™ä»£ç &quot;, &quot;ph&quot;: &quot;X&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;ts&quot;: 32400000000, &quot;dur&quot;: 3600000000},
</span><span>
</span><span>  {&quot;name&quot;: &quot;åæ€&quot;, &quot;ph&quot;: &quot;O&quot;, &quot;id&quot;: &quot;Ref&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å…¶ä»–&quot;, &quot;ts&quot;: 37800000000, &quot;args&quot;: {&quot;snapshot&quot;: &quot;å……å®çš„ä¸€å¤©å‘¢&quot;}},
</span><span>
</span><span>  {&quot;name&quot;: &quot;çœ‹ç”µå½±&quot;, &quot;ph&quot;: &quot;B&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;ä¼‘é—²&quot;, &quot;ts&quot;: 28800000000},
</span><span>  {&quot;name&quot;: &quot;çœ‹ç”µå½±&quot;, &quot;ph&quot;: &quot;E&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;ä¼‘é—²&quot;, &quot;ts&quot;: 32400000000},
</span><span>
</span><span>  {&quot;name&quot;: &quot;é›ç‹—&quot;, &quot;ph&quot;: &quot;X&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;ä¼‘é—²&quot;, &quot;ts&quot;: 36000000000, &quot;dur&quot;: 1880000000},
</span><span>  {&quot;name&quot;: &quot;process_name&quot;, &quot;ph&quot;: &quot;M&quot;, &quot;pid&quot;: &quot;Main&quot;, &quot;tid&quot;: &quot;å·¥ä½œ&quot;, &quot;args&quot;: {&quot;name&quot;: &quot;æ—¶é—´çº¿&quot;}}
</span><span>]
</span></code></pre>
<h2 id="zai-xian-shi-yong-trace-viewer">åœ¨çº¿ä½¿ç”¨ Trace Viewer</h2>
<p>é€šè¿‡ <code>chrome://tracing</code> çš„æ–¹å¼æ¥ä½¿ç”¨ Tracer Viewer è¿˜æ˜¯ä¸å¤ªæ–¹ä¾¿ï¼Œä¹Ÿä¸åˆ©äºä¼ æ’­ï¼ŒGoogle è™½ç„¶åœ¨ catapult é‡Œæä¾›äº† <code>trace2html</code>ï¼Œä½†åŒ…å«çš„æ–‡ä»¶å¾ˆå¤šï¼Œä½¿ç”¨èµ·æ¥è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œäºæ˜¯å‚è€ƒäº† <code>go trace</code> çš„æºç ï¼ŒæŠŠç›¸å…³æ–‡ä»¶ä¸Šä¼ åˆ°äº† CDNï¼Œç„¶ååœ¨ä¸€ä¸ª html æ–‡ä»¶é‡Œå¼•ç”¨ï¼Œè¿™æ ·åªéœ€ä¸€ä¸ªæ–‡ä»¶å³å¯ã€‚</p>
<pre style="background-color:#f9f9f9;color:#111111;"><code><span>&lt;!DOCTYPE html&gt;
</span><span>&lt;!--
</span><span>Copyright (c) 2014 The Chromium Authors. All rights reserved.
</span><span>Use of this source code is governed by a BSD-style license that can be
</span><span>found in the LICENSE file.
</span><span>--&gt;
</span><span>
</span><span>&lt;head&gt;
</span><span>  &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
</span><span>  &lt;style&gt;
</span><span>    body {
</span><span>      font-family: arial, sans-serif;
</span><span>    }
</span><span>  &lt;/style&gt;
</span><span>  &lt;script
</span><span>    src=&quot;https://sf1-ttcdn-tos.pstatp.com/obj/developer-baas/baas/ttnbrzs5vgcryya2z2/7d1b75402231d1cd_1583755520315.js&quot;&gt;&lt;/script&gt;
</span><span>  &lt;script&gt;
</span><span>    &#39;use strict&#39;;
</span><span>    window.__hideTraceViewerPolyfillWarning = true;
</span><span>
</span><span>    function onTraceViewerImportFail() {
</span><span>      document.addEventListener(&#39;DOMContentLoaded&#39;, function () {
</span><span>        document.body.textContent =
</span><span>          &#39;tracing/bin/trace_viewer_full.html is missing. &#39; +
</span><span>          &#39;Run vulcanize_trace_viewer from $TRACE_VIEWER and reload.&#39;;
</span><span>      });
</span><span>    }
</span><span>  &lt;/script&gt;
</span><span>  &lt;link rel=&quot;import&quot;
</span><span>    href=&quot;https://sf1-ttcdn-tos.pstatp.com/obj/developer-baas/baas/ttnbrzs5vgcryya2z2/4b94a178762f4049_1583756222365.html&quot;
</span><span>    onerror=&quot;onTraceViewerImportFail(event)&quot;&gt;
</span><span>  &lt;style&gt;
</span><span>    html,
</span><span>    body {
</span><span>      box-sizing: border-box;
</span><span>      overflow: hidden;
</span><span>      margin: 0px;
</span><span>      padding: 0;
</span><span>      width: 100%;
</span><span>      height: 100%;
</span><span>    }
</span><span>
</span><span>    #trace-viewer {
</span><span>      width: 100%;
</span><span>      height: 100%;
</span><span>    }
</span><span>
</span><span>    #trace-viewer:focus {
</span><span>      outline: none;
</span><span>    }
</span><span>  &lt;/style&gt;
</span><span>  &lt;script&gt;
</span><span>    &#39;use strict&#39;;
</span><span>
</span><span>    (function () {
</span><span>      var viewer;
</span><span>      var url;
</span><span>      var model;
</span><span>
</span><span>      function load() {
</span><span>        var req = new XMLHttpRequest();
</span><span>        var isBinary = /[.]gz$/.test(url) || /[.]zip$/.test(url);
</span><span>        req.overrideMimeType(&#39;text/plain; charset=x-user-defined&#39;);
</span><span>        req.overrideMimeType(&#39;contentType: &quot;application/x-www-form-urlencoded;charset=utf-8&quot;&#39;);
</span><span>        console.log(url);
</span><span>        req.open(&#39;GET&#39;, url, true);
</span><span>        if (isBinary)
</span><span>          req.responseType = &#39;arraybuffer&#39;;
</span><span>
</span><span>        req.onreadystatechange = function (event) {
</span><span>          if (req.readyState !== 4)
</span><span>            return;
</span><span>
</span><span>          window.setTimeout(function () {
</span><span>            if (req.status === 200)
</span><span>              onResult(isBinary ? req.response : req.responseText);
</span><span>            else
</span><span>              onResultFail(req.status);
</span><span>          }, 0);
</span><span>        };
</span><span>        req.send(null);
</span><span>      }
</span><span>
</span><span>      function onResultFail(err) {
</span><span>        var overlay = new tr.ui.b.Overlay();
</span><span>        overlay.textContent = err + &#39;: &#39; + url + &#39; could not be loaded&#39;;
</span><span>        overlay.title = &#39;Failed to fetch data&#39;;
</span><span>        overlay.visible = true;
</span><span>      }
</span><span>
</span><span>      function onResult(result) {
</span><span>        model = new tr.Model();
</span><span>        var i = new tr.importer.Import(model);
</span><span>        var p = i.importTracesWithProgressDialog([result]);
</span><span>        p.then(onModelLoaded, onImportFail);
</span><span>      }
</span><span>
</span><span>      function onModelLoaded() {
</span><span>        viewer.model = model;
</span><span>        var urlParams = new URLSearchParams(window.location.search);
</span><span>        var title = urlParams.get(&quot;title&quot;) || &quot;&quot;;
</span><span>        document.getElementById(&#39;title&#39;).innerHTML = title;
</span><span>      }
</span><span>
</span><span>      function onImportFail(err) {
</span><span>        var overlay = new tr.ui.b.Overlay();
</span><span>        overlay.textContent = tr.b.normalizeException(err).message;
</span><span>        overlay.title = &#39;Import error&#39;;
</span><span>        overlay.visible = true;
</span><span>      }
</span><span>
</span><span>      document.addEventListener(&#39;WebComponentsReady&#39;, function () {
</span><span>        var container = document.createElement(&#39;track-view-container&#39;);
</span><span>        container.id = &#39;track_view_container&#39;;
</span><span>
</span><span>        viewer = document.createElement(&#39;tr-ui-timeline-view&#39;);
</span><span>        viewer.track_view_container = container;
</span><span>        Polymer.dom(viewer).appendChild(container);
</span><span>
</span><span>        viewer.id = &#39;trace-viewer&#39;;
</span><span>        viewer.globalMode = true;
</span><span>        Polymer.dom(document.body).appendChild(viewer);
</span><span>
</span><span>        var urlParams = new URLSearchParams(window.location.search);
</span><span>        url = urlParams.get(&quot;tracing_url&quot;);
</span><span>        load();
</span><span>      });
</span><span>    }());
</span><span>  &lt;/script&gt;
</span><span>&lt;/head&gt;
</span><span>&lt;body&gt;
</span><span>&lt;/body&gt;
</span><span>&lt;/html&gt;
</span></code></pre>
<p>ä½¿ç”¨æ–¹å¼ï¼š<code>http://path/to/this.html?tracing_url=path/to/tracing.json</code></p>
<h2 id="cai-guo-de-keng">è¸©è¿‡çš„å‘</h2>
<p>JSON æ–‡ä»¶é‡Œï¼Œå¦‚æœå‡ºç° <code>AStart-BStart-AEnd-BEnd</code> è¿™æ ·çš„äº¤å‰å¼å¤šè¡Œæ•°æ®ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´è§£æå¤±è´¥ã€‚è§£å†³æ–¹æ³•å°±æ˜¯æ‹†è§£ä¸ºæ­£å¸¸çš„é¡ºåº <code>AStart-AEnd-BStart-BEnd</code>ã€‚</p>
<p>è¿˜æœ‰ï¼Œå¦‚æœå‘ç°æŸä¸ª Event çš„ Start å’Œ End æ˜æ˜åœ¨é‚£é‡Œï¼Œä½†å´è¿˜æ˜¯æŠ¥æ‰¾ä¸åˆ° End çš„è¯ï¼Œé€šå¸¸æ˜¯è¿™ä¸ª End è¢«å…¶ä»– Start åŒ¹é…äº†ï¼ˆå³ä½¿åå­—ä¸ä¸€æ ·ï¼‰ï¼Œæ‰€ä»¥ root cause å¾ˆå¯èƒ½æ˜¯å› ä¸ºé‚£ä¸ª solo Startã€‚</p>
<h2 id="xiao-jie">å°ç»“</h2>
<p>Trace Viewer æ˜¯ä¸€æ¬¾å¼ºå¤§çš„å¯è§†åŒ–åˆ©å™¨ï¼Œè™½ç„¶é€šå¸¸è¢«æ‹¿æ¥åšæ€§èƒ½åˆ†æï¼Œä½†å®ƒçš„ä½¿ç”¨åœºæ™¯å…¶å®å¾ˆå¹¿ï¼Œè‡³äºèƒ½åšå‡ºä»€ä¹ˆæ¥ï¼Œå°±çœ‹ä½ çš„æƒ³è±¡åŠ›å’¯ã€‚</p>

  </div>


  <ul class="tags flex flex-wrap justify-center items-center gap-4 mt-5 mb-8 text-lg">
    
    
    <li
      class="px-4 pb-[2px] leading-8 rounded-full border text-gray-700 border-gray-700 hover:text-gray-100 hover:border-gray-900 hover:bg-gray-900 transition-all">
      <a class="inline-block" href="https://limboy.me/tags/programming/">programming</a>
    </li>
    
    
  </ul>

  
  <script src="https://giscus.app/client.js" data-repo="limboy/telescope"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzODEwOTA2MTg=" data-category="General"
    data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMzMDY2MTQy" data-mapping="title" data-reactions-enabled="1"
    data-emit-metadata="0" data-theme="light" data-lang="en" crossorigin="anonymous" async>
    </script>
  

  

</div>

      </div>
    </div>
    
    <footer
      class="flex border-t border-gray-300 text-gray-600 bg-gray-50 items-center justify-center h-12 text-sm mt-2">
      <div class="flex inner justify-center gap-4">
        <a class="hover:underline" href="https://github.com/limboy" target="_blank">GitHub</a>
        <a class="hover:underline" href="https://twitter.com/_limboy" target="_blank">Twitter</a>
        <a class="hover:underline" href="https://limboy.me/index.xml">RSS</a>
      </div>
    </footer>
    
  </div>

  
  

  <script>
    // éƒ½æ˜¯ä¸ºäº† iOS...
    document.querySelector("#wrapper").style.minHeight = `calc(${window.innerHeight}px - 6.5rem)`
    window.addEventListener('resize', () => {
      document.querySelector("#wrapper").style.minHeight = `calc(${window.innerHeight}px - 6.5rem)`
    })
  </script>
</body>

</html>