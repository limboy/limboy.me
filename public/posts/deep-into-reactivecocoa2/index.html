<!DOCTYPE html>
<html>

<head>
  <meta content="width=device-width,initial-scale=1" name="viewport" />
  <meta charset="UTF-8">
  <link rel="icon" href="https://fav.farm/ğŸ‘»" />
  <title>
ReactiveCocoa2å®æˆ˜
</title>
  <link rel="stylesheet" href="/assets/main.css?6&#x2F;2ShUT3RYeReiJdlrDhZN+03rWSUD7DPccwza9UdPM=" />
  <script async defer data-domain="limboy.me" src="https://analytics.limboy.me/js/plausible.js"></script>
  
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@_limboy">
<meta name="twitter:site" content="@_limboy">
<meta property="og:url" content="https://limboy.me/posts/deep-into-reactivecocoa2/">

<meta name="twitter:title" content="ReactiveCocoa2å®æˆ˜">
<meta property="og:title" content="ReactiveCocoa2å®æˆ˜">

<meta property="og:description" content="">
<meta name="twitter:description" content="">



</head>

<body class="  ">
  <nav class="flex justify-center items-center opacity-80 bg-black h-12 py-0 ">
    <div class="inner flex justify-between flex-row mx-1">
      <ul class="color-white flex flex-row justify-start gap-4">
        <li><a class="nav-link opacity-90 text-2xl" href="/">Limboy</a></li>
        <!--<li><a class="nav-link" href="/coodle">Coodle</a></li>-->
      </ul>
      <ul class="color-white flex flex-row gap-4 items-center text-base">
        <!--<li> <a class="nav-link" href="/books" class="decoration-0"> Books </a> </li>-->
        <li> <a class="nav-link" href="/highlights" class="decoration-0"> Highlights </a> </li>
        <li> <a class="nav-link" href="/projects" class="decoration-0"> Projects </a> </li>
        <li> <a class="nav-link" href="/about" class="decoration-0"> About </a> </li>
      </ul>
    </div>
  </nav>

  <div class="flex flex-col">
    <div id="wrapper" class="flex justify-center" style="min-height: calc(100vh - 6.5rem);">
      <div class="inner mb-2">
        
<div class="mt-4 lg:mt-6">
  

  <h1 class="title font-medium text-3xl"><a href="https:&#x2F;&#x2F;limboy.me&#x2F;posts&#x2F;deep-into-reactivecocoa2&#x2F;">ReactiveCocoa2å®æˆ˜</a></h1>
  <div class="flex gap-4 items-center my-1">
    <time class="text-gray-500">2014-06-06</time>

  </div>
  <hr class="border-t-[3px]" />

  <div class="prose lg:prose-xl max-w-full my-6">
    <p>ä¹‹å‰å·²ç»å†™è¿‡ä¸¤ç¯‡å…³äº ReactiveCocoa(ä»¥ä¸‹ç®€ç§° RAC)çš„æ–‡ç« äº†ï¼Œä½†ä¸»è¦ä¹Ÿæ˜¯åœ¨é˜è¿°åŸºæœ¬çš„æ¦‚å¿µå’Œä½¿ç”¨ï¼Œè¿™ç¯‡æ–‡ç« å°†ä¼šä»å®æˆ˜çš„è§’åº¦æ¥çœ‹çœ‹ RAC åˆ°åº•è§£å†³äº†å“ªäº›é—®é¢˜ï¼Œå¸¦æ¥äº†å“ªäº›æ–¹ä¾¿ï¼Œä»¥åŠé‡åˆ°çš„ä¸€äº›å‘ã€‚</p>
<h3 id="gai-shu">æ¦‚è¿°</h3>
<h4 id="wei-shi-yao-yao-shi-yong-rac">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ RACï¼Ÿ</h4>
<p>ä¸€ä¸ªæ€ªæ€ªçš„ä¸œè¥¿ï¼Œä» Demo çœ‹ä¹Ÿæ²¡æœ‰è®©ä»£ç å˜å¾—æ›´å¥½ã€æ›´çŸ­ï¼Œç›¸åè¿˜é€ æˆç†è§£ä¸Šçš„å›°éš¾ï¼ŒçœŸçš„æœ‰å¿…è¦å»å­¦å®ƒä¹ˆï¼Ÿç›¸ä¿¡è¿™æ˜¯å¤§å¤šæ•°äººåœ¨æ¥è§¦ RAC æ—¶çš„æƒ³æ³•ã€‚RAC ä¸æ˜¯å•ä¸€åŠŸèƒ½çš„æ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ª Frameworkï¼Œæä¾›äº†ä¸€æ•´å¥—è§£å†³æ–¹æ¡ˆã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ã€Œå“åº”æ•°æ®çš„å˜åŒ–ã€ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šæœ‰äº† Signal çš„æ¦‚å¿µï¼Œè¿›è€Œå¯ä»¥å¸®åŠ©å‡å°‘çŠ¶æ€å˜é‡(å¯ä»¥å‚è€ƒ jspahrsummers çš„<a href="https://github.com/jspahrsummers/enemy-of-the-state">PPT</a>)ï¼Œä½¿ç”¨ MVVM æ¶æ„ï¼Œç»Ÿä¸€çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ç­‰ç­‰ã€‚</p>
<p>ä¸ºä»€ä¹ˆ RAC æ›´åŠ é€‚åˆç¼–å†™ Cocoa Appï¼Ÿè¯´è¿™ä¸ªä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ Web å‰ç«¯ç¼–ç¨‹ï¼Œå› ä¸ºæœ‰äº›ç›¸ä¼¼ä¹‹å¤„ã€‚ç›®å‰å¾ˆç«çš„ AngularJS æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„ç‰¹æ€§ï¼šæ•°æ®ä¸è§†å›¾ç»‘å®šã€‚å°±æ˜¯å½“æ•°æ®å˜åŒ–æ—¶ï¼Œè§†å›¾ä¸éœ€è¦é¢å¤–çš„å¤„ç†ï¼Œä¾¿å¯æ­£ç¡®åœ°å‘ˆç°æœ€æ–°çš„æ•°æ®ã€‚è€Œè¿™ä¹Ÿæ˜¯ RAC çš„äº®ç‚¹ä¹‹ä¸€ã€‚RAC ä¸ Cocoa çš„ç¼–ç¨‹æ¨¡å¼ï¼Œæœ‰ç‚¹åƒ AngularJS å’Œ jQueryã€‚æ‰€ä»¥è¦äº†è§£ RACï¼Œéœ€è¦å…ˆåœ¨è§‚å¿µä¸Šåšè°ƒæ•´ã€‚</p>
<p>ä»¥ä¸‹é¢è¿™ä¸ª Cell ä¸ºä¾‹</p>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;deep-into-reactivecocoa2&#x2F;rac-demo.png"
        width="321" /></p>
<p>æ­£å¸¸çš„å†™æ³•å¯èƒ½æ˜¯è¿™æ ·ï¼Œå¾ˆç›´è§‚ã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#3e999f;">- </span><span>(</span><span style="color:#8959a8;">void</span><span>)configureWithItem</span><span style="color:#3e999f;">:</span><span>(HBItem </span><span style="color:#3e999f;">*</span><span>)item
</span><span>{
</span><span>	</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">username</span><span>.</span><span style="color:#c82728;">text </span><span style="color:#3e999f;">=</span><span> item.</span><span style="color:#c82728;">text</span><span>;
</span><span>	[</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">avatarImageView</span><span> setImageWithURL</span><span style="color:#3e999f;">:</span><span> item.</span><span style="color:#c82728;">avatarURL</span><span>];
</span><span>	</span><span style="color:#8e908c;">// å…¶ä»–çš„ä¸€äº›è®¾ç½®
</span><span>}
</span></code></pre>
<p>ä½†å¦‚æœç”¨ RACï¼Œå¯èƒ½å°±æ˜¯è¿™æ ·</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#3e999f;">- </span><span>(</span><span style="color:#8959a8;">id</span><span>)init
</span><span>{
</span><span>	</span><span style="color:#8959a8;">if </span><span>(</span><span style="color:#c82728;">self </span><span style="color:#3e999f;">= </span><span>[</span><span style="color:#c82728;">super </span><span style="color:#4271ae;">init</span><span>]) {
</span><span>		@</span><span style="color:#c82728;">weakify</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">)</span><span>;
</span><span>		[</span><span style="color:#c82728;">RACObserve</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">, viewModel)</span><span> subscribeNext</span><span style="color:#3e999f;">:^</span><span>(HBItemViewModel </span><span style="color:#3e999f;">*</span><span>viewModel) {
</span><span>			@</span><span style="color:#c82728;">strongify</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">)</span><span>;
</span><span>			</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">username</span><span>.</span><span style="color:#c82728;">text </span><span style="color:#3e999f;">=</span><span> viewModel.</span><span style="color:#c82728;">item</span><span>.</span><span style="color:#c82728;">text</span><span>;
</span><span>			[</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">avatarImageView</span><span> setImageWithURL</span><span style="color:#3e999f;">:</span><span> viewModel.</span><span style="color:#c82728;">item</span><span>.</span><span style="color:#c82728;">avatarURL</span><span>];
</span><span>			</span><span style="color:#8e908c;">// å…¶ä»–çš„ä¸€äº›è®¾ç½®
</span><span>		}];
</span><span>	}
</span><span>}
</span></code></pre>
<p>ä¹Ÿå°±æ˜¯å…ˆæŠŠæ•°æ®ç»‘å®šï¼Œæ¥ä¸‹æ¥åªè¦æ•°æ®æœ‰å˜åŒ–ï¼Œå°±ä¼šè‡ªåŠ¨å“åº”å˜åŒ–ã€‚åœ¨è¿™é‡Œï¼Œæ¯æ¬¡ viewModel æ”¹å˜æ—¶ï¼Œå†…å®¹å°±ä¼šè‡ªåŠ¨å˜æˆè¯¥ viewModel çš„å†…å®¹ã€‚</p>
<h4 id="signal">Signal</h4>
<p>Signal æ˜¯ RAC çš„æ ¸å¿ƒï¼Œä¸ºäº†å¸®åŠ©ç†è§£ï¼Œç”»äº†è¿™å¼ ç®€åŒ–å›¾</p>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;deep-into-reactivecocoa2&#x2F;rac-signal.png"
        width="743" /></p>
<p>è¿™é‡Œçš„æ•°æ®æºå’Œ sendXXXï¼Œå¯ä»¥ç†è§£ä¸ºå‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ã€‚å½“ Signal å¤„ç†å®Œæ•°æ®åï¼Œå¯ä»¥å‘ä¸‹ä¸€ä¸ª Signal æˆ– Subscriber ä¼ é€æ•°æ®ã€‚å¯ä»¥çœ‹åˆ°ä¸ŠåŠéƒ¨åˆ†çš„ä¸¤ä¸ª Signal æ˜¯å†·çš„(cold)ï¼Œç›¸å½“äºå®ç°äº†æŸä¸ªå‡½æ•°ï¼Œä½†è¯¥å‡½æ•°æ²¡æœ‰è¢«è°ƒç”¨ã€‚åŒæ—¶ä¹Ÿè¯´æ˜äº† Signal å¯ä»¥è¢«ç»„åˆä½¿ç”¨ï¼Œæ¯”å¦‚<code>RACSignal *signalB = [signalA map:^id(id x){return x}]</code>ï¼Œæˆ–<code>RACSignal *signalB = [signalA take:1]</code>ç­‰ç­‰ã€‚</p>
<p>å½“ signal è¢« subscribe æ—¶ï¼Œå°±ä¼šå¤„äºçƒ­(hot)çš„çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯¥å‡½æ•°ä¼šè¢«æ‰§è¡Œã€‚æ¯”å¦‚ä¸Šé¢çš„ç¬¬äºŒå¼ å›¾ï¼Œé¦–å…ˆ signalA å¯èƒ½å‘äº†ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œæ‹¿åˆ°ç»“æœåï¼ŒæŠŠæ•°æ®é€šè¿‡<code>sendNext</code>æ–¹æ³•ä¼ é€’åˆ°ä¸‹ä¸€ä¸ª signalï¼ŒsignalB å¯ä»¥æ ¹æ®éœ€è¦åšè¿›ä¸€æ­¥å¤„ç†ï¼Œæ¯”å¦‚è½¬æ¢æˆç›¸åº”çš„ Modelï¼Œè½¬æ¢å®Œåå†<code>sendNext</code>åˆ° subscriberï¼Œsubscriber æ‹¿åˆ°æ•°æ®åï¼Œå†æ”¹å˜ ViewModelï¼ŒåŒæ—¶å› ä¸º View å·²ç»ç»‘å®šäº† ViewModelï¼Œæ‰€ä»¥æ‹¿åˆ°çš„æ•°æ®ä¼šè‡ªåŠ¨åœ¨ View é‡Œå‘ˆç°ã€‚</p>
<p>è¿˜æœ‰ï¼Œä¸€ä¸ª signal å¯ä»¥è¢«å¤šä¸ª subscriber è®¢é˜…ï¼Œè¿™é‡Œæ€•æ˜¾å¾—å¤ªä¹±å°±æ²¡æœ‰ç”»å‡ºæ¥ï¼Œä½†æ¯æ¬¡è¢«æ–°çš„ subscriber è®¢é˜…æ—¶ï¼Œéƒ½ä¼šå¯¼è‡´æ•°æ®æºçš„å¤„ç†é€»è¾‘è¢«è§¦å‘ä¸€æ¬¡ï¼Œè¿™å¾ˆæœ‰å¯èƒ½å¯¼è‡´æ„æƒ³ä¸åˆ°çš„ç»“æœï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚</p>
<p>å½“æ•°æ®ä» signal ä¼ é€åˆ° subscriber æ—¶ï¼Œè¿˜å¯ä»¥é€šè¿‡<code>doXXX</code>æ¥åšç‚¹äº‹æƒ…ï¼Œæ¯”å¦‚æ‰“å°æ•°æ®ã€‚</p>
<p>é€šè¿‡è¿™å¼ å›¾å¯ä»¥çœ‹åˆ°ï¼Œè¿™éå¸¸åƒä¸­å­¦æ—¶å­¦çš„å‡½æ•°ï¼Œæ¯”å¦‚ <code>f(x) = y</code>ï¼ŒæŸä¸€ä¸ªå‡½æ•°çš„è¾“å‡ºåˆå¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„è¾“å…¥ï¼Œæ¯”å¦‚ <code>f(f(x)) = z</code>ï¼Œè¿™ä¹Ÿæ­£æ˜¯ã€Œå‡½æ•°å“åº”å¼ç¼–ç¨‹ã€(FRP)çš„æ ¸å¿ƒã€‚</p>
<p>æœ‰äº›åœ°æ–¹éœ€è¦æ³¨æ„ä¸‹ï¼Œæ¯”å¦‚æŠŠ signal ä½œä¸º local å˜é‡æ—¶ï¼Œå¦‚æœæ²¡æœ‰è¢« subscribeï¼Œé‚£ä¹ˆæ–¹æ³•æ‰§è¡Œå®Œåï¼Œè¯¥å˜é‡ä¼šè¢« deallocã€‚ä½†å¦‚æœ signal æœ‰è¢« subscribeï¼Œé‚£ä¹ˆ subscriber ä¼šæŒæœ‰è¯¥ signalï¼Œç›´åˆ° signal sendCompleted æˆ– sendError æ—¶ï¼Œæ‰ä¼šè§£é™¤æŒæœ‰å…³ç³»ï¼Œsignal æ‰ä¼šè¢« deallocã€‚</p>
<h4 id="raccommand">RACCommand</h4>
<p><code>RACCommand</code>æ˜¯ RAC å¾ˆé‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œå¯ä»¥èŠ‚çœå¾ˆå¤šæ—¶é—´å¹¶ä¸”è®©ä½ çš„ App å˜å¾—æ›´ Robustï¼Œ<a href="http://codeblog.shape.dk/blog/2013/12/05/reactivecocoa-essentials-understanding-and-using-raccommand/">è¿™ç¯‡æ–‡ç« </a>å¯ä»¥å¸®åŠ©ä½ æ›´æ·±å…¥çš„ç†è§£ï¼Œè¿™é‡Œç®€å•åšä¸€ä¸‹ä»‹ç»ã€‚</p>
<p><code>RACCommand</code> é€šå¸¸ç”¨æ¥è¡¨ç¤ºæŸä¸ª Action çš„æ‰§è¡Œï¼Œæ¯”å¦‚ç‚¹å‡» Buttonã€‚å®ƒæœ‰å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å±æ€§ï¼šexecutionSignals / errors / executingã€‚</p>
<ul>
<li><code>executionSignals</code>æ˜¯ signal of signalsï¼Œå¦‚æœç›´æ¥ subscribe çš„è¯ä¼šå¾—åˆ°ä¸€ä¸ª signalï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ valueï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šé…åˆ<code>switchToLatest</code>ã€‚</li>
<li><code>errors</code>ã€‚è·Ÿæ­£å¸¸çš„ signal ä¸ä¸€æ ·ï¼Œ<code>RACCommand</code>çš„é”™è¯¯ä¸æ˜¯é€šè¿‡<code>sendError</code>æ¥å®ç°çš„ï¼Œè€Œæ˜¯é€šè¿‡<code>errors</code>å±æ€§ä¼ é€’å‡ºæ¥çš„ã€‚</li>
<li><code>executing</code>è¡¨ç¤ºè¯¥ command å½“å‰æ˜¯å¦æ­£åœ¨æ‰§è¡Œã€‚</li>
</ul>
<p>å‡è®¾æœ‰è¿™ä¹ˆä¸ªéœ€æ±‚ï¼šå½“å›¾ç‰‡è½½å…¥å®Œåï¼Œåˆ†äº«æŒ‰é’®æ‰å¯ç”¨ã€‚é‚£ä¹ˆå¯ä»¥è¿™æ ·ï¼š</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>RACSignal </span><span style="color:#3e999f;">*</span><span>imageAvailableSignal </span><span style="color:#3e999f;">= </span><span>[</span><span style="color:#c82728;">RACObserve</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">, imageView.</span><span style="color:#c82728;">image</span><span style="color:#4271ae;">)</span><span> map</span><span style="color:#3e999f;">:</span><span style="color:#8959a8;">id</span><span style="color:#3e999f;">^</span><span>(</span><span style="color:#8959a8;">id </span><span>x){</span><span style="color:#8959a8;">return</span><span> x </span><span style="color:#3e999f;">?</span><span> @</span><span style="color:#f07219;">YES </span><span style="color:#3e999f;">:</span><span> @</span><span style="color:#f07219;">NO</span><span>}];
</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">shareButton</span><span>.</span><span style="color:#c82728;">rac_command </span><span style="color:#3e999f;">= </span><span>[[RACCommand </span><span style="color:#4271ae;">alloc</span><span>] initWithEnabled</span><span style="color:#3e999f;">:</span><span>imageAvailableSignal signalBlock</span><span style="color:#3e999f;">:^</span><span>RACSignal </span><span style="color:#3e999f;">*</span><span>(</span><span style="color:#8959a8;">id </span><span>input) {
</span><span>	</span><span style="color:#8e908c;">// do share logic
</span><span>}];
</span></code></pre>
<p>é™¤äº†ä¸<code>UIControl</code>ç»‘å®šä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æ‰§è¡ŒæŸä¸ª commandï¼Œæ¯”å¦‚åŒå‡»å›¾ç‰‡ç‚¹èµï¼Œå°±å¯ä»¥è¿™ä¹ˆå®ç°ã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8e908c;">// ViewModel.m
</span><span style="color:#3e999f;">- </span><span>(instancetype)init
</span><span>{
</span><span>    </span><span style="color:#c82728;">self </span><span style="color:#3e999f;">= </span><span>[</span><span style="color:#c82728;">super </span><span style="color:#4271ae;">init</span><span>];
</span><span>    </span><span style="color:#8959a8;">if </span><span>(</span><span style="color:#c82728;">self</span><span>) {
</span><span>        </span><span style="color:#8959a8;">void </span><span>(</span><span style="color:#3e999f;">^</span><span>updatePinLikeStatus)() </span><span style="color:#3e999f;">= ^</span><span>{
</span><span>            </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">pin</span><span>.</span><span style="color:#c82728;">likedCount </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">pin</span><span>.</span><span style="color:#c82728;">hasLiked </span><span style="color:#3e999f;">? </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">pin</span><span>.</span><span style="color:#c82728;">likedCount </span><span style="color:#3e999f;">- </span><span style="color:#f07219;">1 </span><span style="color:#3e999f;">: </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">pin</span><span>.</span><span style="color:#c82728;">likedCount </span><span style="color:#3e999f;">+ </span><span style="color:#f07219;">1</span><span>;
</span><span>            </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">pin</span><span>.</span><span style="color:#c82728;">hasLiked </span><span style="color:#3e999f;">= !</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">pin</span><span>.</span><span style="color:#c82728;">hasLiked</span><span>;
</span><span>        };
</span><span>
</span><span>        _likeCommand </span><span style="color:#3e999f;">= </span><span>[[RACCommand </span><span style="color:#4271ae;">alloc</span><span>] initWithSignalBlock</span><span style="color:#3e999f;">:^</span><span>RACSignal </span><span style="color:#3e999f;">*</span><span>(</span><span style="color:#8959a8;">id </span><span>input) {
</span><span>            </span><span style="color:#8e908c;">// å…ˆå±•ç¤ºæ•ˆæœï¼Œå†å‘é€è¯·æ±‚
</span><span>            </span><span style="color:#c82728;">updatePinLikeStatus</span><span style="color:#4271ae;">()</span><span>;
</span><span>            </span><span style="color:#8959a8;">return </span><span>[[HBAPIManager </span><span style="color:#4271ae;">sharedManager</span><span>] likePinWithPinID</span><span style="color:#3e999f;">:</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">pin</span><span>.</span><span style="color:#c82728;">pinID</span><span>];
</span><span>        }];
</span><span>
</span><span>        [_likeCommand.</span><span style="color:#c82728;">errors</span><span> subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>x) {
</span><span>            </span><span style="color:#8e908c;">// å‘ç”Ÿé”™è¯¯æ—¶ï¼Œå›æ»š
</span><span>            </span><span style="color:#c82728;">updatePinLikeStatus</span><span style="color:#4271ae;">()</span><span>;
</span><span>        }];
</span><span>    }
</span><span>    </span><span style="color:#8959a8;">return </span><span style="color:#c82728;">self</span><span>;
</span><span>}
</span><span>
</span><span style="color:#8e908c;">// ViewController.m
</span><span style="color:#3e999f;">- </span><span>(</span><span style="color:#8959a8;">void</span><span>)viewDidLoad
</span><span>{
</span><span>	[</span><span style="color:#c82728;">super </span><span style="color:#4271ae;">viewDidLoad</span><span>];
</span><span>	</span><span style="color:#8e908c;">// ...
</span><span>    @</span><span style="color:#c82728;">weakify</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">)</span><span>;
</span><span>    [</span><span style="color:#c82728;">RACObserve</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">, viewModel.</span><span style="color:#c82728;">hasLiked</span><span style="color:#4271ae;">)</span><span> subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>x){
</span><span>        @</span><span style="color:#c82728;">strongify</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">)</span><span>;
</span><span>        </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">pinLikedCountLabel</span><span>.</span><span style="color:#c82728;">text </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">viewModel</span><span>.</span><span style="color:#c82728;">likedCount</span><span>;
</span><span>        </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">likePinImageView</span><span>.</span><span style="color:#c82728;">image </span><span style="color:#3e999f;">= </span><span>[UIImage </span><span style="color:#4271ae;">imageNamed:</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">.</span><span style="color:#c82728;">viewModel</span><span style="color:#4271ae;">.</span><span style="color:#c82728;">hasLiked </span><span style="color:#3e999f;">? </span><span style="color:#839c00;">@&quot;pin_liked&quot; </span><span style="color:#3e999f;">: </span><span style="color:#839c00;">@&quot;pin_like&quot;</span><span>];
</span><span>    }];
</span><span>
</span><span>    UITapGestureRecognizer </span><span style="color:#3e999f;">*</span><span>tapGesture </span><span style="color:#3e999f;">= </span><span>[[UITapGestureRecognizer </span><span style="color:#4271ae;">alloc</span><span>] init];
</span><span>    tapGesture.</span><span style="color:#c82728;">numberOfTapsRequired </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">2</span><span>;
</span><span>    [[tapGesture </span><span style="color:#4271ae;">rac_gestureSignal</span><span>] subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>x) {
</span><span>        [</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">viewModel</span><span>.</span><span style="color:#c82728;">likeCommand</span><span> execute</span><span style="color:#3e999f;">:</span><span style="color:#f07219;">nil</span><span>];
</span><span>    }];
</span><span>}
</span></code></pre>
<p>å†æ¯”å¦‚æŸä¸ª App è¦é€šè¿‡ Twitter ç™»å½•ï¼ŒåŒæ—¶å…è®¸å–æ¶ˆç™»å½•ï¼Œå°±å¯ä»¥è¿™ä¹ˆåš (<a href="https://github.com/ReactiveCocoa/ReactiveCocoa/issues/1326">source</a>)</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>_twitterLoginCommand </span><span style="color:#3e999f;">= </span><span>[[RACCommand </span><span style="color:#4271ae;">alloc</span><span>] initWithSignalBlock</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>_) {
</span><span>      @</span><span style="color:#c82728;">strongify</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">)</span><span>;
</span><span>      </span><span style="color:#8959a8;">return </span><span>[[</span><span style="color:#c82728;">self
</span><span>          twitterSignInSignal]
</span><span>          takeUntil</span><span style="color:#3e999f;">:</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">cancelCommand</span><span>.</span><span style="color:#c82728;">executionSignals</span><span>];
</span><span>    }];
</span><span>
</span><span style="color:#c82728;">RAC</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">.</span><span style="color:#c82728;">authenticatedUser</span><span style="color:#4271ae;">) </span><span style="color:#3e999f;">= </span><span>[</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">twitterLoginCommand</span><span>.</span><span style="color:#c82728;">executionSignals</span><span> switchToLatest];
</span></code></pre>
<h3 id="chang-yong-de-mo-shi">å¸¸ç”¨çš„æ¨¡å¼</h3>
<h4 id="map-switchtolatest">map + switchToLatest</h4>
<p><code>switchToLatest:</code> çš„ä½œç”¨æ˜¯è‡ªåŠ¨åˆ‡æ¢ signal of signals åˆ°æœ€åä¸€ä¸ªï¼Œæ¯”å¦‚ä¹‹å‰çš„ command.executionSignals å°±å¯ä»¥ä½¿ç”¨<code>switchToLatest:</code>ã€‚</p>
<p><code>map:</code>çš„ä½œç”¨å¾ˆç®€å•ï¼Œå¯¹<code>sendNext</code>çš„ value åšä¸€ä¸‹å¤„ç†ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å€¼ã€‚</p>
<p>å¦‚æœæŠŠè¿™ä¸¤ä¸ªç»“åˆèµ·æ¥å°±æœ‰æ„æ€äº†ï¼Œæƒ³è±¡è¿™ä¹ˆä¸ªåœºæ™¯ï¼Œå½“ç”¨æˆ·åœ¨æœç´¢æ¡†è¾“å…¥æ–‡å­—æ—¶ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œè¯·æ±‚è¿”å›ç›¸åº”çš„ hintsï¼Œæ¯å½“æ–‡å­—æœ‰å˜åŠ¨æ—¶ï¼Œéœ€è¦å–æ¶ˆä¸Šä¸€æ¬¡çš„è¯·æ±‚ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªé…æ­ã€‚è¿™é‡Œç”¨å¦ä¸€ä¸ª Demoï¼Œç®€å•æ¼”ç¤ºä¸€ä¸‹</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#c99e00;">NSArray </span><span style="color:#3e999f;">*</span><span>pins </span><span style="color:#3e999f;">=</span><span> @[@</span><span style="color:#f07219;">172230988</span><span>, @</span><span style="color:#f07219;">172230947</span><span>, @</span><span style="color:#f07219;">172230899</span><span>, @</span><span style="color:#f07219;">172230777</span><span>, @</span><span style="color:#f07219;">172230707</span><span>];
</span><span>__block </span><span style="color:#c99e00;">NSInteger</span><span> index </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">0</span><span>;
</span><span>
</span><span>RACSignal </span><span style="color:#3e999f;">*</span><span>signal </span><span style="color:#3e999f;">= </span><span>[[[[RACSignal </span><span style="color:#4271ae;">interval:</span><span style="color:#f07219;">0.1 </span><span style="color:#4271ae;">onScheduler:[RACScheduler scheduler]</span><span>]
</span><span>						take</span><span style="color:#3e999f;">:</span><span>pins.</span><span style="color:#c82728;">count</span><span>]
</span><span>						map</span><span style="color:#3e999f;">:^</span><span style="color:#8959a8;">id</span><span>(</span><span style="color:#8959a8;">id </span><span>value) {
</span><span>							</span><span style="color:#8959a8;">return </span><span>[[[HBAPIManager </span><span style="color:#4271ae;">sharedManager</span><span>] fetchPinWithPinID</span><span style="color:#3e999f;">:</span><span>[pins[index</span><span style="color:#3e999f;">++</span><span>] intValue]] doNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>x) {
</span><span>								</span><span style="color:#4271ae;">NSLog</span><span>(</span><span style="color:#839c00;">@&quot;è¿™é‡Œåªä¼šæ‰§è¡Œä¸€æ¬¡&quot;</span><span>);
</span><span>							}];
</span><span>						}]
</span><span>						switchToLatest];
</span><span>
</span><span>[signal </span><span style="color:#4271ae;">subscribeNext:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">(HBPin </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">pin) {
</span><span style="color:#4271ae;">	NSLog(</span><span style="color:#839c00;">@&quot;pinID:</span><span>%d</span><span style="color:#839c00;">&quot;</span><span style="color:#4271ae;">, pin.</span><span style="color:#c82728;">pinID</span><span style="color:#4271ae;">);
</span><span style="color:#4271ae;">} completed:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">{
</span><span style="color:#4271ae;">	NSLog(</span><span style="color:#839c00;">@&quot;completed&quot;</span><span style="color:#4271ae;">);
</span><span style="color:#4271ae;">}</span><span>];
</span><span>
</span><span style="color:#8e908c;">// output
</span><span style="color:#8e908c;">// 2014-06-05 17:40:49.851 è¿™é‡Œåªä¼šæ‰§è¡Œä¸€æ¬¡
</span><span style="color:#8e908c;">// 2014-06-05 17:40:49.851 pinID:172230707
</span><span style="color:#8e908c;">// 2014-06-05 17:40:49.851 completed
</span></code></pre>
<h4 id="takeuntil">takeUntil</h4>
<p><code>takeUntil:someSignal</code> çš„ä½œç”¨æ˜¯å½“ someSignal sendNext æ—¶ï¼Œå½“å‰çš„ signal å°±<code>sendCompleted</code>ï¼ŒsomeSignal å°±åƒä¸€ä¸ªæ‹³å‡»è£åˆ¤ï¼Œå“¨å£°å“èµ·å°±æ„å‘³ç€æ¯”èµ›ç»ˆæ­¢ã€‚</p>
<p>å®ƒçš„å¸¸ç”¨åœºæ™¯ä¹‹ä¸€æ˜¯å¤„ç† cell çš„ button çš„ç‚¹å‡»äº‹ä»¶ï¼Œæ¯”å¦‚ç‚¹å‡» Cell çš„è¯¦æƒ…æŒ‰é’®ï¼Œéœ€è¦ push ä¸€ä¸ª VCï¼Œå°±å¯ä»¥è¿™æ ·ï¼š</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>[[[cell.</span><span style="color:#c82728;">detailButton
</span><span>	rac_signalForControlEvents</span><span style="color:#3e999f;">:</span><span>UIControlEventTouchUpInside]
</span><span>	takeUntil</span><span style="color:#3e999f;">:</span><span>cell.</span><span style="color:#c82728;">rac_prepareForReuseSignal</span><span>]
</span><span>	subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>x) {
</span><span>		</span><span style="color:#8e908c;">// generate and push ViewController
</span><span>}];
</span></code></pre>
<p>å¦‚æœä¸åŠ <code>takeUntil:cell.rac_prepareForReuseSignal</code>ï¼Œé‚£ä¹ˆæ¯æ¬¡ Cell è¢«é‡ç”¨æ—¶ï¼Œè¯¥ button éƒ½ä¼šè¢«<code>addTarget:selector</code>ã€‚</p>
<h4 id="ti-huan-delegate">æ›¿æ¢ Delegate</h4>
<p>å‡ºç°è¿™ç§éœ€æ±‚ï¼Œé€šå¸¸æ˜¯å› ä¸ºéœ€è¦å¯¹ Delegate çš„å¤šä¸ªæ–¹æ³•åšç»Ÿä¸€çš„å¤„ç†ï¼Œè¿™æ—¶å°±å¯ä»¥é€ ä¸€ä¸ª signal å‡ºæ¥ï¼Œæ¯æ¬¡è¯¥ Delegate çš„æŸäº›æ–¹æ³•è¢«è§¦å‘æ—¶ï¼Œè¯¥ signal å°±ä¼š<code>sendNext</code>ã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@implementation </span><span>UISearchDisplayController (RAC)
</span><span>- (RACSignal </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#4271ae;">rac_isActiveSignal </span><span>{
</span><span>    </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">delegate </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">self</span><span>;
</span><span>    RACSignal </span><span style="color:#3e999f;">*</span><span>signal </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">objc_getAssociatedObject</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">, </span><span style="color:#c82728;">_cmd</span><span style="color:#4271ae;">)</span><span>;
</span><span>    </span><span style="color:#8959a8;">if </span><span>(signal </span><span style="color:#3e999f;">!= </span><span style="color:#f07219;">nil</span><span>) </span><span style="color:#8959a8;">return</span><span> signal;
</span><span>
</span><span>    </span><span style="color:#8e908c;">/* Create two signals and merge them */
</span><span>    RACSignal </span><span style="color:#3e999f;">*</span><span>didBeginEditing </span><span style="color:#3e999f;">= </span><span>[[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">rac_signalForSelector:</span><span style="color:#8959a8;">@selector</span><span style="color:#4271ae;">(searchDisplayControllerDidBeginSearch:)
</span><span style="color:#4271ae;">                                        fromProtocol:</span><span style="color:#8959a8;">@protocol</span><span style="color:#4271ae;">(UISearchDisplayDelegate)</span><span>] mapReplace</span><span style="color:#3e999f;">:</span><span>@</span><span style="color:#f07219;">YES</span><span>];
</span><span>    RACSignal </span><span style="color:#3e999f;">*</span><span>didEndEditing </span><span style="color:#3e999f;">= </span><span>[[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">rac_signalForSelector:</span><span style="color:#8959a8;">@selector</span><span style="color:#4271ae;">(searchDisplayControllerDidEndSearch:)
</span><span style="color:#4271ae;">                                      fromProtocol:</span><span style="color:#8959a8;">@protocol</span><span style="color:#4271ae;">(UISearchDisplayDelegate)</span><span>] mapReplace</span><span style="color:#3e999f;">:</span><span>@</span><span style="color:#f07219;">NO</span><span>];
</span><span>    signal </span><span style="color:#3e999f;">= </span><span>[RACSignal </span><span style="color:#4271ae;">merge:@[didBeginEditing, didEndEditing]</span><span>];
</span><span>
</span><span>
</span><span>    </span><span style="color:#c82728;">objc_setAssociatedObject</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">, </span><span style="color:#c82728;">_cmd</span><span style="color:#4271ae;">, signal, OBJC_ASSOCIATION_RETAIN_NONATOMIC)</span><span>;
</span><span>    </span><span style="color:#8959a8;">return</span><span> signal;
</span><span>}
</span><span style="color:#8959a8;">@end
</span></code></pre>
<p>ä»£ç æºäº<a href="http://spin.atomicobject.com/2014/02/03/objective-c-delegate-pattern/">æ­¤æ–‡</a></p>
<h4 id="shi-yong-reactiveviewmodel-de-didbecomactivesignal">ä½¿ç”¨ ReactiveViewModel çš„ didBecomActiveSignal</h4>
<p><a href="https://github.com/ReactiveCocoa/ReactiveViewModel">ReactiveViewModel</a>æ˜¯å¦ä¸€ä¸ª projectï¼Œ åé¢çš„ MVVM ä¸­ä¼šè®²åˆ°ï¼Œé€šå¸¸çš„åšæ³•æ˜¯åœ¨ VC é‡Œè®¾ç½® VM çš„<code>active</code>å±æ€§(RVMViewModel è‡ªå¸¦è¯¥å±æ€§)ï¼Œç„¶ååœ¨ VM é‡Œ subscribeNext <code>didBecomActiveSignal</code>ï¼Œæ¯”å¦‚å½“ Active æ—¶ï¼Œè·å– TableView çš„æœ€æ–°æ•°æ®ã€‚</p>
<h4 id="racsubject-de-shi-yong-chang-jing">RACSubject çš„ä½¿ç”¨åœºæ™¯</h4>
<p>ä¸€èˆ¬ä¸æ¨èä½¿ç”¨<code>RACSubject</code>ï¼Œå› ä¸ºå®ƒè¿‡äºçµæ´»ï¼Œæ»¥ç”¨çš„è¯å®¹æ˜“å¯¼è‡´å¤æ‚åº¦çš„å¢åŠ ã€‚ä½†æœ‰ä¸€äº›åœºæ™¯ç”¨ä¸€ä¸‹è¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ï¼Œæ¯”å¦‚ ViewModel çš„ errorsã€‚</p>
<p>ViewModel ä¸€èˆ¬ä¼šæœ‰å¤šä¸ª<code>RACCommand</code>ï¼Œé‚£è¿™äº› commands å¦‚æœå‡ºç° error äº†è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿæ¯”è¾ƒæ–¹ä¾¿çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8e908c;">// HBCViewModel.h
</span><span>
</span><span style="color:#8959a8;">#import </span><span style="color:#839c00;">&quot;RVMViewModel.h&quot;
</span><span>
</span><span style="color:#8959a8;">@class</span><span> RACSubject;
</span><span>
</span><span style="color:#8959a8;">@interface </span><span>HBCViewModel : </span><span style="color:#839c00;">RVMViewModel
</span><span style="color:#8959a8;">@property </span><span>(</span><span style="color:#8959a8;">nonatomic</span><span>) RACSubject </span><span style="color:#3e999f;">*</span><span>errors;
</span><span style="color:#8959a8;">@end
</span><span>
</span><span>
</span><span>
</span><span style="color:#8e908c;">// HBCViewModel.m
</span><span>
</span><span style="color:#8959a8;">#import </span><span style="color:#839c00;">&quot;HBCViewModel.h&quot;
</span><span style="color:#8959a8;">#import </span><span style="color:#839c00;">&lt;ReactiveCocoa.h&gt;
</span><span>
</span><span style="color:#8959a8;">@implementation </span><span>HBCViewModel
</span><span>
</span><span>- (instancetype)</span><span style="color:#4271ae;">init
</span><span>{
</span><span>    </span><span style="color:#c82728;">self </span><span style="color:#3e999f;">= </span><span>[</span><span style="color:#c82728;">super </span><span style="color:#4271ae;">init</span><span>];
</span><span>    </span><span style="color:#8959a8;">if </span><span>(</span><span style="color:#c82728;">self</span><span>) {
</span><span>        _errors </span><span style="color:#3e999f;">= </span><span>[RACSubject </span><span style="color:#4271ae;">subject</span><span>];
</span><span>    }
</span><span>    </span><span style="color:#8959a8;">return </span><span style="color:#c82728;">self</span><span>;
</span><span>}
</span><span>
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">dealloc
</span><span>{
</span><span>    [_errors </span><span style="color:#4271ae;">sendCompleted</span><span>];
</span><span>}
</span><span style="color:#8959a8;">@end
</span><span>
</span><span style="color:#8e908c;">// Some Other ViewModel inherit HBCViewModel
</span><span>
</span><span style="color:#3e999f;">- </span><span>(instancetype)init
</span><span>{
</span><span>	_fetchLatestCommand </span><span style="color:#3e999f;">= </span><span>[RACCommand </span><span style="color:#4271ae;">alloc</span><span>] initWithSignalBlock</span><span style="color:#3e999f;">:^</span><span>RACSignal </span><span style="color:#3e999f;">*</span><span>(</span><span style="color:#8959a8;">id </span><span>input){
</span><span>		</span><span style="color:#8e908c;">// fetch latest data
</span><span>	}];
</span><span>
</span><span>	_fetchMoreCommand </span><span style="color:#3e999f;">= </span><span>[RACCommand </span><span style="color:#4271ae;">alloc</span><span>] initWithSignalBlock</span><span style="color:#3e999f;">:^</span><span>RACSignal </span><span style="color:#3e999f;">*</span><span>(</span><span style="color:#8959a8;">id </span><span>input){
</span><span>		</span><span style="color:#8e908c;">// fetch more data
</span><span>	}];
</span><span>
</span><span>	[</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">didBecomeActiveSignal</span><span> subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>x) {
</span><span>		[_fetchLatestCommand </span><span style="color:#4271ae;">execute:</span><span style="color:#f07219;">nil</span><span>];
</span><span>	}];
</span><span>
</span><span>	[[RACSignal
</span><span>		merge</span><span style="color:#3e999f;">:</span><span>@[
</span><span>				_fetchMoreCommand.</span><span style="color:#c82728;">errors</span><span>,
</span><span>				_fetchLatestCommand.</span><span style="color:#c82728;">errors
</span><span>				]] subscribe</span><span style="color:#3e999f;">:</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">errors</span><span>];
</span><span>
</span><span>}
</span></code></pre>
<h4 id="rac-signalforselector">rac_signalForSelector</h4>
<p><code>rac_signalForSelector:</code> è¿™ä¸ªæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª signalï¼Œå½“ selector æ‰§è¡Œå®Œæ—¶ï¼Œä¼š sendNextï¼Œä¹Ÿå°±æ˜¯å½“æŸä¸ªæ–¹æ³•è°ƒç”¨å®Œåå†é¢å¤–åšä¸€äº›äº‹æƒ…ã€‚ç”¨åœ¨ category ä¼šæ¯”è¾ƒæ–¹ä¾¿ï¼Œå› ä¸º Category é‡å†™çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œä¸èƒ½å†é€šè¿‡<code>[super XXX]</code>æ¥è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ‰‹å†™ Swizzle æ¥å®ç°ï¼Œä¸è¿‡æœ‰äº†<code>rac_signalForSelector:</code>å°±æ–¹ä¾¿å¤šäº†ã€‚</p>
<p><code>rac_signalForSelector: fromProtocol:</code> å¯ä»¥ç›´æ¥å®ç°å¯¹ protocol çš„æŸä¸ªæ–¹æ³•çš„å®ç°ï¼ˆå¬ç€æœ‰ç‚¹åˆ«æ‰­å‘¢ï¼‰ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬æƒ³å®ç° UIScrollViewDelegate çš„æŸäº›æ–¹æ³•ï¼Œå¯ä»¥è¿™ä¹ˆå†™</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>[[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">rac_signalForSelector:</span><span style="color:#8959a8;">@selector</span><span style="color:#4271ae;">(scrollViewDidEndDecelerating:) fromProtocol:</span><span style="color:#8959a8;">@protocol</span><span style="color:#4271ae;">(UIScrollViewDelegate)</span><span>] subscribeNext</span><span style="color:#3e999f;">:^</span><span>(RACTuple </span><span style="color:#3e999f;">*</span><span>tuple) {
</span><span>    </span><span style="color:#8e908c;">// do something
</span><span>}];
</span><span>
</span><span>[[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">rac_signalForSelector:</span><span style="color:#8959a8;">@selector</span><span style="color:#4271ae;">(scrollViewDidScroll:) fromProtocol:</span><span style="color:#8959a8;">@protocol</span><span style="color:#4271ae;">(UIScrollViewDelegate)</span><span>] subscribeNext</span><span style="color:#3e999f;">:^</span><span>(RACTuple </span><span style="color:#3e999f;">*</span><span>tuple) {
</span><span>	</span><span style="color:#8e908c;">// do something
</span><span>}];
</span><span>
</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">scrollView</span><span>.</span><span style="color:#c82728;">delegate </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">nil</span><span>;
</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">scrollView</span><span>.</span><span style="color:#c82728;">delegate </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">self</span><span>;
</span></code></pre>
<p>æ³¨æ„ï¼Œè¿™é‡Œçš„ delegate éœ€è¦å…ˆè®¾ç½®ä¸º nilï¼Œå†è®¾ç½®ä¸º selfï¼Œè€Œä¸èƒ½ç›´æ¥è®¾ç½®ä¸º selfï¼Œå¦‚æœ self å·²ç»æ˜¯è¯¥ scrollView çš„ Delegate çš„è¯ã€‚</p>
<p>æœ‰æ—¶ï¼Œæˆ‘ä»¬æƒ³å¯¹ selector çš„è¿”å›å€¼åšä¸€äº›å¤„ç†ï¼Œä½†å¾ˆé—æ†¾ RAC ä¸æ”¯æŒï¼Œå¦‚æœçœŸçš„æœ‰éœ€è¦çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://github.com/steipete/Aspects">Aspects</a></p>
<h3 id="mvvm">MVVM</h3>
<p>è¿™æ˜¯ä¸€ä¸ªå¤§è¯é¢˜ï¼Œå¦‚æœæœ‰è€å¿ƒï¼Œä¸”è‹±æ–‡è¿˜ä¸é”™çš„è¯ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ Cocoa Samurai çš„è¿™<a href="http://cocoasamurai.blogspot.fr/2013/03/basic-mvvm-with-reactivecocoa.html">ä¸¤ç¯‡</a><a href="http://cocoamanifest.net/articles/2013/10/mvc-mvvm-frp-and-building-bridges.html">æ–‡ç« </a>ã€‚PS: Facebook Paper å°±æ˜¯åŸºäº MVVM æ„å»ºçš„ã€‚</p>
<p>MVVM æ˜¯ Model-View-ViewModel çš„ç®€ç§°ï¼Œå®ƒä»¬ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹</p>
<p><img src="https://camo.githubusercontent.com/3999b9fdff783edb6cee9117a08524f3b2e7c653/68747470733a2f2f662e636c6f75642e6769746875622e636f6d2f6173736574732f3433323533362f3836373938342f32393165643338302d663736302d313165322d393130362d6433313538333230616633392e706e67" alt="" /></p>
<p>å¯ä»¥çœ‹åˆ° View(å…¶å®æ˜¯ ViewController)æŒæœ‰ ViewModelï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ ViewModel æ›´åŠ ç‹¬ç«‹ä¸”å¯æµ‹è¯•ï¼ŒViewModel é‡Œä¸åº”åŒ…å«ä»»ä½• View ç›¸å…³çš„å…ƒç´ ï¼Œå“ªæ€•æ¢äº†ä¸€ä¸ª View ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚è€Œä¸”è¿™æ ·ä¹Ÿèƒ½è®© View/ViewControllerã€Œç˜¦ã€ä¸‹æ¥ã€‚</p>
<p>ViewModel ä¸»è¦åšçš„äº‹æƒ…æ˜¯ä½œä¸º View çš„æ•°æ®æºï¼Œæ‰€ä»¥é€šå¸¸ä¼šåŒ…å«ç½‘ç»œè¯·æ±‚ã€‚</p>
<p>æˆ–è®¸ä½ ä¼šç–‘æƒ‘ï¼ŒViewController å“ªå»äº†ï¼Ÿåœ¨ MVVM çš„ä¸–ç•Œé‡Œï¼ŒViewController å·²ç»æˆä¸ºäº† View çš„ä¸€éƒ¨åˆ†ã€‚å®ƒçš„ä¸»è¦èŒè´£æ˜¯å°† VM ä¸ View ç»‘å®šã€å“åº” VM æ•°æ®çš„å˜åŒ–ã€è°ƒç”¨ VM çš„æŸä¸ªæ–¹æ³•ã€ä¸å…¶ä»–çš„ VC æ‰“äº¤é“ã€‚</p>
<p>è€Œ RAC ä¸º MVVM å¸¦æ¥å¾ˆå¤§çš„ä¾¿åˆ©ï¼Œæ¯”å¦‚<code>RACCommand</code>, UIKit çš„ RAC Extension ç­‰ç­‰ã€‚ä½¿ç”¨ MVVM ä¸ä¸€å®šèƒ½å‡å°‘ä»£ç é‡ï¼Œä½†èƒ½é™ä½ä»£ç çš„å¤æ‚åº¦ã€‚</p>
<p>ä»¥ä¸‹é¢è¿™ä¸ªéœ€æ±‚ä¸ºä¾‹ï¼Œè¦æ±‚å¤§å›¾æ»‘åŠ¨ç»“æŸæ—¶ï¼Œåº•éƒ¨çš„ç¼©ç•¥å›¾æ»šåŠ¨åˆ°å¯¹åº”çš„ä½ç½®ï¼Œå¹¶é«˜äº®è¯¥ç¼©ç•¥å›¾ï¼›åŒæ—¶åº•éƒ¨çš„ç¼©ç•¥å›¾è¢«é€‰ä¸­æ—¶ï¼Œå¤§å›¾ä¹Ÿè¦å˜æˆè¯¥ç¼©ç•¥å›¾çš„å¤§å›¾ã€‚</p>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;deep-into-reactivecocoa2&#x2F;rac-mvvm.png"
        width="320" /></p>
<p>æˆ‘çš„æ€è·¯æ˜¯æ¨ªå‘æ»šåŠ¨çš„å¤§å›¾æ˜¯ä¸€ä¸ª collectionViewï¼Œè¯¥ collectionView æ˜¯å½“å‰é¡µé¢ VC çš„ä¸€ä¸ª propertyã€‚åº•éƒ¨å¯ä»¥æ»‘åŠ¨çš„ç¼©ç•¥å›¾æ˜¯ä¸€ä¸ª childVC çš„ collectionViewï¼Œè¿™ä¸¤ä¸ª collectionView å…±ç”¨ä¸€å¥— VMï¼Œå¹¶ä¸”å„è‡ª RACObserve æ„Ÿå…´è¶£çš„ propertyã€‚</p>
<p>æ¯”å¦‚å¤§å›¾æ»‘åˆ°ä¸‹ä¸€é¡µæ—¶ï¼Œä¼šæ”¹å˜ VM çš„ indexPath å±æ€§ï¼Œè€Œåº•éƒ¨çš„ collectionView æ‰€åœ¨çš„ VC æ­£å¥½å¯¹è¯¥ indexPath æ„Ÿå…´è¶£ï¼Œåªè¦ indexPath å˜åŒ–å°±æ»šåŠ¨åˆ°ç›¸åº”çš„ Item</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8e908c;">// childVC
</span><span>
</span><span style="color:#3e999f;">- </span><span>(</span><span style="color:#8959a8;">void</span><span>)viewDidLoad
</span><span>{
</span><span>	[</span><span style="color:#c82728;">super </span><span style="color:#4271ae;">viewDidLoad</span><span>];
</span><span>
</span><span>	@</span><span style="color:#c82728;">weakify</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">)</span><span>;
</span><span>	[</span><span style="color:#c82728;">RACObserve</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">, viewModel.</span><span style="color:#c82728;">indexPath</span><span style="color:#4271ae;">)</span><span> subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#c99e00;">NSNumber </span><span style="color:#3e999f;">*</span><span>index) {
</span><span>        @</span><span style="color:#c82728;">strongify</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">)</span><span>;
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">scrollToIndexPath</span><span>];
</span><span>    }];
</span><span>}
</span><span>
</span><span style="color:#3e999f;">- </span><span>(</span><span style="color:#8959a8;">void</span><span>)scrollToIndexPath
</span><span>{
</span><span>    </span><span style="color:#8959a8;">if </span><span>(</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">collectionView</span><span>.</span><span style="color:#c82728;">subviews</span><span>.</span><span style="color:#c82728;">count</span><span>) {
</span><span>        </span><span style="color:#c99e00;">NSIndexPath </span><span style="color:#3e999f;">*</span><span>indexPath </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">viewModel</span><span>.</span><span style="color:#c82728;">indexPath</span><span>;
</span><span>        [</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">collectionView</span><span> scrollToItemAtIndexPath</span><span style="color:#3e999f;">:</span><span>indexPath atScrollPosition</span><span style="color:#3e999f;">:</span><span>UICollectionViewScrollPositionCenteredHorizontally animated</span><span style="color:#3e999f;">:</span><span style="color:#f07219;">YES</span><span>];
</span><span>        [</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">collectionView</span><span>.</span><span style="color:#c82728;">subviews</span><span> enumerateObjectsUsingBlock</span><span style="color:#3e999f;">:^</span><span>(UIView </span><span style="color:#3e999f;">*</span><span>view, </span><span style="color:#c99e00;">NSUInteger</span><span> idx, </span><span style="color:#8959a8;">BOOL </span><span style="color:#3e999f;">*</span><span>stop) {
</span><span>            view.</span><span style="color:#c82728;">layer</span><span>.</span><span style="color:#c82728;">borderWidth </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">0</span><span>;
</span><span>        }];
</span><span>        UIView </span><span style="color:#3e999f;">*</span><span>view </span><span style="color:#3e999f;">= </span><span>[</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">collectionView</span><span> cellForItemAtIndexPath</span><span style="color:#3e999f;">:</span><span>indexPath];
</span><span>        view.</span><span style="color:#c82728;">layer</span><span>.</span><span style="color:#c82728;">borderWidth </span><span style="color:#3e999f;">= </span><span>kHBPinsNaviThumbnailPadding;
</span><span>        view.</span><span style="color:#c82728;">layer</span><span>.</span><span style="color:#c82728;">borderColor </span><span style="color:#3e999f;">= </span><span>[UIColor </span><span style="color:#4271ae;">whiteColor</span><span>].</span><span style="color:#c82728;">CGColor</span><span>;
</span><span>    }
</span><span>}
</span></code></pre>
<p>å½“ç‚¹å‡»åº•éƒ¨çš„ç¼©ç•¥å›¾æ—¶ï¼Œä¸Šé¢çš„å¤§å›¾ä¹Ÿè¦åšå‡ºå˜åŒ–ï¼Œä¹ŸåŒæ ·å¯ä»¥é€šè¿‡ RACObserve indexPath æ¥å®ç°</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8e908c;">// PinsViewController.m
</span><span style="color:#3e999f;">- </span><span>(</span><span style="color:#8959a8;">void</span><span>)viewDidLoad
</span><span>{
</span><span>	[</span><span style="color:#c82728;">super </span><span style="color:#4271ae;">viewDidLoad</span><span>];
</span><span>	@</span><span style="color:#c82728;">weakify</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">)</span><span>;
</span><span>    [[</span><span style="color:#c82728;">RACObserve</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">, viewModel.</span><span style="color:#c82728;">indexPath</span><span style="color:#4271ae;">)
</span><span>        skip</span><span style="color:#3e999f;">:</span><span style="color:#f07219;">1</span><span>]
</span><span>        subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#c99e00;">NSIndexPath </span><span style="color:#3e999f;">*</span><span>indexPath) {
</span><span>            @</span><span style="color:#c82728;">strongify</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">)</span><span>;
</span><span>            [</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">collectionView</span><span> scrollToItemAtIndexPath</span><span style="color:#3e999f;">:</span><span>indexPath atScrollPosition</span><span style="color:#3e999f;">:</span><span>UICollectionViewScrollPositionCenteredHorizontally animated</span><span style="color:#3e999f;">:</span><span style="color:#f07219;">YES</span><span>];
</span><span>    }];
</span><span>}
</span></code></pre>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå°æŠ€å·§ï¼Œå½“ Cell é‡Œçš„å…ƒç´ æ¯”è¾ƒå¤æ‚æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ Cell ä¹Ÿå‡†å¤‡ä¸€ä¸ª ViewModelï¼Œè¿™ä¸ª CellViewModel å¯ä»¥ç”±ä¸Šä¸€å±‚çš„ ViewModel æä¾›ï¼Œè¿™æ · Cell å¦‚æœéœ€è¦ç›¸åº”çš„æ•°æ®ï¼Œç›´æ¥è·Ÿ CellViewModel è¦å³å¯ï¼ŒCellViewModel ä¹Ÿå¯ä»¥åŒ…å«ä¸€äº› commandï¼Œæ¯”å¦‚ likeCommandã€‚å‡å¦‚ç‚¹å‡» Cell æ—¶ï¼Œè¦åšä¸€äº›å¤„ç†ï¼Œä¹Ÿå¾ˆæ–¹ä¾¿ã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8e908c;">// CellViewModelå·²ç»åœ¨ViewModelé‡Œå‡†å¤‡å¥½äº†
</span><span style="color:#3e999f;">- </span><span>(UICollectionViewCell </span><span style="color:#3e999f;">*</span><span>)collectionView</span><span style="color:#3e999f;">:</span><span>(UICollectionView </span><span style="color:#3e999f;">*</span><span>)collectionView cellForItemAtIndexPath</span><span style="color:#3e999f;">:</span><span>(</span><span style="color:#c99e00;">NSIndexPath </span><span style="color:#3e999f;">*</span><span>)indexPath
</span><span>{
</span><span>    HBPinsCell </span><span style="color:#3e999f;">*</span><span>cell </span><span style="color:#3e999f;">= </span><span>[collectionView </span><span style="color:#4271ae;">dequeueReusableCellWithReuseIdentifier:cellIdentifier forIndexPath:indexPath</span><span>];
</span><span>    cell.</span><span style="color:#c82728;">viewModel </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">viewModel</span><span>.</span><span style="color:#c82728;">cellViewModels</span><span>[indexPath.</span><span style="color:#c82728;">row</span><span>];
</span><span>    </span><span style="color:#8959a8;">return</span><span> cell;
</span><span>}
</span><span>
</span><span style="color:#3e999f;">- </span><span>(</span><span style="color:#8959a8;">void</span><span>)collectionView</span><span style="color:#3e999f;">:</span><span>(UICollectionView </span><span style="color:#3e999f;">*</span><span>)collectionView didSelectItemAtIndexPath</span><span style="color:#3e999f;">:</span><span>(</span><span style="color:#c99e00;">NSIndexPath </span><span style="color:#3e999f;">*</span><span>)indexPath
</span><span>{
</span><span>    HBCellViewModel </span><span style="color:#3e999f;">*</span><span>cellViewModel </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">viewModel</span><span>.</span><span style="color:#c82728;">cellViewModels</span><span>[indexPath.</span><span style="color:#c82728;">row</span><span>];
</span><span>	</span><span style="color:#8e908c;">// å¯¹cellViewModelæ‰§è¡ŒæŸäº›æ“ä½œï¼Œå› ä¸ºCellå·²ç»ä¸cellViewModelç»‘å®šï¼Œæ‰€ä»¥cellViewModelçš„æ”¹å˜ä¹Ÿä¼šåæ˜ åˆ°Cellä¸Š
</span><span>	</span><span style="color:#8e908c;">// æˆ–æ‹¿åˆ°cellViewModelçš„æ•°æ®æ¥æ‰§è¡ŒæŸäº›æ“ä½œ
</span><span>}
</span></code></pre>
<h4 id="viewmodel-zhong-signal-property-command-de-shi-yong">ViewModel ä¸­ signal, property, command çš„ä½¿ç”¨</h4>
<p>åˆæ¬¡ä½¿ç”¨ RAC+MVVM æ—¶ï¼Œå¾€å¾€ä¼šç–‘æƒ‘ï¼Œä»€ä¹ˆæ—¶å€™ç”¨ signalï¼Œä»€ä¹ˆæ—¶å€™ç”¨ propertyï¼Œä»€ä¹ˆæ—¶å€™ç”¨ commandï¼Ÿ</p>
<p>ä¸€èˆ¬æ¥è¯´å¯ä»¥ä½¿ç”¨ property çš„å°±ç›´æ¥ä½¿ç”¨ï¼Œæ²¡å¿…è¦å†è½¬æ¢æˆ signalï¼Œå¤–éƒ¨ RACObserve å³å¯ã€‚ä½¿ç”¨ signal çš„åœºæ™¯ä¸€èˆ¬æ˜¯æ¶‰åŠåˆ°å¤šä¸ª property æˆ–å¤šä¸ª signal åˆå¹¶ä¸ºä¸€ä¸ª signalã€‚command å¾€å¾€ä¸ UIControl/ç½‘ç»œè¯·æ±‚æŒ‚é’©ã€‚</p>
<h3 id="chang-jian-chang-jing-de-chu-li">å¸¸è§åœºæ™¯çš„å¤„ç†</h3>
<h4 id="jian-cha-ben-di-huan-cun-ru-guo-shi-xiao-ze-qu-qing-qiu-wang-luo-shu-ju-bing-huan-cun-dao-ben-di">æ£€æŸ¥æœ¬åœ°ç¼“å­˜ï¼Œå¦‚æœå¤±æ•ˆåˆ™å»è¯·æ±‚ç½‘ç»œæ•°æ®å¹¶ç¼“å­˜åˆ°æœ¬åœ°</h4>
<p><a href="https://github.com/ReactiveCocoa/ReactiveCocoa/issues/1166">æ¥æº</a></p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#3e999f;">- </span><span>(RACSignal </span><span style="color:#3e999f;">*</span><span>)loadData {
</span><span>    </span><span style="color:#8959a8;">return </span><span>[[RACSignal
</span><span>        createSignal</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id</span><span>&lt;RACSubscriber&gt; subscriber) {
</span><span>            </span><span style="color:#8e908c;">// If the cache is valid then we can just immediately send the
</span><span>            </span><span style="color:#8e908c;">// cached data and be done.
</span><span>            </span><span style="color:#8959a8;">if </span><span>(</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">cacheValid</span><span>) {
</span><span>                [subscriber </span><span style="color:#4271ae;">sendNext:</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">.</span><span style="color:#c82728;">cachedData</span><span>];
</span><span>                [subscriber </span><span style="color:#4271ae;">sendCompleted</span><span>];
</span><span>            } </span><span style="color:#8959a8;">else </span><span>{
</span><span>                [subscriber </span><span style="color:#4271ae;">sendError:</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">.</span><span style="color:#c82728;">staleCacheError</span><span>];
</span><span>            }
</span><span>        }]
</span><span>        </span><span style="color:#8e908c;">// Do the subscription work on some random scheduler, off the main
</span><span>        </span><span style="color:#8e908c;">// thread.
</span><span>        subscribeOn</span><span style="color:#3e999f;">:</span><span>[RACScheduler </span><span style="color:#4271ae;">scheduler</span><span>]];
</span><span>}
</span><span>
</span><span style="color:#3e999f;">- </span><span>(</span><span style="color:#8959a8;">void</span><span>)update {
</span><span>    [[[[</span><span style="color:#c82728;">self
</span><span>        loadData]
</span><span>        </span><span style="color:#8e908c;">// Catch the error from -loadData. It means our cache is stale. Update
</span><span>        </span><span style="color:#8e908c;">// our cache and save it.
</span><span>        catch</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#c99e00;">NSError </span><span style="color:#3e999f;">*</span><span>error) {
</span><span>            </span><span style="color:#8959a8;">return </span><span>[[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">updateCachedData</span><span>] doNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>data) {
</span><span>                [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">cacheData:data</span><span>];
</span><span>            }];
</span><span>        }]
</span><span>        </span><span style="color:#8e908c;">// Our work up until now has been on a background scheduler. Get our
</span><span>        </span><span style="color:#8e908c;">// results delivered on the main thread so we can do UI work.
</span><span>        deliverOn</span><span style="color:#3e999f;">:</span><span>RACScheduler.</span><span style="color:#c82728;">mainThreadScheduler</span><span>]
</span><span>        subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>data) {
</span><span>            </span><span style="color:#8e908c;">// Update your UI based on `data`.
</span><span>
</span><span>            </span><span style="color:#8e908c;">// Update again after `updateInterval` seconds have passed.
</span><span>            [[RACSignal </span><span style="color:#4271ae;">interval:updateInterval</span><span>] take</span><span style="color:#3e999f;">:</span><span style="color:#f07219;">1</span><span>] subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>_) {
</span><span>                [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">update</span><span>];
</span><span>            }];
</span><span>        }];
</span><span>}
</span></code></pre>
<h4 id="jian-ce-yong-hu-ming-shi-fou-ke-yong">æ£€æµ‹ç”¨æˆ·åæ˜¯å¦å¯ç”¨</h4>
<p><a href="https://github.com/ReactiveCocoa/ReactiveCocoa/issues/1236">æ¥æº</a></p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#3e999f;">- </span><span>(</span><span style="color:#8959a8;">void</span><span>)setupUsernameAvailabilityChecking {
</span><span>    </span><span style="color:#c82728;">RAC</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">, availabilityStatus) </span><span style="color:#3e999f;">= </span><span>[[[</span><span style="color:#c82728;">RACObserve</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">.</span><span style="color:#c82728;">userTemplate</span><span style="color:#4271ae;">, username)
</span><span>                                      throttle</span><span style="color:#3e999f;">:</span><span>kUsernameCheckThrottleInterval] </span><span style="color:#8e908c;">//throttleè¡¨ç¤ºintervalæ—¶é—´å†…å¦‚æœæœ‰sendNextï¼Œåˆ™æ”¾å¼ƒè¯¥nextValue
</span><span>                                      map</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>username) {
</span><span>                                          </span><span style="color:#8959a8;">if </span><span>(username.</span><span style="color:#c82728;">length </span><span style="color:#3e999f;">== </span><span style="color:#f07219;">0</span><span>) </span><span style="color:#8959a8;">return </span><span>[RACSignal </span><span style="color:#4271ae;">return:@(UsernameAvailabilityCheckStatusEmpty)</span><span>];
</span><span>                                          </span><span style="color:#8959a8;">return </span><span>[[[[[FIBAPIClient </span><span style="color:#4271ae;">sharedInstance</span><span>]
</span><span>                                                getUsernameAvailabilityFor</span><span style="color:#3e999f;">:</span><span>username ignoreCache</span><span style="color:#3e999f;">:</span><span style="color:#f07219;">NO</span><span>]
</span><span>                                              map</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#c99e00;">NSDictionary </span><span style="color:#3e999f;">*</span><span>result) {
</span><span>                                                  </span><span style="color:#c99e00;">NSNumber </span><span style="color:#3e999f;">*</span><span>existsNumber </span><span style="color:#3e999f;">=</span><span> result[</span><span style="color:#839c00;">@&quot;exists&quot;</span><span>];
</span><span>                                                  </span><span style="color:#8959a8;">if </span><span>(</span><span style="color:#3e999f;">!</span><span>existsNumber) </span><span style="color:#8959a8;">return</span><span> @(UsernameAvailabilityCheckStatusFailed);
</span><span>                                                  UsernameAvailabilityCheckStatus status </span><span style="color:#3e999f;">= </span><span>[existsNumber </span><span style="color:#4271ae;">boolValue</span><span>] </span><span style="color:#3e999f;">?</span><span> UsernameAvailabilityCheckStatusUnavailable </span><span style="color:#3e999f;">:</span><span> UsernameAvailabilityCheckStatusAvailable;
</span><span>                                                  </span><span style="color:#8959a8;">return</span><span> @(status);
</span><span>                                              }]
</span><span>                                             catch</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#c99e00;">NSError </span><span style="color:#3e999f;">*</span><span>error) {
</span><span>                                                  </span><span style="color:#8959a8;">return </span><span>[RACSignal </span><span style="color:#4271ae;">return:@(UsernameAvailabilityCheckStatusFailed)</span><span>];
</span><span>                                              }] startWith</span><span style="color:#3e999f;">:</span><span>@(UsernameAvailabilityCheckStatusChecking)];
</span><span>                                      }]
</span><span>                                      switchToLatest];
</span><span>}
</span></code></pre>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œä¹Ÿä½¿ç”¨äº†<code>map</code> + <code>switchToLatest</code>æ¨¡å¼ï¼Œè¿™æ ·å°±å¯ä»¥è‡ªåŠ¨å–æ¶ˆä¸Šä¸€æ¬¡çš„ç½‘ç»œè¯·æ±‚ã€‚</p>
<p><code>startWith</code>çš„å†…éƒ¨å®ç°æ˜¯<code>concat</code>ï¼Œè¿™é‡Œè¡¨ç¤ºå…ˆå°†çŠ¶æ€ç½®ä¸º checkingï¼Œç„¶åå†æ ¹æ®ç½‘ç»œè¯·æ±‚çš„ç»“æœè®¾ç½®çŠ¶æ€ã€‚</p>
<h4 id="shi-yong-takeuntil-lai-chu-li-cell-de-button-dian-ji">ä½¿ç”¨ takeUntil:æ¥å¤„ç† Cell çš„ button ç‚¹å‡»</h4>
<p>è¿™ä¸ªä¸Šé¢å·²ç»æåˆ°è¿‡äº†ã€‚</p>
<h4 id="token-guo-qi-hou-zi-dong-huo-qu-xin-de">token è¿‡æœŸåè‡ªåŠ¨è·å–æ–°çš„</h4>
<p>å¼€å‘ APIClient æ—¶ï¼Œä¼šç”¨åˆ° AccessTokenï¼Œè¿™ä¸ª Token è¿‡ä¸€æ®µæ—¶é—´ä¼šè¿‡æœŸï¼Œéœ€è¦å»è¯·æ±‚æ–°çš„ Tokenã€‚æ¯”è¾ƒå¥½çš„ç”¨æˆ·ä½“éªŒæ˜¯å½“ token è¿‡æœŸåï¼Œè‡ªåŠ¨å»è·å–æ–°çš„ Tokenï¼Œæ‹¿åˆ°åç»§ç»­ä¸Šä¸€æ¬¡çš„è¯·æ±‚ï¼Œè¿™æ ·å¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>RACSignal </span><span style="color:#3e999f;">*</span><span>requestSignal </span><span style="color:#3e999f;">= </span><span>[RACSignal </span><span style="color:#4271ae;">createSignal:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">RACDisposable </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">(</span><span style="color:#8959a8;">id</span><span style="color:#4271ae;">&lt;RACSubscriber&gt; subscriber) {
</span><span style="color:#4271ae;">        </span><span style="color:#8e908c;">// suppose first time send request, access token is expired or invalid
</span><span style="color:#4271ae;">        </span><span style="color:#8e908c;">// and next time it is correct.
</span><span style="color:#4271ae;">        </span><span style="color:#8e908c;">// the block will be triggered twice.
</span><span style="color:#4271ae;">        </span><span style="color:#8959a8;">static BOOL</span><span style="color:#4271ae;"> isFirstTime </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">0</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">        </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">url </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">@&quot;http://httpbin.org/ip&quot;</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">        </span><span style="color:#8959a8;">if </span><span style="color:#4271ae;">(</span><span style="color:#3e999f;">!</span><span style="color:#4271ae;">isFirstTime) {
</span><span style="color:#4271ae;">            url </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">@&quot;http://nonexists.com/error&quot;</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">            isFirstTime </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">1</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">        }
</span><span style="color:#4271ae;">        NSLog(</span><span style="color:#839c00;">@&quot;url:</span><span>%@</span><span style="color:#839c00;">&quot;</span><span style="color:#4271ae;">, url);
</span><span style="color:#4271ae;">        [[AFHTTPRequestOperationManager manager] GET</span><span style="color:#3e999f;">:</span><span style="color:#4271ae;">url parameters</span><span style="color:#3e999f;">:</span><span style="color:#f07219;">nil</span><span style="color:#4271ae;"> success</span><span style="color:#3e999f;">:^</span><span style="color:#4271ae;">(AFHTTPRequestOperation </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">operation, </span><span style="color:#8959a8;">id </span><span style="color:#4271ae;">responseObject) {
</span><span style="color:#4271ae;">            [subscriber sendNext:responseObject];
</span><span style="color:#4271ae;">            [subscriber sendCompleted];
</span><span style="color:#4271ae;">        } failure</span><span style="color:#3e999f;">:^</span><span style="color:#4271ae;">(AFHTTPRequestOperation </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">operation, </span><span style="color:#c99e00;">NSError </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">error) {
</span><span style="color:#4271ae;">            [subscriber sendError:error];
</span><span style="color:#4271ae;">        }];
</span><span style="color:#4271ae;">        </span><span style="color:#8959a8;">return </span><span style="color:#f07219;">nil</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">    }</span><span>];
</span><span>
</span><span>    self.</span><span style="color:#c82728;">statusLabel</span><span>.</span><span style="color:#c82728;">text </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">@&quot;sending request...&quot;</span><span>;
</span><span>    [[requestSignal </span><span style="color:#4271ae;">catch:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">RACSignal </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">(</span><span style="color:#c99e00;">NSError </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">error) {
</span><span style="color:#4271ae;">        </span><span style="color:#c82728;">self</span><span style="color:#4271ae;">.</span><span style="color:#c82728;">statusLabel</span><span style="color:#4271ae;">.</span><span style="color:#c82728;">text </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">@&quot;oops, invalid access token&quot;</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">
</span><span style="color:#4271ae;">        </span><span style="color:#8e908c;">// simulate network request, and we fetch the right access token
</span><span style="color:#4271ae;">        </span><span style="color:#8959a8;">return </span><span style="color:#4271ae;">[[RACSignal createSignal:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">RACDisposable </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">(</span><span style="color:#8959a8;">id</span><span style="color:#4271ae;">&lt;RACSubscriber&gt; subscriber) {
</span><span style="color:#4271ae;">            </span><span style="color:#8959a8;">double</span><span style="color:#4271ae;"> delayInSeconds </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">1.0</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">            dispatch_time_t popTime </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">dispatch_time</span><span style="color:#4271ae;">(DISPATCH_TIME_NOW, (</span><span style="color:#c99e00;">int64_t</span><span style="color:#4271ae;">)(delayInSeconds </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;"> NSEC_PER_SEC));
</span><span style="color:#4271ae;">            </span><span style="color:#c82728;">dispatch_after</span><span style="color:#4271ae;">(popTime, </span><span style="color:#c82728;">dispatch_get_main_queue</span><span style="color:#4271ae;">(), </span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">(</span><span style="color:#8959a8;">void</span><span style="color:#4271ae;">){
</span><span style="color:#4271ae;">                [subscriber sendNext:@</span><span style="color:#f07219;">YES</span><span style="color:#4271ae;">];
</span><span style="color:#4271ae;">                [subscriber sendCompleted];
</span><span style="color:#4271ae;">            });
</span><span style="color:#4271ae;">            </span><span style="color:#8959a8;">return </span><span style="color:#f07219;">nil</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">        }] concat</span><span style="color:#3e999f;">:</span><span style="color:#4271ae;">requestSignal];
</span><span style="color:#4271ae;">    }</span><span>] subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>x) {
</span><span>        </span><span style="color:#8959a8;">if </span><span>([x </span><span style="color:#4271ae;">isKindOfClass:[</span><span style="color:#c99e00;">NSDictionary </span><span style="color:#4271ae;">class]</span><span>]) {
</span><span>            </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">statusLabel</span><span>.</span><span style="color:#c82728;">text </span><span style="color:#3e999f;">= </span><span>[</span><span style="color:#c99e00;">NSString </span><span style="color:#4271ae;">stringWithFormat:</span><span style="color:#839c00;">@&quot;result:</span><span>%@</span><span style="color:#839c00;">&quot;</span><span style="color:#4271ae;">, x[</span><span style="color:#839c00;">@&quot;origin&quot;</span><span style="color:#4271ae;">]</span><span>];
</span><span>        }
</span><span>    } completed</span><span style="color:#3e999f;">:^</span><span>{
</span><span>        </span><span style="color:#4271ae;">NSLog</span><span>(</span><span style="color:#839c00;">@&quot;completed&quot;</span><span>);
</span><span>    }];
</span></code></pre>
<h3 id="zhu-yi-shi-xiang">æ³¨æ„äº‹é¡¹</h3>
<p>RAC æˆ‘è‡ªå·±æ„Ÿè§‰é‡åˆ°çš„å‡ ä¸ªéš¾ç‚¹æ˜¯: 1) ç†è§£ RAC çš„ç†å¿µã€‚ 2) ç†Ÿæ‚‰å¸¸ç”¨çš„ APIã€‚3) é’ˆå¯¹æŸäº›ç‰¹å®šçš„åœºæ™¯ï¼Œæƒ³å‡ºæ¯”è¾ƒåˆç†çš„ RAC å¤„ç†æ–¹å¼ã€‚ä¸è¿‡çœ‹å¤šäº†ï¼Œå†™å¤šäº†ï¼Œæƒ³å¤šäº†å°±ä¼šæ…¢æ…¢é€‚åº”ã€‚ä¸‹é¢æ˜¯æˆ‘åœ¨å®è·µè¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›å°å‘ã€‚</p>
<h4 id="reactivecocoalayout">ReactiveCocoaLayout</h4>
<p>æœ‰æ—¶ Cell çš„å†…å®¹æ¶‰åŠåˆ°åŠ¨æ€çš„é«˜åº¦ï¼Œå°±ä¼šæƒ³åˆ°ç”¨ Autolayout æ¥å¸ƒå±€ï¼Œä½† RAC å·²ç»ä¸ºæˆ‘ä»¬å‡†å¤‡å¥½äº†<a href="https://github.com/ReactiveCocoa/ReactiveCocoaLayout">ReactiveCocoaLayout</a>ï¼Œæ‰€ä»¥æˆ‘æƒ³ä¸å¦¨å°±æ‹¿æ¥ç”¨ä¸€ä¸‹ã€‚</p>
<p><code>ReactiveCocoaLayout</code>çš„ä½¿ç”¨å¥½æ¯”ã€Œæ‰¹åœ°ã€å’Œã€Œç›–æˆ¿ã€ï¼Œå…ˆé€šè¿‡<code>insetWidth:height:nullRect</code>ä»æŸä¸ª View ä¸­åˆ’å‡ºä¸€å°å—ï¼Œæ‹¿åˆ°ä¹‹åè¿˜å¯ä»¥é€šè¿‡<code>divideWithAmount:padding:fromEdge</code> å†åˆ†æˆä¸¤å—ï¼Œæˆ–<code>sliceWithAmount:fromEdge</code>å†åˆ†å‡ºä¸€å—ã€‚è¿™äº›æ–¹æ³•è¿”å›çš„éƒ½æ˜¯ signalï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡<code>RAC(self.view, frame) = someRectSignal</code> è¿™æ ·æ¥å®ç°ç»‘å®šã€‚ä½†åœ¨å®è·µä¸­å‘ç°æ€§èƒ½ä¸æ˜¯å¾ˆå¥½ï¼Œå¤šæ‰¹äº†å‡ å—åœ°å°±å®¹æ˜“é€ æˆä¸»çº¿ç¨‹å¡é¡¿ã€‚</p>
<p>æ‰€ä»¥<code>ReactiveCocoaLayout</code>æœ€å¥½ä¸ç”¨æˆ–å°‘ç”¨ã€‚</p>
<h4 id="diao-shi">è°ƒè¯•</h4>

<p  style="text-align:center" ><img src="&#x2F;posts&#x2F;deep-into-reactivecocoa2&#x2F;rac-debug.png"
        width="276" /></p>
<p>åˆšå¼€å§‹å†™ RAC æ—¶ï¼Œå¾€å¾€ä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼Œæ»¡å±çš„è°ƒç”¨æ ˆä¿¡æ¯éƒ½æ˜¯ RAC çš„ï¼Œè¦æ‰¾å‡ºçœŸæ­£å‡ºç°é—®é¢˜çš„åœ°æ–¹ä¸å®¹æ˜“ã€‚æ›¾ç»æœ‰ä¸€æ¬¡åœ¨ä½¿ç”¨<code>[RACSignal combineLatest: reduce:^id{}]</code>æ—¶ï¼Œå¿˜äº†åœ¨ Block é‡Œè¿”å› valueï¼Œè€Œ Xcode ä¹Ÿæ²¡æœ‰æç¤º warningï¼Œç„¶åå°±æ˜¯è«åå…¶å¦™åœ°æŒ‚èµ·äº†ï¼Œè·³åˆ°äº†æ±‡ç¼–ä¸Šï¼Œä¹Ÿæ²¡æœ‰è°ƒç”¨æ ˆä¿¡æ¯ï¼Œè¿™æ—¶å°±åªèƒ½é€šè¿‡æœ€å¤è€çš„æ³¨é‡Šä»£ç çš„æ–¹å¼æ¥æ‰¾åˆ°é—®é¢˜çš„æ ¹æºã€‚</p>
<p>ä¸è¿‡å†™å¤šäº†ä¹‹åï¼Œä¸€èˆ¬ä¸å¤ªä¼šçŠ¯è¿™ç§ä½çº§é”™è¯¯ã€‚</p>
<h4 id="strongify-weakify-dance">strongify / weakify dance</h4>
<p>å› ä¸º RAC å¾ˆå¤šæ“ä½œéƒ½æ˜¯åœ¨ Block ä¸­å®Œæˆçš„ï¼Œè¿™å—æœ€å¸¸è§çš„é—®é¢˜å°±æ˜¯åœ¨ block ç›´æ¥æŠŠ self æ‹¿æ¥ç”¨ï¼Œé€ æˆ block å’Œ self çš„ retain cycleã€‚æ‰€ä»¥éœ€è¦é€šè¿‡<code>@strongify</code>å’Œ<code>@weakify</code>æ¥æ¶ˆé™¤å¾ªç¯å¼•ç”¨ã€‚</p>
<p>æœ‰äº›åœ°æ–¹å¾ˆå®¹æ˜“è¢«å¿½ç•¥ï¼Œæ¯”å¦‚<code>RACObserve(thing, keypath)</code>ï¼Œçœ‹ä¸Šå»å¹¶æ²¡æœ‰å¼•ç”¨ selfï¼Œæ‰€ä»¥åœ¨<code>subscribeNext</code>æ—¶å°±å¿˜è®°äº† weakify/strongifyã€‚ä½†äº‹å®ä¸Š<code>RACObserve</code>æ€»æ˜¯ä¼šå¼•ç”¨ selfï¼Œå³ä½¿ target ä¸æ˜¯ selfï¼Œæ‰€ä»¥åªè¦æœ‰<code>RACObserve</code>çš„åœ°æ–¹éƒ½è¦ä½¿ç”¨ weakify/strongifyã€‚</p>
<h3 id="xiao-jie">å°ç»“</h3>
<p>ä»¥ä¸Šæ˜¯æˆ‘åœ¨åšèŠ±ç“£å®¢æˆ·ç«¯å’Œ side project æ—¶æ€»ç»“çš„ä¸€äº›ç»éªŒï¼Œä½†æ„¿èƒ½å¸¦æ¥ä¸€äº›å¸®åŠ©ï¼Œæœ‰è¯¯çš„åœ°æ–¹ä¹Ÿæ¬¢è¿æŒ‡æ­£å’Œæ¢è®¨ã€‚</p>
<p>æ¨èä¸€ä¸‹ jspahrsummers çš„<a href="https://github.com/jspahrsummers/GroceryList">è¿™ä¸ª project</a>ï¼Œè™½ç„¶æ˜¯ç”¨ RAC3.0 å†™çš„ï¼Œä½†å¾ˆå¤šç†å¿µä¹Ÿå¯ä»¥ç”¨åˆ° RAC2 ä¸Šé¢ã€‚</p>
<p>æœ€åæ„Ÿè°¢ Github çš„ iOS å·¥ç¨‹å¸ˆä»¬ï¼Œæ„Ÿè°¢ä½ ä»¬å¸¦æ¥äº† RACï¼Œä»¥åŠåœ¨ Issues é‡Œçš„è€å¿ƒè§£ç­”ã€‚</p>

  </div>


  <ul class="tags flex flex-wrap justify-center items-center gap-4 mt-5 mb-8 text-lg">
    
    
    <li
      class="px-4 pb-[2px] leading-8 rounded-full border text-gray-700 border-gray-700 hover:text-gray-100 hover:border-gray-900 hover:bg-gray-900 transition-all">
      <a class="inline-block" href="https://limboy.me/tags/programming/">programming</a>
    </li>
    
    <li
      class="px-4 pb-[2px] leading-8 rounded-full border text-gray-700 border-gray-700 hover:text-gray-100 hover:border-gray-900 hover:bg-gray-900 transition-all">
      <a class="inline-block" href="https://limboy.me/tags/rac/">RAC</a>
    </li>
    
    
  </ul>

  
  <script src="https://giscus.app/client.js" data-repo="limboy/telescope"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzODEwOTA2MTg=" data-category="General"
    data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMzMDY2MTQy" data-mapping="title" data-reactions-enabled="1"
    data-emit-metadata="0" data-theme="light" data-lang="en" crossorigin="anonymous" async>
    </script>
  

  

</div>

      </div>
    </div>
    
    <footer
      class="flex border-t border-gray-300 text-gray-600 bg-gray-50 items-center justify-center h-12 text-sm mt-2">
      <div class="flex inner justify-center gap-4">
        <a class="hover:underline" href="https://github.com/limboy" target="_blank">GitHub</a>
        <a class="hover:underline" href="https://twitter.com/_limboy" target="_blank">Twitter</a>
        <a class="hover:underline" href="https://limboy.me/index.xml">RSS</a>
      </div>
    </footer>
    
  </div>

  
  

  <script>
    // éƒ½æ˜¯ä¸ºäº† iOS...
    document.querySelector("#wrapper").style.minHeight = `calc(${window.innerHeight}px - 6.5rem)`
    window.addEventListener('resize', () => {
      document.querySelector("#wrapper").style.minHeight = `calc(${window.innerHeight}px - 6.5rem)`
    })
  </script>
</body>

</html>