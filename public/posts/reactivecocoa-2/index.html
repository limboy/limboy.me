<!DOCTYPE html>
<html>

<head>
  <meta content="width=device-width,initial-scale=1" name="viewport" />
  <meta charset="UTF-8">
  <link rel="icon" href="https://fav.farm/ğŸ‘»" />
  <title>
è¯´è¯´ReactiveCocoa 2
</title>
  <link rel="stylesheet" href="/assets/main.css?9zs&#x2F;BXhW+t7PNacyPraNbWdNoN&#x2F;V7G9VhdTj5z3mo8A=" />
  <script async defer data-domain="limboy.me" src="https://analytics.limboy.me/js/plausible.js"></script>
  
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@_limboy">
<meta name="twitter:site" content="@_limboy">
<meta property="og:url" content="https://limboy.me/posts/reactivecocoa-2/">

<meta name="twitter:title" content="è¯´è¯´ReactiveCocoa 2">
<meta property="og:title" content="è¯´è¯´ReactiveCocoa 2">

<meta property="og:description" content="">
<meta name="twitter:description" content="">



</head>

<body class="  ">
  <nav class="flex justify-center items-center bg-zinc-700 h-12 py-0 ">
    <div class="inner flex justify-between flex-row mx-1">
      <ul class="color-white flex flex-row justify-start gap-4">
        <li><a class="nav-link opacity-90 text-2xl" href="/">Limboy</a></li>
        <!--<li><a class="nav-link" href="/coodle">Coodle</a></li>-->
      </ul>
      <ul class="color-white flex flex-row gap-4 items-center text-base">
        <!--<li> <a class="nav-link" href="/books" class="decoration-0"> Books </a> </li>-->
        <li> <a class="nav-link" href="/highlights" class="decoration-0"> Highlights </a> </li>
        <li> <a class="nav-link" href="/projects" class="decoration-0"> Projects </a> </li>
        <li> <a class="nav-link" href="/about" class="decoration-0"> About </a> </li>
      </ul>
    </div>
  </nav>

  <div class="flex flex-col">
    <div id="wrapper" class="flex justify-center" style="min-height: calc(100vh - 6.5rem);">
      <div class="inner mb-2">
        
<div class="mt-4 lg:mt-6">
  

  <h1 class="title font-medium text-3xl"><a href="https:&#x2F;&#x2F;limboy.me&#x2F;posts&#x2F;reactivecocoa-2&#x2F;">è¯´è¯´ReactiveCocoa 2</a></h1>
  <div class="flex gap-4 items-center my-1">
    <time class="text-gray-500">2013-12-27</time>

  </div>
  <hr class="border-t-[3px]" />

  <div class="prose lg:prose-xl max-w-full my-6">
    <p><a href="https://github.com/ReactiveCocoa/ReactiveCocoa">ReactiveCocoa</a>æ˜¯<a href="https://github.com/blog/1107-reactivecocoa-for-a-better-world">Github</a>å¼€æºçš„ä¸€æ¬¾ cocoa FRP æ¡†æ¶ï¼Œæˆ‘åœ¨<a href="http://blog.leezhong.com/ios/2013/06/19/frp-reactivecocoa.html">ä¹‹å‰çš„æ–‡ç« </a>é‡Œæœ‰è¿‡ä»‹ç»(å½“æ—¶è¿˜æ˜¯ 1.x ç‰ˆæœ¬ï¼Œ2.x ç‰ˆæœ¬æœ‰äº†æ–°çš„å˜åŒ–ï¼ŒAPI ä¹Ÿæœ‰éƒ¨åˆ†ä¸å…¼å®¹) è¿™é‡Œå†ç®€å•åœ°æä¸€ä¸‹ã€‚</p>
<p>Native app æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†çš„æ—¶é—´æ˜¯åœ¨ç­‰å¾…äº‹ä»¶å‘ç”Ÿï¼Œç„¶åå“åº”äº‹ä»¶ï¼Œæ¯”å¦‚ç­‰å¾…ç½‘ç»œè¯·æ±‚å®Œæˆï¼Œç­‰å¾…ç”¨æˆ·çš„æ“ä½œï¼Œç­‰å¾…æŸäº›çŠ¶æ€å€¼çš„æ”¹å˜ç­‰ç­‰ï¼Œç­‰è¿™äº›äº‹ä»¶å‘ç”Ÿåï¼Œå†åšè¿›ä¸€æ­¥å¤„ç†ã€‚ ä½†æ˜¯è¿™äº›ç­‰å¾…å’Œå“åº”ï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„å¤„ç†æ–¹å¼ã€‚Delegate, Notification, Block, KVO, å¸¸å¸¸ä¼šä¸çŸ¥é“è¯¥ç”¨å“ªä¸ªæœ€åˆé€‚ã€‚æœ‰æ—¶éœ€è¦ chain æˆ–è€… compose æŸå‡ ä¸ªäº‹ä»¶ï¼Œå°±éœ€è¦å¤šä¸ªçŠ¶æ€å˜é‡ï¼Œè€ŒçŠ¶æ€å˜é‡ä¸€å¤šï¼Œå¤æ‚åº¦ä¹Ÿå°±ä¸Šæ¥äº†ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒGithub çš„å·¥ç¨‹å¸ˆä»¬å¼€å‘äº† ReactiveCocoaã€‚</p>
<h2 id="ji-ge-chang-jian-de-gai-nian">å‡ ä¸ªå¸¸è§çš„æ¦‚å¿µ</h2>
<p>åœ¨é˜…è¯» ReactiveCocoa(ä»¥ä¸‹ç®€ç§° RAC)çš„ç›¸å…³æ–‡ç« æˆ–ä»£ç æ—¶ï¼Œç»å¸¸ä¼šå‡ºç°ä¸€äº›åè¯ï¼Œç†è§£å®ƒä»¬å¯¹äºç†è§£ RAC æœ‰å¾ˆå¤§çš„å¸®åŠ©ï¼Œä¸‹é¢å°±ç®€è¦æ¥è¯´è¯´è¿™äº›å¸¸è§çš„æ¦‚å¿µã€‚</p>
<h3 id="signal-and-subscriber">Signal and Subscriber</h3>
<p>è¿™æ˜¯ RAC æœ€æ ¸å¿ƒçš„å†…å®¹ï¼Œè¿™é‡Œæˆ‘æƒ³ç”¨æ’å¤´å’Œæ’åº§æ¥æè¿°ï¼Œæ’åº§æ˜¯ Signalï¼Œæ’å¤´æ˜¯ Subscriberã€‚æƒ³è±¡æŸä¸ªé¥è¿œçš„æ˜Ÿçƒï¼Œä»–ä»¬çš„ç”µåƒæŸç§ç‰©è´¨ä¸€æ ·è¢«é›†ä¸­å­˜å‚¨ï¼Œä¸”å¾ˆçè´µã€‚æ’åº§è´Ÿè´£å»è·å–ç”µï¼Œæ’å¤´è´Ÿè´£ä½¿ç”¨ç”µï¼Œè€Œä¸”ä¸€ä¸ªæ’åº§å¯ä»¥æ’ä»»æ„æ•°é‡çš„æ’å¤´ã€‚å½“ä¸€ä¸ªæ’åº§(Signal)æ²¡æœ‰æ’å¤´(Subscriber)æ—¶ä»€ä¹ˆä¹Ÿä¸å¹²ï¼Œä¹Ÿå°±æ˜¯å¤„äºå†·(Cold)çš„çŠ¶æ€ï¼Œåªæœ‰æ’äº†æ’å¤´æ—¶æ‰ä¼šå»è·å–ï¼Œè¿™ä¸ªæ—¶å€™å°±å¤„äºçƒ­(Hot)çš„çŠ¶æ€ã€‚</p>
<p>Signal è·å–åˆ°æ•°æ®åï¼Œä¼šè°ƒç”¨ Subscriber çš„ sendNext, sendComplete, sendError æ–¹æ³•æ¥ä¼ é€æ•°æ®ç»™ Subscriberï¼ŒSubscriber è‡ªç„¶ä¹Ÿæœ‰æ–¹æ³•æ¥è·å–ä¼ è¿‡æ¥çš„æ•°æ®ï¼Œå¦‚ï¼š[signal subscribeNext:error:completed]ã€‚è¿™æ ·åªè¦æ²¡æœ‰ sendComplete å’Œ sendErrorï¼Œæ–°çš„å€¼å°±ä¼šé€šè¿‡ sendNext æºæºä¸æ–­åœ°ä¼ é€è¿‡æ¥ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>[</span><span style="color:#c82728;">RACObserve</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">, username)</span><span> subscribeNext</span><span style="color:#3e999f;">: ^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>newName){
</span><span>	</span><span style="color:#4271ae;">NSLog</span><span>(</span><span style="color:#839c00;">@&quot;newName:</span><span>%@</span><span style="color:#839c00;">&quot;</span><span>, newName);
</span><span>}];
</span></code></pre>
<p><code>RACObserve</code>ä½¿ç”¨äº† KVO æ¥ç›‘å¬ property çš„å˜åŒ–ï¼Œåªè¦ username è¢«è‡ªå·±æˆ–å¤–éƒ¨æ”¹å˜ï¼Œblock å°±ä¼šè¢«æ‰§è¡Œã€‚ä½†ä¸æ˜¯æ‰€æœ‰çš„ property éƒ½å¯ä»¥è¢«<code>RACObserve</code>ï¼Œè¯¥ property å¿…é¡»æ”¯æŒ KVOï¼Œæ¯”å¦‚ NSURLCache çš„ currentDiskUsage å°±ä¸èƒ½è¢«<code>RACObserve</code>ã€‚</p>
<p>Signal æ˜¯å¾ˆçµæ´»çš„ï¼Œå®ƒå¯ä»¥è¢«ä¿®æ”¹(map)ï¼Œè¿‡æ»¤(filter)ï¼Œå åŠ (combine)ï¼Œä¸²è”(chain)ï¼Œè¿™æœ‰åŠ©äºåº”å¯¹æ›´åŠ å¤æ‚çš„æƒ…å†µï¼Œæ¯”å¦‚ï¼š</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#c82728;">RAC</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">.</span><span style="color:#c82728;">logInButton</span><span style="color:#4271ae;">, enabled) </span><span style="color:#3e999f;">= </span><span>[RACSignal
</span><span>        combineLatest</span><span style="color:#3e999f;">:</span><span>@[
</span><span>            </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">usernameTextField</span><span>.</span><span style="color:#c82728;">rac_textSignal</span><span>,
</span><span>            </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">passwordTextField</span><span>.</span><span style="color:#c82728;">rac_textSignal</span><span>,
</span><span>            </span><span style="color:#c82728;">RACObserve</span><span style="color:#4271ae;">(LoginManager.</span><span style="color:#c82728;">sharedManager</span><span style="color:#4271ae;">, loggingIn)</span><span>,
</span><span>            </span><span style="color:#c82728;">RACObserve</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">, loggedIn)
</span><span>        ] reduce</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>username, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>password, </span><span style="color:#c99e00;">NSNumber </span><span style="color:#3e999f;">*</span><span>loggingIn, </span><span style="color:#c99e00;">NSNumber </span><span style="color:#3e999f;">*</span><span>loggedIn) {
</span><span>            </span><span style="color:#8959a8;">return</span><span> @(username.</span><span style="color:#c82728;">length </span><span style="color:#3e999f;">&gt; </span><span style="color:#f07219;">0 </span><span style="color:#3e999f;">&amp;&amp;</span><span> password.</span><span style="color:#c82728;">length </span><span style="color:#3e999f;">&gt; </span><span style="color:#f07219;">0 </span><span style="color:#3e999f;">&amp;&amp; !</span><span>loggingIn.</span><span style="color:#c82728;">boolValue </span><span style="color:#3e999f;">&amp;&amp; !</span><span>loggedIn.</span><span style="color:#c82728;">boolValue</span><span>);
</span><span>        }];
</span></code></pre>
<p>è¿™æ®µä»£ç çœ‹èµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Œæ¥ç»†ç»†è¯´ä¸€ä¸‹ï¼Œé¦–å…ˆæ˜¯å·¦è¾¹çš„<code>RAC(...)</code>ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†<code>self.logInButton.enabled</code>å±æ€§ä¸å³è¾¹çš„ signal çš„ sendNext å€¼ç»‘å®šã€‚ä¹Ÿå°±æ˜¯å¦‚æœå³è¾¹çš„ reduce çš„è¿”å›å€¼ä¸º NOï¼Œé‚£ä¹ˆ enabled å°±ä¸º NOã€‚å³è¾¹çš„<code>combineLatest</code>æ˜¯è·å–è¿™ 4 ä¸ª signal çš„ next å€¼ã€‚å…¶ä¸­å¯ä»¥çœ‹åˆ°<code>self.usernameTextField.rac_textSignal</code>è¿™ä¹ˆä¸ªä¸œä¸œï¼Œ<code>rac_textSignal</code>æ˜¯ RAC ä¸º UITextField æ·»åŠ çš„ categoryï¼Œåªè¦ usernameTextField çš„å€¼æœ‰å˜åŒ–ï¼Œè¿™ä¸ªå€¼å°±ä¼šè¢«è¿”å›(sendNext)ã€‚combineLatest éœ€è¦æ¯ä¸ª signal è‡³å°‘éƒ½æœ‰è¿‡ä¸€æ¬¡ sendNextã€‚reduce çš„ä½œç”¨æ˜¯æ ¹æ®æ¥æ”¶åˆ°çš„å€¼ï¼Œå†è¿”å›ä¸€ä¸ªæ–°çš„å€¼ï¼Œè¿™é‡Œæ˜¯@(YES)å’Œ@(NO)ï¼Œå¿…é¡»æ˜¯ objectã€‚</p>
<p>ä¸Šé¢è¿™æ®µä»£ç ç”¨åˆ°äº† Signal çš„ç»„åˆï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæ˜¯ä¼ ç»Ÿçš„æ–¹å¼ï¼Œå†™èµ·æ¥è¿˜æ˜¯æŒºå¤æ‚çš„ï¼Œè€Œä¸”éšç€åŠŸèƒ½çš„å¢åŠ ï¼Œè°ƒæ•´èµ·æ¥ä¼šæ›´åŠ éº»çƒ¦ã€‚</p>
<h3 id="leng-xin-hao-cold-he-re-xin-hao-hot">å†·ä¿¡å·(Cold)å’Œçƒ­ä¿¡å·(Hot)</h3>
<p>ä¸Šé¢æåˆ°è¿‡è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œå†·ä¿¡å·é»˜è®¤ä»€ä¹ˆä¹Ÿä¸å¹²ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç </p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>RACSignal </span><span style="color:#3e999f;">*</span><span>signal </span><span style="color:#3e999f;">= </span><span>[RACSignal </span><span style="color:#4271ae;">createSignal:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;"> RACDisposable </span><span style="color:#3e999f;">* </span><span style="color:#4271ae;">(</span><span style="color:#8959a8;">id</span><span style="color:#4271ae;">&lt;RACSubscriber&gt; subscriber) {
</span><span style="color:#4271ae;">	NSLog(</span><span style="color:#839c00;">@&quot;triggered&quot;</span><span style="color:#4271ae;">);
</span><span style="color:#4271ae;">	[subscriber sendNext:</span><span style="color:#839c00;">@&quot;foobar&quot;</span><span style="color:#4271ae;">];
</span><span style="color:#4271ae;">    [subscriber sendCompleted];
</span><span style="color:#4271ae;">    </span><span style="color:#8959a8;">return </span><span style="color:#f07219;">nil</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">}</span><span>];
</span></code></pre>
<p>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Signalï¼Œä½†å› ä¸ºæ²¡æœ‰è¢« subscribeï¼Œæ‰€ä»¥ä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿã€‚åŠ äº†ä¸‹é¢è¿™æ®µä»£ç åï¼Œsignal å°±å¤„äº Hot çš„çŠ¶æ€äº†ï¼Œblock é‡Œçš„ä»£ç å°±ä¼šè¢«æ‰§è¡Œã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>[signal </span><span style="color:#4271ae;">subscribeCompleted:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">{
</span><span style="color:#4271ae;">    NSLog(</span><span style="color:#839c00;">@&quot;subscription </span><span>%u</span><span style="color:#839c00;">&quot;</span><span style="color:#4271ae;">, subscriptions);
</span><span style="color:#4271ae;">}</span><span>];
</span></code></pre>
<p>æˆ–è®¸ä½ ä¼šé—®ï¼Œé‚£å¦‚æœè¿™æ—¶åˆæœ‰ä¸€ä¸ªæ–°çš„ subscriber äº†ï¼Œsignal çš„ block è¿˜ä¼šè¢«æ‰§è¡Œå—ï¼Ÿè¿™å°±ç‰µæ‰¯åˆ°äº†å¦ä¸€ä¸ªæ¦‚å¿µï¼šSide Effect</p>
<h3 id="side-effect">Side Effect</h3>
<p>è¿˜æ˜¯ä¸Šé¢é‚£æ®µä»£ç ï¼Œå¦‚æœæœ‰å¤šä¸ª subscriberï¼Œé‚£ä¹ˆ signal å°±ä¼šåˆä¸€æ¬¡è¢«è§¦å‘ï¼Œæ§åˆ¶å°é‡Œä¼šè¾“å‡ºä¸¤æ¬¡<code>triggered</code>ã€‚è¿™æˆ–è®¸æ˜¯ä½ æƒ³è¦çš„ï¼Œæˆ–è®¸ä¸æ˜¯ã€‚å¦‚æœè¦é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œå¯ä»¥ä½¿ç”¨ <code>replay</code> æ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯ä¿è¯ signal åªè¢«è§¦å‘ä¸€æ¬¡ï¼Œç„¶åæŠŠ sendNext çš„ value å­˜èµ·æ¥ï¼Œä¸‹æ¬¡å†æœ‰æ–°çš„ subscriber æ—¶ï¼Œç›´æ¥å‘é€ç¼“å­˜çš„æ•°æ®ã€‚</p>
<h2 id="cocoa-categories">Cocoa Categories</h2>
<p>ä¸ºäº†æ›´åŠ æ–¹ä¾¿åœ°ä½¿ç”¨ RACï¼ŒRAC ç»™ Cocoa æ·»åŠ äº†å¾ˆå¤š categoryï¼Œä¸ç³»ç»Ÿé›†æˆåœ°è¶Šç´§å¯†ï¼Œä½¿ç”¨èµ·æ¥è‡ªç„¶ä¹Ÿå°±è¶Šæ–¹ä¾¿ã€‚ä¸‹é¢æ˜¯æˆ‘è®¤ä¸ºæ¯”è¾ƒå¸¸ç”¨çš„ categoriesã€‚</p>
<h3 id="uiview-categories">UIView Categories</h3>
<p>ä¸Šé¢çœ‹åˆ°çš„<code>rac_textSignal</code>æ˜¯åŠ åœ¨ UITextField ä¸Šçš„(UITextField+RACSignalSupport.h)ï¼Œå…¶ä»–å¸¸ç”¨çš„ UIView ä¹Ÿéƒ½æœ‰æ·»åŠ ç›¸åº”çš„ categoryï¼Œæ¯”å¦‚ UIAlertViewï¼Œå°±ä¸éœ€è¦å†ç”¨ Delegate äº†ã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>UIAlertView </span><span style="color:#3e999f;">*</span><span>alertView </span><span style="color:#3e999f;">= </span><span>[[UIAlertView </span><span style="color:#4271ae;">alloc</span><span>] initWithTitle</span><span style="color:#3e999f;">:</span><span style="color:#839c00;">@&quot;&quot;</span><span> message</span><span style="color:#3e999f;">:</span><span style="color:#839c00;">@&quot;Alert&quot;</span><span> delegate</span><span style="color:#3e999f;">:</span><span style="color:#f07219;">nil</span><span> cancelButtonTitle</span><span style="color:#3e999f;">:</span><span style="color:#839c00;">@&quot;YES&quot;</span><span> otherButtonTitles</span><span style="color:#3e999f;">:</span><span style="color:#839c00;">@&quot;NO&quot;</span><span>, </span><span style="color:#f07219;">nil</span><span>];
</span><span>[[alertView </span><span style="color:#4271ae;">rac_buttonClickedSignal</span><span>] subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#c99e00;">NSNumber </span><span style="color:#3e999f;">*</span><span>indexNumber) {
</span><span>	</span><span style="color:#8959a8;">if </span><span>([indexNumber </span><span style="color:#4271ae;">intValue</span><span>] </span><span style="color:#3e999f;">== </span><span style="color:#f07219;">1</span><span>) {
</span><span>		</span><span style="color:#4271ae;">NSLog</span><span>(</span><span style="color:#839c00;">@&quot;you touched NO&quot;</span><span>);
</span><span>	} </span><span style="color:#8959a8;">else </span><span>{
</span><span>		</span><span style="color:#4271ae;">NSLog</span><span>(</span><span style="color:#839c00;">@&quot;you touched YES&quot;</span><span>);
</span><span>	}
</span><span>}];
</span><span>[alertView </span><span style="color:#4271ae;">show</span><span>];
</span></code></pre>
<p>æœ‰äº†è¿™äº› Categoryï¼Œå¤§éƒ¨åˆ†çš„ Delegate éƒ½å¯ä»¥ä½¿ç”¨ RAC æ¥åšã€‚æˆ–è®¸ä½ ä¼šæƒ³ï¼Œå¯ä¸å¯ä»¥ subscribe NSMutableArray.rac_sequence.signalï¼Œè¿™æ ·æ¯æ¬¡æœ‰æ–°çš„ object æˆ–æ—§çš„ object è¢«ç§»é™¤æ—¶éƒ½èƒ½çŸ¥é“ï¼ŒUITableViewController å°±å¯ä»¥æ ¹æ® dataSource çš„å˜åŒ–ï¼Œæ¥ reloadDataã€‚ä½†å¾ˆå¯æƒœè¿™æ ·ä¸è¡Œï¼Œå› ä¸º RAC æ˜¯åŸºäº KVO çš„ï¼Œè€Œ NSMutableArray å¹¶ä¸ä¼šåœ¨è°ƒç”¨ addObject æˆ– removeObject æ—¶å‘é€é€šçŸ¥ï¼Œæ‰€ä»¥ä¸å¯è¡Œã€‚ä¸è¿‡å¯ä»¥ä½¿ç”¨ NSArray ä½œä¸º UITableView çš„ dataSourceï¼Œåªè¦ dataSource æœ‰å˜åŠ¨å°±æ¢æˆæ–°çš„ Arrayï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚</p>
<p>è¯´åˆ° UITableViewï¼Œå†è¯´ä¸€ä¸‹ UITableViewCellï¼ŒRAC ç»™ UITableViewCell æä¾›äº†ä¸€ä¸ªæ–¹æ³•ï¼š<code>rac_prepareForReuseSignal</code>ï¼Œå®ƒçš„ä½œç”¨æ˜¯å½“ Cell å³å°†è¦è¢«é‡ç”¨æ—¶ï¼Œå‘Šè¯‰ Cellã€‚æƒ³è±¡ Cell ä¸Šæœ‰å¤šä¸ª buttonï¼ŒCell åœ¨åˆå§‹åŒ–æ—¶ç»™æ¯ä¸ª button éƒ½<code>addTarget:action:forControlEvents</code>ï¼Œè¢«é‡ç”¨æ—¶éœ€è¦å…ˆç§»é™¤è¿™äº› targetï¼Œä¸‹é¢è¿™æ®µä»£ç å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>[[[</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">cancelButton
</span><span>	rac_signalForControlEvents</span><span style="color:#3e999f;">:</span><span>UIControlEventTouchUpInside]
</span><span>	takeUntil</span><span style="color:#3e999f;">:</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">rac_prepareForReuseSignal</span><span>]
</span><span>	subscribeNext</span><span style="color:#3e999f;">:^</span><span>(UIButton </span><span style="color:#3e999f;">*</span><span>x) {
</span><span>	</span><span style="color:#8e908c;">// do other things
</span><span>}];
</span></code></pre>
<p>è¿˜æœ‰ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„ category å°±æ˜¯<code>UIButton+RACCommandSupport.h</code>ï¼Œå®ƒæä¾›äº†ä¸€ä¸ª propertyï¼š<code>rac_command</code>ï¼Œå°±æ˜¯å½“ button è¢«æŒ‰ä¸‹æ—¶ä¼šæ‰§è¡Œçš„ä¸€ä¸ªå‘½ä»¤ï¼Œå‘½ä»¤è¢«æ‰§è¡Œå®Œåå¯ä»¥è¿”å›ä¸€ä¸ª signalï¼Œæœ‰äº† signal å°±æœ‰äº†çµæ´»æ€§ã€‚æ¯”å¦‚ç‚¹å‡»æŠ•ç¥¨æŒ‰é’®ï¼Œå…ˆåˆ¤æ–­ä¸€ä¸‹æœ‰æ²¡æœ‰ç™»å½•ï¼Œå¦‚æœæœ‰å°±å‘ HTTP è¯·æ±‚ï¼Œæ²¡æœ‰å°±å¼¹å‡ºç™»é™†æ¡†ï¼Œå¯ä»¥è¿™ä¹ˆå®ç°ã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>voteButton.</span><span style="color:#c82728;">rac_command </span><span style="color:#3e999f;">= </span><span>[[RACCommand </span><span style="color:#4271ae;">alloc</span><span>] initWithEnabled</span><span style="color:#3e999f;">:</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">viewModel</span><span>.</span><span style="color:#c82728;">voteCommand</span><span>.</span><span style="color:#c82728;">enabled</span><span> signalBlock</span><span style="color:#3e999f;">:^</span><span>RACSignal </span><span style="color:#3e999f;">*</span><span>(</span><span style="color:#8959a8;">id </span><span>input) {
</span><span>	</span><span style="color:#8e908c;">// Assume that we&#39;re logged in at first. We&#39;ll replace this signal later if not.
</span><span>	RACSignal </span><span style="color:#3e999f;">*</span><span>authSignal </span><span style="color:#3e999f;">= </span><span>[RACSignal </span><span style="color:#4271ae;">empty</span><span>];
</span><span>
</span><span>	</span><span style="color:#8959a8;">if </span><span>([[PXRequest </span><span style="color:#4271ae;">apiHelper</span><span>] authMode] </span><span style="color:#3e999f;">==</span><span> PXAPIHelperModeNoAuth) {
</span><span>		</span><span style="color:#8e908c;">// Not logged in. Replace signal.
</span><span>		authSignal </span><span style="color:#3e999f;">= </span><span>[[RACSignal </span><span style="color:#4271ae;">createSignal:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">RACDisposable </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">(</span><span style="color:#8959a8;">id</span><span style="color:#4271ae;">&lt;RACSubscriber&gt; subscriber) {
</span><span style="color:#4271ae;">			@</span><span style="color:#c82728;">strongify</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">);
</span><span style="color:#4271ae;">
</span><span style="color:#4271ae;">			FRPLoginViewController </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">viewController </span><span style="color:#3e999f;">= </span><span style="color:#4271ae;">[[FRPLoginViewController alloc] initWithNibName</span><span style="color:#3e999f;">:</span><span style="color:#839c00;">@&quot;FRPLoginViewController&quot;</span><span style="color:#4271ae;"> bundle</span><span style="color:#3e999f;">:</span><span style="color:#f07219;">nil</span><span style="color:#4271ae;">];
</span><span style="color:#4271ae;">			UINavigationController </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">navigationController </span><span style="color:#3e999f;">= </span><span style="color:#4271ae;">[[UINavigationController alloc] initWithRootViewController</span><span style="color:#3e999f;">:</span><span style="color:#4271ae;">viewController];
</span><span style="color:#4271ae;">
</span><span style="color:#4271ae;">			[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">presentViewController:navigationController animated:</span><span style="color:#f07219;">YES </span><span style="color:#4271ae;">completion:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">{
</span><span style="color:#4271ae;">				[subscriber sendCompleted];
</span><span style="color:#4271ae;">			}];
</span><span style="color:#4271ae;">
</span><span style="color:#4271ae;">			</span><span style="color:#8959a8;">return </span><span style="color:#f07219;">nil</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">		}</span><span>]];
</span><span>	}
</span><span>
</span><span>	</span><span style="color:#8959a8;">return </span><span>[authSignal </span><span style="color:#4271ae;">then:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">RACSignal </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">{
</span><span style="color:#4271ae;">		@</span><span style="color:#c82728;">strongify</span><span style="color:#4271ae;">(</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">);
</span><span style="color:#4271ae;">		</span><span style="color:#8959a8;">return </span><span style="color:#4271ae;">[[</span><span style="color:#c82728;">self</span><span style="color:#4271ae;">.</span><span style="color:#c82728;">viewModel</span><span style="color:#4271ae;">.</span><span style="color:#c82728;">voteCommand</span><span style="color:#4271ae;"> execute</span><span style="color:#3e999f;">:</span><span style="color:#f07219;">nil</span><span style="color:#4271ae;">] ignoreValues];
</span><span style="color:#4271ae;">	}</span><span>];
</span><span>}];
</span><span>[voteButton.</span><span style="color:#c82728;">rac_command</span><span>.</span><span style="color:#c82728;">errors</span><span> subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#8959a8;">id </span><span>x) {
</span><span>	[x </span><span style="color:#4271ae;">subscribeNext:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">(</span><span style="color:#c99e00;">NSError </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">error) {
</span><span style="color:#4271ae;">		[SVProgressHUD showErrorWithStatus:[error localizedDescription]];
</span><span style="color:#4271ae;">	}</span><span>];
</span><span>}];
</span></code></pre>
<p>è¿™æ®µä»£ç èŠ‚é€‰è‡ª AshFurrow çš„<a href="https://github.com/AshFurrow/FunctionalReactivePixels">FunctionalReactivePixels</a>ï¼Œæœ‰åˆ å‡ã€‚</p>
<h3 id="data-structure-categories">Data Structure Categories</h3>
<p>å¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼Œå¦‚ NSArray, NSDictionary ä¹Ÿéƒ½æœ‰æ·»åŠ ç›¸åº”çš„ categoryï¼Œæ¯”å¦‚<code>NSArray</code>æ·»åŠ äº†<code>rac_sequence</code>ï¼Œå¯ä»¥å°†<code>NSArray</code>è½¬æ¢ä¸º<code>RACSequence</code>ï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹<code>RACSequence</code>, <code>RACSequence</code>æ˜¯ä¸€ç»„ immutable ä¸”æœ‰åºçš„ valuesï¼Œä¸è¿‡è¿™äº› values æ˜¯è¿è¡Œæ—¶è®¡ç®—çš„ï¼Œæ‰€ä»¥å¯¹æ€§èƒ½æå‡æœ‰ä¸€å®šçš„å¸®åŠ©ã€‚<code>RACSequence</code>æä¾›äº†ä¸€äº›æ–¹æ³•ï¼Œå¦‚<code>array</code>è½¬æ¢ä¸º<code>NSArray</code>ï¼Œ<code>any:</code>æ£€æŸ¥æ˜¯å¦æœ‰ Value ç¬¦åˆè¦æ±‚ï¼Œ<code>all:</code>æ£€æŸ¥æ˜¯ä¸æ˜¯æ‰€æœ‰çš„ value éƒ½ç¬¦åˆè¦æ±‚ï¼Œè¿™é‡Œçš„ç¬¦åˆè¦æ±‚çš„ï¼Œblock è¿”å› YESï¼Œä¸ç¬¦åˆè¦æ±‚çš„å°±è¿”å› NOã€‚</p>
<h3 id="notificationcenter-category">NotificationCenter Category</h3>
<p><code>NSNotificationCenter</code>, é»˜è®¤æƒ…å†µä¸‹<code>NSNotificationCenter</code>ä½¿ç”¨<code>Target-Action</code>æ–¹å¼æ¥å¤„ç† Notificationï¼Œè¿™æ ·å°±éœ€è¦å¦å¤–å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™å°±æ¶‰åŠåˆ°ç¼–ç¨‹é¢†åŸŸçš„ä¸¤å¤§éš¾é¢˜ä¹‹ä¸€ï¼šèµ·åå­—ã€‚æœ‰äº† RACï¼Œå°±æœ‰ Signalï¼Œæœ‰äº† Signal å°±å¯ä»¥ subscribeï¼Œäºæ˜¯<code>NotificationCenter</code>å°±å¯ä»¥è¿™ä¹ˆæ¥å¤„ç†ï¼Œè¿˜ä¸ç”¨æ‹…å¿ƒç§»é™¤ observer çš„é—®é¢˜ã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>[[[</span><span style="color:#c99e00;">NSNotificationCenter </span><span style="color:#4271ae;">defaultCenter</span><span>] rac_addObserverForName</span><span style="color:#3e999f;">:</span><span style="color:#839c00;">@&quot;MyNotification&quot;</span><span> object</span><span style="color:#3e999f;">:</span><span style="color:#f07219;">nil</span><span>] subscribeNext</span><span style="color:#3e999f;">:^</span><span>(</span><span style="color:#f07219;">NSNotification </span><span style="color:#3e999f;">*</span><span>notification) {
</span><span>	</span><span style="color:#4271ae;">NSLog</span><span>(</span><span style="color:#839c00;">@&quot;Notification Received&quot;</span><span>);
</span><span>}];
</span></code></pre>
<h3 id="nsobject-categories">NSObject Categories</h3>
<p>NSObject æœ‰ä¸å°‘çš„ Categoryï¼Œæˆ‘è§‰å¾—æ¯”è¾ƒæœ‰ç”¨çš„æœ‰è¿™ä¹ˆå‡ ä¸ª</p>
<h4 id="nsobject-racdeallocating-h">NSObject+RACDeallocating.h</h4>
<p>é¡¾åæ€ä¹‰å°±æ˜¯åœ¨ä¸€ä¸ª object çš„ dealloc è¢«è§¦å‘æ—¶ï¼Œæ‰§è¡Œçš„ä¸€æ®µä»£ç ã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#c99e00;">NSArray </span><span style="color:#3e999f;">*</span><span>array </span><span style="color:#3e999f;">=</span><span> @[</span><span style="color:#839c00;">@&quot;foo&quot;</span><span>];
</span><span>[[array </span><span style="color:#4271ae;">rac_willDeallocSignal</span><span>] subscribeCompleted</span><span style="color:#3e999f;">:^</span><span>{
</span><span>	</span><span style="color:#4271ae;">NSLog</span><span>(</span><span style="color:#839c00;">@&quot;oops, i will be gone&quot;</span><span>);
</span><span>}];
</span><span>array </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">nil</span><span>;
</span></code></pre>
<h4 id="nsobject-raclifting-h">NSObject+RACLifting.h</h4>
<p>æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›æ»¡è¶³ä¸€å®šæ¡ä»¶æ—¶ï¼Œè‡ªåŠ¨è§¦å‘æŸä¸ªæ–¹æ³•ï¼Œæœ‰äº†è¿™ä¸ª category å°±å¯ä»¥è¿™ä¹ˆåŠ</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#3e999f;">- </span><span>(</span><span style="color:#8959a8;">void</span><span>)test
</span><span>{
</span><span>    RACSignal </span><span style="color:#3e999f;">*</span><span>signalA </span><span style="color:#3e999f;">= </span><span>[RACSignal </span><span style="color:#4271ae;">createSignal:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">RACDisposable </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">(</span><span style="color:#8959a8;">id</span><span style="color:#4271ae;">&lt;RACSubscriber&gt; subscriber) {
</span><span style="color:#4271ae;">        </span><span style="color:#8959a8;">double</span><span style="color:#4271ae;"> delayInSeconds </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">2.0</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">        dispatch_time_t popTime </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">dispatch_time</span><span style="color:#4271ae;">(DISPATCH_TIME_NOW, (</span><span style="color:#c99e00;">int64_t</span><span style="color:#4271ae;">)(delayInSeconds </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;"> NSEC_PER_SEC));
</span><span style="color:#4271ae;">        </span><span style="color:#c82728;">dispatch_after</span><span style="color:#4271ae;">(popTime, </span><span style="color:#c82728;">dispatch_get_main_queue</span><span style="color:#4271ae;">(), </span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">(</span><span style="color:#8959a8;">void</span><span style="color:#4271ae;">){
</span><span style="color:#4271ae;">            [subscriber sendNext:</span><span style="color:#839c00;">@&quot;A&quot;</span><span style="color:#4271ae;">];
</span><span style="color:#4271ae;">        });
</span><span style="color:#4271ae;">        </span><span style="color:#8959a8;">return </span><span style="color:#f07219;">nil</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">    }</span><span>];
</span><span>
</span><span>    RACSignal </span><span style="color:#3e999f;">*</span><span>signalB </span><span style="color:#3e999f;">= </span><span>[RACSignal </span><span style="color:#4271ae;">createSignal:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">RACDisposable </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">(</span><span style="color:#8959a8;">id</span><span style="color:#4271ae;">&lt;RACSubscriber&gt; subscriber) {
</span><span style="color:#4271ae;">        [subscriber sendNext:</span><span style="color:#839c00;">@&quot;B&quot;</span><span style="color:#4271ae;">];
</span><span style="color:#4271ae;">        [subscriber sendNext:</span><span style="color:#839c00;">@&quot;Another B&quot;</span><span style="color:#4271ae;">];
</span><span style="color:#4271ae;">        [subscriber sendCompleted];
</span><span style="color:#4271ae;">        </span><span style="color:#8959a8;">return </span><span style="color:#f07219;">nil</span><span style="color:#4271ae;">;
</span><span style="color:#4271ae;">    }</span><span>];
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">rac_liftSelector:</span><span style="color:#8959a8;">@selector</span><span style="color:#4271ae;">(doA:withB:) withSignals:signalA, signalB, </span><span style="color:#f07219;">nil</span><span>];
</span><span>}
</span><span>
</span><span style="color:#3e999f;">- </span><span>(</span><span style="color:#8959a8;">void</span><span>)doA</span><span style="color:#3e999f;">:</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>)A withB</span><span style="color:#3e999f;">:</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>)B
</span><span>{
</span><span>    </span><span style="color:#4271ae;">NSLog</span><span>(</span><span style="color:#839c00;">@&quot;A:</span><span>%@</span><span style="color:#839c00;"> and B:</span><span>%@</span><span style="color:#839c00;">&quot;</span><span>, A, B);
</span><span>}
</span></code></pre>
<p>è¿™é‡Œçš„<code>rac_liftSelector:withSignals</code> å°±æ˜¯å¹²è¿™ä»¶äº‹çš„ï¼Œå®ƒçš„æ„æ€æ˜¯å½“ signalA å’Œ signalB éƒ½è‡³å°‘ sendNext è¿‡ä¸€æ¬¡ï¼Œæ¥ä¸‹æ¥åªè¦å…¶ä¸­ä»»æ„ä¸€ä¸ª signal æœ‰äº†æ–°çš„å†…å®¹ï¼Œ<code>doA:withB</code>è¿™ä¸ªæ–¹æ³•å°±ä¼šè‡ªåŠ¨è¢«è§¦å‘ã€‚</p>
<p>å¦‚æœä½ æœ‰å…´è¶£ï¼Œå¯ä»¥æƒ³æƒ³ä¸Šé¢è¿™æ®µä»£ç ä¼šè¾“å‡ºä»€ä¹ˆã€‚</p>
<h4 id="nsobject-racselectorsignal-h">NSObject+RACSelectorSignal.h</h4>
<p>è¿™ä¸ª category æœ‰<code>rac_signalForSelector:</code>å’Œ<code>rac_signalForSelector:fromProtocol:</code> è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚å…ˆæ¥çœ‹å‰ä¸€ä¸ªï¼Œå®ƒçš„æ„æ€æ˜¯å½“æŸä¸ª selector è¢«è°ƒç”¨æ—¶ï¼Œå†æ‰§è¡Œä¸€æ®µæŒ‡å®šçš„ä»£ç ï¼Œç›¸å½“äº hookã€‚æ¯”å¦‚ç‚¹å‡»æŸä¸ªæŒ‰é’®åï¼Œè®°ä¸ªæ—¥å¿—ã€‚åè€…è¡¨ç¤ºè¯¥ selector å®ç°äº†æŸä¸ªåè®®ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å®ƒæ¥å®ç° Delegateã€‚</p>
<h2 id="mvvm">MVVM</h2>
<p>RAC å¸¦æ¥çš„å˜åŒ–è¿˜ä¸ä»…ä»…æ˜¯è¿™äº›ï¼Œå®ƒè¿˜å¸¦æ¥äº†æ¶æ„å±‚é¢çš„å˜åŒ–ã€‚æˆ‘ä»¬éƒ½çŸ¥é“è‹¹æœæ¨èçš„æ˜¯ MVC æ¶æ„ï¼Œé‚£ MVVM åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p><img src="https://f.cloud.github.com/assets/432536/867984/291ed380-f760-11e2-9106-d3158320af39.png" alt="" /></p>
<p>è·Ÿ MVC æœ€å¤§çš„åŒºåˆ«æ˜¯å¤šäº†ä¸ª<code>ViewModel</code>ï¼Œå®ƒç›´æ¥ä¸ View ç»‘å®šï¼Œè€Œä¸”å¯¹ View ä¸€æ— æ‰€çŸ¥ã€‚æ‹¿åšèœæ‰“æ¯”æ–¹çš„è¯ï¼ŒViewModel å°±æ˜¯è°ƒæ–™ï¼Œå®ƒä¸å…³å¿ƒåšçš„åˆ°åº•æ˜¯ä»€ä¹ˆèœã€‚è¿™ä¸æ˜¯è·Ÿ<code>Model</code>å¾ˆåƒå—ï¼Ÿæ˜¯çš„ï¼Œå®ƒå¯ä»¥æ‰®æ¼” Model çš„èŒè´£ï¼Œä½†å…¶å®å®ƒæ˜¯ Model çš„ä¸­ä»‹ï¼Œè¿™æ ·å½“ Model çš„ API æœ‰å˜åŒ–ï¼Œæˆ–è€…ç”±æœ¬åœ°å­˜å‚¨å˜ä¸ºè¿œç¨‹ API è°ƒç”¨æ—¶ï¼ŒViewModel çš„ public API å¯ä»¥ä¿æŒä¸å˜ã€‚</p>
<p>ä½¿ç”¨ ViewModel çš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥è®© Controller æ›´åŠ ç®€å•å’Œè½»ä¾¿ï¼Œè€Œä¸” ViewModel ç›¸å¯¹ç‹¬ç«‹ï¼Œä¹Ÿæ›´åŠ æ–¹ä¾¿æµ‹è¯•å’Œé‡ç”¨ã€‚é‚£ Controller è¿™æ—¶åˆè¯¥åšå“ªäº›äº‹å‘¢ï¼Ÿåœ¨ MVVM ä½“ç³»ä¸­ï¼ŒController å¯ä»¥è¢«çœ‹æˆ Viewï¼Œæ‰€ä»¥å®ƒçš„ä¸»è¦å·¥ä½œæ˜¯å¤„ç†å¸ƒå±€ã€åŠ¨ç”»ã€æ¥æ”¶ç³»ç»Ÿäº‹ä»¶ã€å±•ç¤º UIã€‚</p>
<p>MVVM è¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µæ˜¯ <code>data binding</code>ï¼Œview çš„å‘ˆç°éœ€è¦ dataï¼Œè¿™ä¸ª data å°±æ˜¯ç”± ViewModel æä¾›çš„ï¼Œå°† view çš„ data ä¸ ViewModel çš„ data ç»‘å®šåï¼Œå°†æ¥åŒæ–¹çš„æ•°æ®åªè¦ä¸€æ–¹æœ‰å˜åŒ–ï¼Œå¦ä¸€æ–¹å°±èƒ½æ”¶åˆ°ã€‚<a href="https://github.com/ReactiveCocoa/ReactiveViewModel">è¿™é‡Œ</a>æœ‰ Github å¼€æºçš„ä¸€ä¸ª ViewModel Base Classã€‚</p>
<h2 id="qi-ta">å…¶ä»–</h2>
<p>RAC åœ¨ä½¿ç”¨æ—¶æœ‰ä¸€äº›æ³¨æ„äº‹é¡¹ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹çš„<a href="https://github.com/ReactiveCocoa/ReactiveCocoa/blob/master/Documentation/DesignGuidelines.md">DesignGuildLines</a>ï¼Œè¿™é‡Œç®€å•è¯´ä¸€ä¸‹ã€‚</p>
<p>å½“ä¸€ä¸ª signal è¢«ä¸€ä¸ª subscriber subscribe åï¼Œè¿™ä¸ª subscriber ä½•æ—¶ä¼šè¢«ç§»é™¤ï¼Ÿç­”æ¡ˆæ˜¯å½“ subscriber è¢« sendComplete æˆ– sendError æ—¶ï¼Œæˆ–è€…æ‰‹åŠ¨è°ƒç”¨[disposable dispose]ã€‚</p>
<p>å½“ subscriber è¢« dispose åï¼Œæ‰€æœ‰è¯¥ subscriber ç›¸å…³çš„å·¥ä½œéƒ½ä¼šè¢«åœæ­¢æˆ–å–æ¶ˆï¼Œå¦‚ http è¯·æ±‚ï¼Œèµ„æºä¹Ÿä¼šè¢«é‡Šæ”¾ã€‚</p>
<p>Signal events æ˜¯çº¿æ€§çš„ï¼Œä¸ä¼šå‡ºç°å¹¶å‘çš„æƒ…å†µï¼Œé™¤éæ˜¾ç¤ºåœ°æŒ‡å®š Schedulerã€‚æ‰€ä»¥<code>-subscribeNext:error:completed:</code>é‡Œçš„ block ä¸éœ€è¦é”å®šæˆ–è€… synchronized ç­‰æ“ä½œï¼Œå…¶ä»–çš„ events ä¼šä¾æ¬¡æ’é˜Ÿï¼Œç›´åˆ° block å¤„ç†å®Œæˆã€‚</p>
<p>Errors æœ‰ä¼˜å…ˆæƒï¼Œå¦‚æœæœ‰å¤šä¸ª signals è¢«åŒæ—¶ç›‘å¬ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ª signal sendErrorï¼Œé‚£ä¹ˆ error å°±ä¼šç«‹åˆ»è¢«ä¼ é€ç»™ subscriberï¼Œå¹¶å¯¼è‡´ signals ç»ˆæ­¢æ‰§è¡Œã€‚ç›¸å½“äº Exceptionã€‚</p>
<p>ç”Ÿæˆ Signal æ—¶ï¼Œæœ€å¥½æŒ‡å®š Name, <code>-setNameWithFormat:</code> æ–¹ä¾¿è°ƒè¯•ã€‚</p>
<p>block ä»£ç ä¸­ä¸è¦é˜»å¡ã€‚</p>
<h2 id="xiao-jie">å°ç»“</h2>
<p>å°½ç®¡æ´‹æ´‹æ´’æ´’å†™äº†è¿™ä¹ˆå¤šï¼Œä¹Ÿåªæ˜¯å¯¹ RAC æœ‰äº†ä¸ªå¤§æ¦‚çš„äº†è§£ï¼Œå¦‚æœè¦æ›´æ·±å…¥åœ°äº†è§£ RAC è¿˜æ˜¯éœ€è¦å¤šè¯»æ–‡æ¡£ã€ä»£ç å’Œç›¸å…³é¡¹ç›®ã€‚</p>
<p>RAC å­¦ä¹ èµ·æ¥ç¨æ˜¾åƒåŠ›ï¼Œä¸”ç›¸å…³çš„æ–‡ç« ç›®å‰è¿˜ä¸å¤šï¼Œä¸­æ–‡çš„å°±æ›´å°‘äº†ï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸¦ç»™ä½ äº›å¸®åŠ©ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æˆ‘è§‰å¾—è¿˜ä¸é”™çš„ RAC ç›¸å…³èµ„æº</p>
<ul>
<li><a href="https://github.com/AshFurrow/FunctionalReactivePixels">FunctionalReactivePixels</a> ä½œè€…åŒæ—¶è¿˜å‡ºäº†ä¸€æœ¬ FRP ç›¸å…³çš„ä¹¦ï¼Œä¸ªäººè§‰å¾—çœ‹æºç å°±è¶³å¤Ÿäº†ã€‚</li>
<li><a href="https://github.com/jspahrsummers/GroceryList">GroceryList</a> RAC çš„ä½œè€…ä¹‹ä¸€ jspahrsummers çš„ä¸€ä¸ªé¡¹ç›®</li>
<li><a href="http://codeblog.shape.dk/blog/2013/12/05/reactivecocoa-essentials-understanding-and-using-raccommand/">ReactiveCocoa Essentilas: Understanding and Using RACCommand</a> ä»‹ç»äº† RACCommand çš„ä½¿ç”¨ï¼ŒåŒæ—¶ä¹Ÿæ¶‰åŠäº† RAC ç›¸å…³çš„ä¸€äº›ç‚¹ã€‚</li>
<li><a href="http://codeblog.shape.dk/blog/2013/12/02/transparent-oauth-token-refresh-using-reactivecocoa/">Transparent OAuth Token Refresh Using ReactiveCocoa</a> è¿™ç¯‡æ–‡ç« è®²äº†å¦‚ä½•ä½¿ç”¨ RAC æ¥é€æ˜åœ°è·å– Access Tokenï¼Œç„¶åç»§ç»­å‘é€è¯·æ±‚ã€‚</li>
<li><a href="http://vimeo.com/78749139">BNR: An Introduction to ReactiveCocoa</a>(è§†é¢‘)</li>
</ul>

  </div>


  <ul class="tags flex flex-wrap justify-center items-center gap-4 mt-5 mb-8 text-lg">
    
    
    <li
      class="px-4 pb-[2px] leading-8 rounded-full border text-gray-700 border-gray-700 hover:text-gray-100 hover:border-gray-900 hover:bg-gray-900 transition-all">
      <a class="inline-block" href="https://limboy.me/tags/programming/">programming</a>
    </li>
    
    <li
      class="px-4 pb-[2px] leading-8 rounded-full border text-gray-700 border-gray-700 hover:text-gray-100 hover:border-gray-900 hover:bg-gray-900 transition-all">
      <a class="inline-block" href="https://limboy.me/tags/rac/">RAC</a>
    </li>
    
    <li
      class="px-4 pb-[2px] leading-8 rounded-full border text-gray-700 border-gray-700 hover:text-gray-100 hover:border-gray-900 hover:bg-gray-900 transition-all">
      <a class="inline-block" href="https://limboy.me/tags/ios/">iOS</a>
    </li>
    
    
  </ul>

  
  <script src="https://giscus.app/client.js" data-repo="limboy/telescope"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzODEwOTA2MTg=" data-category="General"
    data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMzMDY2MTQy" data-mapping="title" data-reactions-enabled="1"
    data-emit-metadata="0" data-theme="light" data-lang="en" crossorigin="anonymous" async>
    </script>
  

  

</div>

      </div>
    </div>
    
    <footer
      class="flex border-t border-gray-300 text-gray-600 bg-gray-50 items-center justify-center h-12 text-sm mt-2">
      <div class="flex inner justify-center gap-4">
        <a class="hover:underline" href="https://github.com/limboy" target="_blank">GitHub</a>
        <a class="hover:underline" href="https://twitter.com/_limboy" target="_blank">Twitter</a>
        <a class="hover:underline" href="https://limboy.me/index.xml">RSS</a>
      </div>
    </footer>
    
  </div>

  
  

  <script>
    // éƒ½æ˜¯ä¸ºäº† iOS...
    document.querySelector("#wrapper").style.minHeight = `calc(${window.innerHeight}px - 6.5rem)`
    window.addEventListener('resize', () => {
      document.querySelector("#wrapper").style.minHeight = `calc(${window.innerHeight}px - 6.5rem)`
    })
  </script>
</body>

</html>