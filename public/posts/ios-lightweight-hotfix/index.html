<!DOCTYPE html>
<html>

<head>
  <meta content="width=device-width,initial-scale=1" name="viewport" />
  <meta charset="UTF-8">
  <link rel="icon" href="https://fav.farm/ğŸ‘»" />
  <title>
è½»é‡çº§ä½é£é™© iOS Hotfix æ–¹æ¡ˆ
</title>
  <link rel="stylesheet" href="/assets/main.css?9zs&#x2F;BXhW+t7PNacyPraNbWdNoN&#x2F;V7G9VhdTj5z3mo8A=" />
  <script async defer data-domain="limboy.me" src="https://analytics.limboy.me/js/plausible.js"></script>
  
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@_limboy">
<meta name="twitter:site" content="@_limboy">
<meta property="og:url" content="https://limboy.me/posts/ios-lightweight-hotfix/">

<meta name="twitter:title" content="è½»é‡çº§ä½é£é™© iOS Hotfix æ–¹æ¡ˆ">
<meta property="og:title" content="è½»é‡çº§ä½é£é™© iOS Hotfix æ–¹æ¡ˆ">

<meta property="og:description" content="">
<meta name="twitter:description" content="">



</head>

<body class="  ">
  <nav class="flex justify-center items-center bg-zinc-700 h-12 py-0 ">
    <div class="inner flex justify-between flex-row mx-1">
      <ul class="color-white flex flex-row justify-start gap-4">
        <li><a class="nav-link opacity-90 text-2xl" href="/">Limboy</a></li>
        <!--<li><a class="nav-link" href="/coodle">Coodle</a></li>-->
      </ul>
      <ul class="color-white flex flex-row gap-4 items-center text-base">
        <!--<li> <a class="nav-link" href="/books" class="decoration-0"> Books </a> </li>-->
        <li> <a class="nav-link" href="/highlights" class="decoration-0"> Highlights </a> </li>
        <li> <a class="nav-link" href="/projects" class="decoration-0"> Projects </a> </li>
        <li> <a class="nav-link" href="/about" class="decoration-0"> About </a> </li>
      </ul>
    </div>
  </nav>

  <div class="flex flex-col">
    <div id="wrapper" class="flex justify-center" style="min-height: calc(100vh - 6.5rem);">
      <div class="inner mb-2">
        
<div class="mt-4 lg:mt-6">
  

  <h1 class="title font-medium text-3xl"><a href="https:&#x2F;&#x2F;limboy.me&#x2F;posts&#x2F;ios-lightweight-hotfix&#x2F;">è½»é‡çº§ä½é£é™© iOS Hotfix æ–¹æ¡ˆ</a></h1>
  <div class="flex gap-4 items-center my-1">
    <time class="text-gray-500">2018-03-04</time>

  </div>
  <hr class="border-t-[3px]" />

  <div class="prose lg:prose-xl max-w-full my-6">
    <p>æˆ‘ä»¬éƒ½çŸ¥é“è‹¹æœå¯¹ Hotfix æŠ“å¾—æ¯”è¾ƒä¸¥ï¼Œå¼ºå¤§å¥½ç”¨çš„ JSPatch ä¹Ÿæˆä¸ºäº†è¿‡å»å¼ã€‚ä½†å³ä½¿æµ‹è¯•åœ°å†ç»†è‡´ï¼Œä¹Ÿéš¾ä¿çº¿ä¸Š App ä¸å‡ºé—®é¢˜ï¼Œå°é—®é¢˜è¿˜èƒ½å¿å¿ï¼Œå¤§é—®é¢˜å°±å¾—é‡æ–°èµ°å‘å¸ƒæµç¨‹ï¼Œç„¶åç­‰å¾…å®¡æ ¸é€šè¿‡ï¼Œç­‰å¾…ç”¨æˆ·å‡çº§ï¼Œå‘¨æœŸé•¿ä¸”éº»çƒ¦ã€‚å¦‚æœæœ‰ä¸€ç§æ–¹å¼ç›¸å¯¹æ¯”è¾ƒå®‰å…¨ï¼Œä¸éœ€è¦ JSPatch é‚£ä¹ˆå®Œå–„ï¼Œä½†ä¹Ÿè¶³å¤Ÿåº”ä»˜ä¸€èˆ¬åœºæ™¯ï¼Œä½¿ç”¨èµ·æ¥è¿˜æ¯”è¾ƒè½»é‡å°±å¥½äº†ï¼Œè¿™ä¹Ÿæ˜¯æœ¬æ–‡è¦æ¢è®¨çš„ä¸»é¢˜ã€‚</p>
<p>è¦è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼ŒNative å±‚åªè¦é€å‡ºä¸¤ç§èƒ½åŠ›å°±åŸºæœ¬å¯ä»¥äº†ï¼š</p>
<ol>
<li>åœ¨ä»»æ„æ–¹æ³•å‰åæ³¨å…¥ä»£ç çš„èƒ½åŠ›ï¼Œå¯èƒ½çš„è¯æœ€å¥½è¿˜èƒ½æ›¿æ¢æ‰ã€‚</li>
<li>è°ƒç”¨ä»»æ„ç±»/å®ä¾‹æ–¹æ³•çš„èƒ½åŠ›ã€‚</li>
</ol>
<p>ç¬¬ 2 ç‚¹ä¸éš¾ï¼Œåªè¦æŠŠ <code>[NSObject performSelector:...]</code> é‚£ä¸€å¥—é€šè¿‡ <code>JSContext</code> æš´éœ²å‡ºæ¥å³å¯ã€‚éš¾çš„æ˜¯ç¬¬ 1 ç‚¹ã€‚å…¶å®ç»†æƒ³ä¸€ä¸‹ï¼Œè¿™ä¸å°±æ˜¯ AOP ä¹ˆï¼Œè€Œ iOS æœ‰ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„ AOP Library: <a href="https://github.com/steipete/Aspects">Aspects</a>ï¼Œåªè¦æŠŠå®ƒçš„å‡ ä¸ªæ–¹æ³•é€šè¿‡ JSContext æš´éœ²ç»™ JS ä¸å°±å¯ä»¥äº†ä¹ˆï¼Ÿ</p>
<p>é€‰æ‹© Aspects çš„åŸå› æ˜¯å®ƒå·²ç»ç»è¿‡äº†éªŒè¯ï¼Œä¸å…‰æ˜¯åŠŸèƒ½ä¸Šçš„ï¼Œæ›´é‡è¦çš„æ˜¯å¯ä»¥é€šè¿‡ AppStore çš„å®¡æ ¸ã€‚</p>
<blockquote>
<p>This is stable and used in hundreds of apps since it's part of PSPDFKit, an iOS PDF framework that ships with apps like Dropbox or Evernote.</p>
</blockquote>
<p>Aspects ä½¿ç”¨å§¿åŠ¿ï¼š</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>[UIViewController </span><span style="color:#4271ae;">aspect_hookSelector:</span><span style="color:#8959a8;">@selector</span><span style="color:#4271ae;">(viewWillAppear:) withOptions:AspectPositionAfter usingBlock:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">(</span><span style="color:#8959a8;">id</span><span style="color:#4271ae;">&lt;AspectInfo&gt; aspectInfo, </span><span style="color:#8959a8;">BOOL</span><span style="color:#4271ae;"> animated) {
</span><span style="color:#4271ae;">    NSLog(</span><span style="color:#839c00;">@&quot;View Controller </span><span>%@</span><span style="color:#839c00;"> will appear animated: </span><span>%tu</span><span style="color:#839c00;">&quot;</span><span style="color:#4271ae;">, aspectInfo.</span><span style="color:#c82728;">instance</span><span style="color:#4271ae;">, animated);
</span><span style="color:#4271ae;">} error:</span><span style="color:#f07219;">NULL</span><span>];
</span></code></pre>
<p>å‰æ’ã€åæ’ã€æ›¿æ¢æŸä¸ªæ–¹æ³•éƒ½å¯ä»¥ã€‚ä½¿ç”¨ç±»çš„æ–¹å¼å¾ˆç®€å•ï¼Œ<code>NSClassFromString</code> å³å¯ï¼ŒSelector ä¹Ÿä¸€æ · <code>NSSelectorFromString</code>ï¼Œè¿™æ ·å°±èƒ½é€šè¿‡å¤–éƒ¨ä¼ å…¥ Stringï¼Œå†…éƒ¨åŠ¨æ€æ„é€  Class å’Œ Selector æ¥è¾¾åˆ° Fix çš„æ•ˆæœäº†ã€‚</p>
<p>è¿™ç§æ–¹å¼çš„å®‰å…¨æ€§åœ¨äºï¼š</p>
<ol>
<li>ä¸éœ€è¦ä¸­é—´ JS æ–‡ä»¶ï¼Œå‡†å¤‡å·¥ä½œå…¨éƒ¨åœ¨ Native ç«¯å®Œæˆã€‚</li>
<li>æ²¡æœ‰ä½¿ç”¨ App Store ä¸å‹å¥½çš„ç±»/æ–¹æ³•ã€‚</li>
</ol>
<h3 id="demo">Demo</h3>
<p>å‡è®¾çº¿ä¸Šè¿è¡Œè¿™è¿™æ ·ä¸€ä¸ª Classï¼Œç”±äºç–å¿½ï¼Œæ²¡æœ‰å¯¹å‚æ•°åšæ£€æŸ¥ï¼Œå¯¼è‡´ç‰¹å®šæƒ…å†µä¸‹ä¼š Crashã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@interface </span><span>MightyCrash: </span><span style="color:#839c00;">NSObject
</span><span>- (</span><span style="color:#8959a8;">float</span><span>)</span><span style="color:#4271ae;">divideUsingDenominator:</span><span>(</span><span style="color:#c99e00;">NSInteger</span><span>)</span><span style="color:#f07219;">denominator</span><span>;
</span><span style="color:#8959a8;">@end
</span><span>
</span><span style="color:#8959a8;">@implementation </span><span>MightyCrash
</span><span style="color:#8e908c;">// ä¼ ä¸€ä¸ª 0 å°± gg äº†
</span><span>- (</span><span style="color:#8959a8;">float</span><span>)</span><span style="color:#4271ae;">divideUsingDenominator:</span><span>(</span><span style="color:#c99e00;">NSInteger</span><span>)</span><span style="color:#f07219;">denominator
</span><span>{
</span><span>    </span><span style="color:#8959a8;">return </span><span style="color:#f07219;">1.</span><span style="color:#8959a8;">f</span><span style="color:#3e999f;">/</span><span>denominator;
</span><span>}
</span><span style="color:#8959a8;">@end
</span></code></pre>
<p>ç°åœ¨æˆ‘ä»¬è¦é¿å… Crashï¼Œå°±å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ¥ä¿®å¤</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>[Felix </span><span style="color:#4271ae;">fixIt</span><span>];
</span><span>
</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>fixScriptString </span><span style="color:#3e999f;">= </span><span style="color:#839c00;">@&quot; \
</span><span style="color:#839c00;">fixInstanceMethodReplace(&#39;MightyCrash&#39;, &#39;divideUsingDenominator:&#39;, function(instance, originInvocation, originArguments){ \
</span><span style="color:#839c00;">    if (originArguments[0] == 0) { \
</span><span style="color:#839c00;">        console.log(&#39;zero goes here&#39;); \
</span><span style="color:#839c00;">    } else { \
</span><span style="color:#839c00;">        runInvocation(originInvocation); \
</span><span style="color:#839c00;">    } \
</span><span style="color:#839c00;">}); \
</span><span style="color:#839c00;">\
</span><span style="color:#839c00;">&quot;</span><span>;
</span><span>
</span><span>[Felix </span><span style="color:#4271ae;">evalString:fixScriptString</span><span>];
</span></code></pre>
<p>è¿è¡Œä¸€ä¸‹çœ‹çœ‹</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span>MightyCrash </span><span style="color:#3e999f;">*</span><span>mc </span><span style="color:#3e999f;">= </span><span>[[MightyCrash </span><span style="color:#4271ae;">alloc</span><span>] init];
</span><span style="color:#8959a8;">float</span><span> result </span><span style="color:#3e999f;">= </span><span>[mc </span><span style="color:#4271ae;">divideUsingDenominator:</span><span style="color:#f07219;">3</span><span>];
</span><span style="color:#4271ae;">NSLog</span><span>(</span><span style="color:#839c00;">@&quot;result: </span><span>%.3f</span><span style="color:#839c00;">&quot;</span><span>, result);
</span><span>result </span><span style="color:#3e999f;">= </span><span>[mc </span><span style="color:#4271ae;">divideUsingDenominator:</span><span style="color:#f07219;">0</span><span>];
</span><span style="color:#4271ae;">NSLog</span><span>(</span><span style="color:#839c00;">@&quot;won&#39;t crash&quot;</span><span>);
</span><span>
</span><span style="color:#8e908c;">// output
</span><span style="color:#8e908c;">// result: 0.333
</span><span style="color:#8e908c;">// Javascript log: zero goes here
</span><span style="color:#8e908c;">// won&#39;t crash
</span></code></pre>
<p>It Works, æ˜¯ä¸æ˜¯æœ‰é‚£ä¹ˆç‚¹æ„æ€äº†ã€‚ä»¥ä¸‹æ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ä»£ç ï¼Œä»…ä¾›å‚è€ƒã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">#import </span><span style="color:#839c00;">&lt;Aspects.h&gt;
</span><span style="color:#8959a8;">#import </span><span style="color:#839c00;">&lt;objc/runtime.h&gt;
</span><span style="color:#8959a8;">#import </span><span style="color:#839c00;">&lt;JavaScriptCore/JavaScriptCore.h&gt;
</span><span>
</span><span style="color:#8959a8;">@interface </span><span>Felix: </span><span style="color:#839c00;">NSObject
</span><span>+ (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">fixIt</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">evalString:</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">javascriptString</span><span>;
</span><span style="color:#8959a8;">@end
</span><span>
</span><span>
</span><span style="color:#8959a8;">@implementation </span><span>Felix
</span><span>+ (Felix </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#4271ae;">sharedInstance
</span><span>{
</span><span>    </span><span style="color:#8959a8;">static</span><span> Felix </span><span style="color:#3e999f;">*</span><span>sharedInstance </span><span style="color:#3e999f;">= </span><span style="color:#f07219;">nil</span><span>;
</span><span>    </span><span style="color:#8959a8;">static</span><span> dispatch_once_t onceToken;
</span><span>    </span><span style="color:#c82728;">dispatch_once</span><span style="color:#4271ae;">(</span><span style="color:#3e999f;">&amp;</span><span style="color:#4271ae;">onceToken, </span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">{
</span><span style="color:#4271ae;">        sharedInstance </span><span style="color:#3e999f;">= </span><span style="color:#4271ae;">[[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">alloc] init];
</span><span style="color:#4271ae;">    })</span><span>;
</span><span>
</span><span>    </span><span style="color:#8959a8;">return</span><span> sharedInstance;
</span><span>}
</span><span>
</span><span>+ (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">evalString:</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">javascriptString
</span><span>{
</span><span>    [[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>] evaluateScript</span><span style="color:#3e999f;">:</span><span>javascriptString];
</span><span>}
</span><span>
</span><span>+ (JSContext </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#4271ae;">context
</span><span>{
</span><span>    </span><span style="color:#8959a8;">static</span><span> JSContext </span><span style="color:#3e999f;">*</span><span>_context;
</span><span>    </span><span style="color:#8959a8;">static</span><span> dispatch_once_t onceToken;
</span><span>    </span><span style="color:#c82728;">dispatch_once</span><span style="color:#4271ae;">(</span><span style="color:#3e999f;">&amp;</span><span style="color:#4271ae;">onceToken, </span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">{
</span><span style="color:#4271ae;">        _context </span><span style="color:#3e999f;">= </span><span style="color:#4271ae;">[[JSContext alloc] init];
</span><span style="color:#4271ae;">        [_context setExceptionHandler:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">(JSContext </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">context, JSValue </span><span style="color:#3e999f;">*</span><span style="color:#4271ae;">value) {
</span><span style="color:#4271ae;">            NSLog(</span><span style="color:#839c00;">@&quot;Oops: </span><span>%@</span><span style="color:#839c00;">&quot;</span><span style="color:#4271ae;">, value);
</span><span style="color:#4271ae;">        }];
</span><span style="color:#4271ae;">    })</span><span>;
</span><span>    </span><span style="color:#8959a8;">return</span><span> _context;
</span><span>}
</span><span>
</span><span>+ (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">_fixWithMethod:</span><span>(</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#f07219;">isClassMethod </span><span style="color:#4271ae;">aspectionOptions:</span><span>(AspectOptions)</span><span style="color:#f07219;">option </span><span style="color:#4271ae;">instanceName:</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">instanceName </span><span style="color:#4271ae;">selectorName:</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">selectorName </span><span style="color:#4271ae;">fixImpl:</span><span>(JSValue </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">fixImpl </span><span>{
</span><span>    </span><span style="color:#8959a8;">Class</span><span> klass </span><span style="color:#3e999f;">= </span><span style="color:#4271ae;">NSClassFromString</span><span>(instanceName);
</span><span>    </span><span style="color:#8959a8;">if </span><span>(isClassMethod) {
</span><span>        klass </span><span style="color:#3e999f;">= </span><span style="color:#c82728;">object_getClass</span><span style="color:#4271ae;">(klass)</span><span>;
</span><span>    }
</span><span>    </span><span style="color:#8959a8;">SEL</span><span> sel </span><span style="color:#3e999f;">= </span><span style="color:#4271ae;">NSSelectorFromString</span><span>(selectorName);
</span><span>    [klass </span><span style="color:#4271ae;">aspect_hookSelector:sel withOptions:option usingBlock:</span><span style="color:#3e999f;">^</span><span style="color:#4271ae;">(</span><span style="color:#8959a8;">id</span><span style="color:#4271ae;">&lt;AspectInfo&gt; aspectInfo){
</span><span style="color:#4271ae;">        [fixImpl callWithArguments:@[aspectInfo.</span><span style="color:#c82728;">instance</span><span style="color:#4271ae;">, aspectInfo.</span><span style="color:#c82728;">originalInvocation</span><span style="color:#4271ae;">, aspectInfo.</span><span style="color:#c82728;">arguments</span><span style="color:#4271ae;">]];
</span><span style="color:#4271ae;">    } error:</span><span style="color:#f07219;">nil</span><span>];
</span><span>}
</span><span>
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">_runClassWithClassName:</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">className </span><span style="color:#4271ae;">selector:</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">selector </span><span style="color:#4271ae;">obj1:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">obj1 </span><span style="color:#4271ae;">obj2:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">obj2 </span><span>{
</span><span>    </span><span style="color:#8959a8;">Class</span><span> klass </span><span style="color:#3e999f;">= </span><span style="color:#4271ae;">NSClassFromString</span><span>(className);
</span><span style="color:#8959a8;">#pragma</span><span> clang diagnostic push
</span><span style="color:#8959a8;">#pragma</span><span> clang diagnostic ignored &quot;-Warc-performSelector-leaks&quot;
</span><span>    </span><span style="color:#8959a8;">return </span><span>[klass </span><span style="color:#4271ae;">performSelector:NSSelectorFromString(selector) withObject:obj1 withObject:obj2</span><span>];
</span><span style="color:#8959a8;">#pragma</span><span> clang diagnostic pop
</span><span>}
</span><span>
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">_runInstanceWithInstance:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">instance </span><span style="color:#4271ae;">selector:</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">selector </span><span style="color:#4271ae;">obj1:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">obj1 </span><span style="color:#4271ae;">obj2:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">obj2 </span><span>{
</span><span style="color:#8959a8;">#pragma</span><span> clang diagnostic push
</span><span style="color:#8959a8;">#pragma</span><span> clang diagnostic ignored &quot;-Warc-performSelector-leaks&quot;
</span><span>    </span><span style="color:#8959a8;">return </span><span>[instance </span><span style="color:#4271ae;">performSelector:NSSelectorFromString(selector) withObject:obj1 withObject:obj2</span><span>];
</span><span style="color:#8959a8;">#pragma</span><span> clang diagnostic pop
</span><span>}
</span><span>
</span><span>+ (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">fixIt
</span><span>{
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;fixInstanceMethodBefore&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>instanceName, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, JSValue </span><span style="color:#3e999f;">*</span><span>fixImpl) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_fixWithMethod:</span><span style="color:#f07219;">NO </span><span style="color:#4271ae;">aspectionOptions:AspectPositionBefore instanceName:instanceName selectorName:selectorName fixImpl:fixImpl</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;fixInstanceMethodReplace&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>instanceName, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, JSValue </span><span style="color:#3e999f;">*</span><span>fixImpl) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_fixWithMethod:</span><span style="color:#f07219;">NO </span><span style="color:#4271ae;">aspectionOptions:AspectPositionInstead instanceName:instanceName selectorName:selectorName fixImpl:fixImpl</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;fixInstanceMethodAfter&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>instanceName, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, JSValue </span><span style="color:#3e999f;">*</span><span>fixImpl) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_fixWithMethod:</span><span style="color:#f07219;">NO </span><span style="color:#4271ae;">aspectionOptions:AspectPositionAfter instanceName:instanceName selectorName:selectorName fixImpl:fixImpl</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;fixClassMethodBefore&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>instanceName, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, JSValue </span><span style="color:#3e999f;">*</span><span>fixImpl) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_fixWithMethod:</span><span style="color:#f07219;">YES </span><span style="color:#4271ae;">aspectionOptions:AspectPositionBefore instanceName:instanceName selectorName:selectorName fixImpl:fixImpl</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;fixClassMethodReplace&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>instanceName, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, JSValue </span><span style="color:#3e999f;">*</span><span>fixImpl) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_fixWithMethod:</span><span style="color:#f07219;">YES </span><span style="color:#4271ae;">aspectionOptions:AspectPositionInstead instanceName:instanceName selectorName:selectorName fixImpl:fixImpl</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;fixClassMethodAfter&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>instanceName, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, JSValue </span><span style="color:#3e999f;">*</span><span>fixImpl) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_fixWithMethod:</span><span style="color:#f07219;">YES </span><span style="color:#4271ae;">aspectionOptions:AspectPositionAfter instanceName:instanceName selectorName:selectorName fixImpl:fixImpl</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runClassWithNoParamter&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span style="color:#8959a8;">id</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>className, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName) {
</span><span>        </span><span style="color:#8959a8;">return </span><span>[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runClassWithClassName:className selector:selectorName obj1:</span><span style="color:#f07219;">nil </span><span style="color:#4271ae;">obj2:</span><span style="color:#f07219;">nil</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runClassWith1Paramter&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span style="color:#8959a8;">id</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>className, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, </span><span style="color:#8959a8;">id </span><span>obj1) {
</span><span>        </span><span style="color:#8959a8;">return </span><span>[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runClassWithClassName:className selector:selectorName obj1:obj1 obj2:</span><span style="color:#f07219;">nil</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runClassWith2Paramters&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span style="color:#8959a8;">id</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>className, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, </span><span style="color:#8959a8;">id </span><span>obj1, </span><span style="color:#8959a8;">id </span><span>obj2) {
</span><span>        </span><span style="color:#8959a8;">return </span><span>[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runClassWithClassName:className selector:selectorName obj1:obj1 obj2:obj2</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runVoidClassWithNoParamter&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>className, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runClassWithClassName:className selector:selectorName obj1:</span><span style="color:#f07219;">nil </span><span style="color:#4271ae;">obj2:</span><span style="color:#f07219;">nil</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runVoidClassWith1Paramter&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>className, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, </span><span style="color:#8959a8;">id </span><span>obj1) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runClassWithClassName:className selector:selectorName obj1:obj1 obj2:</span><span style="color:#f07219;">nil</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runVoidClassWith2Paramters&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>className, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, </span><span style="color:#8959a8;">id </span><span>obj1, </span><span style="color:#8959a8;">id </span><span>obj2) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runClassWithClassName:className selector:selectorName obj1:obj1 obj2:obj2</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runInstanceWithNoParamter&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span style="color:#8959a8;">id</span><span>(</span><span style="color:#8959a8;">id </span><span>instance, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName) {
</span><span>        </span><span style="color:#8959a8;">return </span><span>[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runInstanceWithInstance:instance selector:selectorName obj1:</span><span style="color:#f07219;">nil </span><span style="color:#4271ae;">obj2:</span><span style="color:#f07219;">nil</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runInstanceWith1Paramter&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span style="color:#8959a8;">id</span><span>(</span><span style="color:#8959a8;">id </span><span>instance, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, </span><span style="color:#8959a8;">id </span><span>obj1) {
</span><span>        </span><span style="color:#8959a8;">return </span><span>[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runInstanceWithInstance:instance selector:selectorName obj1:obj1 obj2:</span><span style="color:#f07219;">nil</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runInstanceWith2Paramters&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span style="color:#8959a8;">id</span><span>(</span><span style="color:#8959a8;">id </span><span>instance, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, </span><span style="color:#8959a8;">id </span><span>obj1, </span><span style="color:#8959a8;">id </span><span>obj2) {
</span><span>        </span><span style="color:#8959a8;">return </span><span>[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runInstanceWithInstance:instance selector:selectorName obj1:obj1 obj2:obj2</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runVoidInstanceWithNoParamter&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#8959a8;">id </span><span>instance, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runInstanceWithInstance:instance selector:selectorName obj1:</span><span style="color:#f07219;">nil </span><span style="color:#4271ae;">obj2:</span><span style="color:#f07219;">nil</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runVoidInstanceWith1Paramter&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#8959a8;">id </span><span>instance, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, </span><span style="color:#8959a8;">id </span><span>obj1) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runInstanceWithInstance:instance selector:selectorName obj1:obj1 obj2:</span><span style="color:#f07219;">nil</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runVoidInstanceWith2Paramters&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#8959a8;">id </span><span>instance, </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>selectorName, </span><span style="color:#8959a8;">id </span><span>obj1, </span><span style="color:#8959a8;">id </span><span>obj2) {
</span><span>        [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">_runInstanceWithInstance:instance selector:selectorName obj1:obj1 obj2:obj2</span><span>];
</span><span>    };
</span><span>
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;runInvocation&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#c99e00;">NSInvocation </span><span style="color:#3e999f;">*</span><span>invocation) {
</span><span>        [invocation </span><span style="color:#4271ae;">invoke</span><span>];
</span><span>    };
</span><span>
</span><span>    </span><span style="color:#8e908c;">// helper
</span><span>    [[</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>] evaluateScript</span><span style="color:#3e999f;">:</span><span style="color:#839c00;">@&quot;var console = {}&quot;</span><span>];
</span><span>    [</span><span style="color:#c82728;">self </span><span style="color:#4271ae;">context</span><span>][</span><span style="color:#839c00;">@&quot;console&quot;</span><span>][</span><span style="color:#839c00;">@&quot;log&quot;</span><span>] </span><span style="color:#3e999f;">= ^</span><span>(</span><span style="color:#8959a8;">id </span><span>message) {
</span><span>        </span><span style="color:#4271ae;">NSLog</span><span>(</span><span style="color:#839c00;">@&quot;Javascript log: </span><span>%@</span><span style="color:#839c00;">&quot;</span><span>,message);
</span><span>    };
</span><span>}
</span><span style="color:#8959a8;">@end
</span></code></pre>

  </div>


  <ul class="tags flex flex-wrap justify-center items-center gap-4 mt-5 mb-8 text-lg">
    
    
    <li
      class="px-4 pb-[2px] leading-8 rounded-full border text-gray-700 border-gray-700 hover:text-gray-100 hover:border-gray-900 hover:bg-gray-900 transition-all">
      <a class="inline-block" href="https://limboy.me/tags/programming/">programming</a>
    </li>
    
    <li
      class="px-4 pb-[2px] leading-8 rounded-full border text-gray-700 border-gray-700 hover:text-gray-100 hover:border-gray-900 hover:bg-gray-900 transition-all">
      <a class="inline-block" href="https://limboy.me/tags/ios/">iOS</a>
    </li>
    
    
  </ul>

  
  <script src="https://giscus.app/client.js" data-repo="limboy/telescope"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzODEwOTA2MTg=" data-category="General"
    data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMzMDY2MTQy" data-mapping="title" data-reactions-enabled="1"
    data-emit-metadata="0" data-theme="light" data-lang="en" crossorigin="anonymous" async>
    </script>
  

  

</div>

      </div>
    </div>
    
    <footer
      class="flex border-t border-gray-300 text-gray-600 bg-gray-50 items-center justify-center h-12 text-sm mt-2">
      <div class="flex inner justify-center gap-4">
        <a class="hover:underline" href="https://github.com/limboy" target="_blank">GitHub</a>
        <a class="hover:underline" href="https://twitter.com/_limboy" target="_blank">Twitter</a>
        <a class="hover:underline" href="https://limboy.me/index.xml">RSS</a>
      </div>
    </footer>
    
  </div>

  
  

  <script>
    // éƒ½æ˜¯ä¸ºäº† iOS...
    document.querySelector("#wrapper").style.minHeight = `calc(${window.innerHeight}px - 6.5rem)`
    window.addEventListener('resize', () => {
      document.querySelector("#wrapper").style.minHeight = `calc(${window.innerHeight}px - 6.5rem)`
    })
  </script>
</body>

</html>