<!DOCTYPE html>
<html>

<head>
  <meta content="width=device-width,initial-scale=1" name="viewport" />
  <meta charset="UTF-8">
  <link rel="icon" href="https://fav.farm/ğŸ‘»" />
  <title>
è¯» Facebook App å¤´æ–‡ä»¶çš„ä¸€äº›æ”¶è·
</title>
  <link rel="stylesheet" href="/assets/main.css?6&#x2F;2ShUT3RYeReiJdlrDhZN+03rWSUD7DPccwza9UdPM=" />
  <script async defer data-domain="limboy.me" src="https://analytics.limboy.me/js/plausible.js"></script>
  
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@_limboy">
<meta name="twitter:site" content="@_limboy">
<meta property="og:url" content="https://limboy.me/posts/facebook-app-headers/">

<meta name="twitter:title" content="è¯» Facebook App å¤´æ–‡ä»¶çš„ä¸€äº›æ”¶è·">
<meta property="og:title" content="è¯» Facebook App å¤´æ–‡ä»¶çš„ä¸€äº›æ”¶è·">

<meta property="og:description" content="">
<meta name="twitter:description" content="">



</head>

<body class="  ">
  <nav class="flex justify-center items-center opacity-80 bg-black h-12 py-0 ">
    <div class="inner flex justify-between flex-row mx-1">
      <ul class="color-white flex flex-row justify-start gap-4">
        <li><a class="nav-link opacity-90 text-2xl" href="/">Limboy</a></li>
        <!--<li><a class="nav-link" href="/coodle">Coodle</a></li>-->
      </ul>
      <ul class="color-white flex flex-row gap-4 items-center text-base">
        <!--<li> <a class="nav-link" href="/books" class="decoration-0"> Books </a> </li>-->
        <li> <a class="nav-link" href="/highlights" class="decoration-0"> Highlights </a> </li>
        <li> <a class="nav-link" href="/projects" class="decoration-0"> Projects </a> </li>
        <li> <a class="nav-link" href="/about" class="decoration-0"> About </a> </li>
      </ul>
    </div>
  </nav>

  <div class="flex flex-col">
    <div id="wrapper" class="flex justify-center" style="min-height: calc(100vh - 6.5rem);">
      <div class="inner mb-2">
        
<div class="mt-4 lg:mt-6">
  

  <h1 class="title font-medium text-3xl"><a href="https:&#x2F;&#x2F;limboy.me&#x2F;posts&#x2F;facebook-app-headers&#x2F;">è¯» Facebook App å¤´æ–‡ä»¶çš„ä¸€äº›æ”¶è·</a></h1>
  <div class="flex gap-4 items-center my-1">
    <time class="text-gray-500">2014-11-28</time>

  </div>
  <hr class="border-t-[3px]" />

  <div class="prose lg:prose-xl max-w-full my-6">
    <p>æœ€è¿‘åœ¨çœ‹ä¸€äº› App æ¶æ„ç›¸å…³çš„æ–‡ç« ï¼Œä¹Ÿçœ‹äº† Facebook åˆ†äº«çš„ä¸¤ä¸ªä¸åŒæ—¶æœŸçš„æ¶æ„ï¼ˆ2013 å’Œ 2014ï¼‰ï¼Œäºæ˜¯å°±æƒ³ä¸€çª¥ Facebook App çš„å¤´æ–‡ä»¶ï¼Œçœ‹çœ‹ä¼šä¸ä¼šæœ‰æ›´å¤šçš„æ”¶è·ï¼Œç¡®å®æœ‰ï¼Œè¿˜ä¸å°‘ã€‚ç”±äºåœ¨é€‰æ‹© ipa ä¸Šçš„å¤±è¯¯ï¼Œä¸‹äº†ä¸ª 7.0 ç‰ˆçš„ Facebookï¼ˆæœ€æ–°çš„æ˜¯ 18.1ï¼‰ï¼Œä¼šç¨æœ‰è¿‡æ—¶ï¼Œä¸è¿‡åæ¥åˆä¸‹äº†ä¸ª 18.1 çš„çœ‹äº†ä¸‹ï¼Œå‘ç°å˜åŠ¨å…¶å®ä¸å¤§ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»å¤´æ–‡ä»¶ä¸­è·å–åˆ°çš„ä¸€äº›ä¿¡æ¯ï¼ˆ20 å¤šä¸‡è¡Œï¼Œæµè§ˆèµ·æ¥è¿˜æ˜¯æŒºç´¯çš„ï¼‰</p>
<h3 id="rang-shi-tu-zu-jian-ke-yi-fang-bian-di-pei-zhi">è®©è§†å›¾ç»„ä»¶å¯ä»¥æ–¹ä¾¿åœ°é…ç½®</h3>
<p>è¿™ä¸ªåœ¨ Facebook çš„æ¼”è®²ä¸­ä¹Ÿæåˆ°è¿‡ï¼Œè‡ªå®šä¹‰çš„ UI ç»„ä»¶åœ¨åˆå§‹åŒ–æ—¶å¯ä»¥ä¼ ä¸€äº›æ•°å€¼æ¥è¡¨ç¤ºæƒ³è¦å‘ˆç°çš„æ•ˆæœï¼Œå°±åƒ HTML å’Œ CSS ä¸€æ ·ï¼ŒDom ç»“æ„è¡¨ç¤ºè¿™æ˜¯ä»€ä¹ˆï¼ŒCSS å¯¹è¯¥ç»“æ„è¿›è¡Œä¸ªæ€§åŒ–å®šåˆ¶ã€‚ Facebook æ˜¯é€šè¿‡ Struct æ¥åšè¿™ä»¶äº‹çš„ï¼Œæ¯”å¦‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">struct </span><span>FBActionSheetButtonMetrics {
</span><span>    CDUnknownFunctionPointerType </span><span style="color:#3e999f;">*</span><span>_vptr$FBMetrics;
</span><span>    </span><span style="color:#8959a8;">_Bool</span><span> _initialized;
</span><span>    </span><span style="color:#8959a8;">float</span><span> leftMargin;
</span><span>    </span><span style="color:#8959a8;">float</span><span> textLeftMargin;
</span><span>    </span><span style="color:#8959a8;">float</span><span> bottomSeperatorSideMargin;
</span><span>    </span><span style="color:#8959a8;">float</span><span> bottomSeperatorHeight;
</span><span>    </span><span style="color:#8959a8;">int</span><span> detailMaxNumLines;
</span><span>    UIColor </span><span style="color:#3e999f;">*</span><span>titleColor;
</span><span>	</span><span style="color:#8e908c;">//...
</span><span>};
</span></code></pre>
<p>å¥½å¤„æ˜¯å‡å°‘äº†ä»£ç é‡ï¼Œè€Œä¸”ç›´è§‚ï¼Œæ–¹ä¾¿å¤ç”¨ã€‚</p>
<h3 id="jin-liang-shi-yong-zu-he-gua-du-shi-yong-ji-cheng">å°½é‡ä½¿ç”¨ç»„åˆï¼Œé€‚åº¦ä½¿ç”¨ç»§æ‰¿</h3>
<p>å¦‚æœè¿‡åº¦ä½¿ç”¨ç»§æ‰¿ï¼Œå°¤å…¶æ˜¯ç»§æ‰¿å±‚æ¬¡è¿‡æ·±ï¼Œå¾€å¾€ä¼šå¸¦æ¥æ›´å¤§çš„ç»´æŠ¤æˆæœ¬ã€‚æœ‰æ–°éœ€æ±‚æˆ–éœ€æ±‚å˜æ›´æ—¶ï¼Œä¼šèŠ±å¾ˆå¤šæ—¶é—´åœ¨ã€Œæ˜¯å¦éœ€è¦åœ¨åŸºç±»/å­ç±»å¢åŠ ä¸€ä¸ªæ–¹æ³•ã€ï¼Œã€Œæ˜¯å¦éœ€è¦æ–°å»ºä¸€ä¸ªå­ç±»ã€ç­‰è®¾è®¡ç›¸å…³çš„é—®é¢˜ä¸Šã€‚è€Œç»„åˆåˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¤§ä¸äº†æ¢ä¸€ä¸ªç»„ä»¶ã€‚</p>
<p>ä¸è¿‡ Objective-C å¯¹äºç»„åˆå¹¶æ²¡æœ‰ç‰¹åˆ«çš„æ”¯æŒï¼Œæ‰€ä»¥å®ç°èµ·æ¥ä¼šç•¥éº»çƒ¦</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@interface </span><span>People {}
</span><span style="color:#8959a8;">@property id </span><span>&lt;Vehicle&gt; vehicle;
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">move</span><span>;
</span><span style="color:#8959a8;">@end
</span><span>
</span><span style="color:#8959a8;">@implementation </span><span>People
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">initWithVehicle: </span><span>(</span><span style="color:#8959a8;">id </span><span>&lt;Vehicle&gt;)</span><span style="color:#f07219;">vehicle </span><span>{
</span><span>	</span><span style="color:#8959a8;">if </span><span>(</span><span style="color:#c82728;">self </span><span style="color:#3e999f;">= </span><span>[</span><span style="color:#c82728;">super </span><span style="color:#4271ae;">init</span><span>]) {
</span><span>		</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">vehicle </span><span style="color:#3e999f;">=</span><span> vehicle;
</span><span>	}
</span><span>	</span><span style="color:#8959a8;">return </span><span style="color:#c82728;">self</span><span>;
</span><span>}
</span><span>
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">move </span><span>{
</span><span>	[</span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">vehicle</span><span> move];
</span><span>}
</span><span style="color:#8959a8;">@end
</span></code></pre>
<p>å¦‚æœæœ‰å¾ˆå¤šç±»ä¼¼ move è¿™æ ·éœ€è¦äº¤ç»™å¤–éƒ¨çš„ object æ¥åšçš„æ–¹æ³•ï¼Œå°±ä¼šæ˜¾å¾—å†—ä½™ï¼Œå°½ç®¡å¦‚æ­¤ï¼Œæ¯”èµ·ç»§æ‰¿æ¥è¿˜æ˜¯æ›´æ–¹ä¾¿ç»´æŠ¤çš„ã€‚</p>
<p>ä½¿ç”¨ç»„åˆçš„è¯ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ã€Œä¾èµ–æ³¨å…¥ã€ï¼Œæ¯”å¦‚è¿™é‡Œçš„ Vehicleï¼Œå¹¶ä¸éœ€è¦ç‰¹åˆ«æŒ‡å‡ºæ˜¯ Bike è¿˜æ˜¯ Carï¼Œåªè¦æœ‰ move æ–¹æ³•å°±å¯ä»¥ï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ›¿æ¢ï¼Œå¯¹äº People æ¥è¯´ä¸éœ€è¦åšä»»ä½•æ”¹åŠ¨ã€‚åœ¨ Objective-C é‡Œæ˜¯é€šè¿‡ protocol æ¥å®ç°çš„ã€‚</p>
<p>æ‰€ä»¥ Facebook å®šä¹‰äº†ä¸€å¤§å †çš„æ¥å£ï¼ŒåŒ…æ‹¬ Delegate, DataSource å’Œ Protocolï¼ŒViewController æœ‰ Protocolï¼Œä¹Ÿæœ‰ Delegate(å¦‚ FBMediaGalleryViewControllerDelegate)ï¼ŒView / Cell ä¹Ÿæœ‰ Delegate(å¦‚ FBMediaGalleryViewDelegate)ï¼Œè¿˜æœ‰å„ç§é›¶é›¶ç¢ç¢çš„ Protocolï¼Œå¦‚ FBDiscoveryCardProtocol, FBEventProtocol ç­‰ã€‚</p>
<p>å®šä¹‰æ¥å£çš„è¿‡ç¨‹ä¹Ÿæ˜¯æ¢³ç†æ¶æ„çš„è¿‡ç¨‹ï¼Œå¦‚æœå¯¹æ¶æ„ç†è§£ä¸å¤Ÿæ·±åˆ»ï¼Œæ˜¯å¾ˆéš¾å°†æ¥å£æ°å½“åœ°æŠ½è±¡å‡ºæ¥çš„ã€‚å¾ˆå¤šäººæ”¾å¼ƒä½¿ç”¨ç»„åˆï¼Œæœ‰ä¸€éƒ¨åˆ†åŸå› ä¹Ÿæ˜¯æ¶æ„ä¸Šçš„ä¸åˆç†ã€‚</p>
<p>ç»„ä»¶çš„ç²’åº¦ä¹Ÿæ˜¯ä¸ªé—®é¢˜ï¼Œè¿‡ç»†ä¼šå¯¼è‡´ç»„ä»¶è¿‡å¤šï¼Œç»„åˆçš„è¿‡ç¨‹å°±ä¼šèŠ±å»å¾ˆå¤šæ—¶é—´ï¼›è¿‡ç²—åˆå¯¼è‡´ç»„ä»¶è‡ƒè‚¿ï¼Œéš¾ä»¥å¤ç”¨ã€‚</p>
<p>å½“ç»„ä»¶çš„æ¥å£å®šä¹‰å®Œä¹‹åï¼Œä½¿ç”¨èµ·æ¥å¤§æ¦‚ä¼šæ˜¯è¿™æ ·ï¼š</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@interface </span><span>FBResponseHandler : </span><span style="color:#839c00;">NSObject </span><span>&lt;FBTestable, FBReceivedDataBufferDelegate, FBResponseHandlerProtocol&gt;
</span><span>
</span><span>@interface FBPhotoViewController </span><span style="color:#3e999f;">:</span><span> UIViewController &lt;FBPagingViewDelegate, FBPagingViewDataSource, FBPresentableViewController&gt;
</span></code></pre>
<p>è¿™æ ·ä¸€çœ¼å°±å¤§æ¦‚èƒ½çœ‹å‡ºæ¥è¿™ä¸ª Class å¤§æ¦‚ä¼šæœ‰å“ªäº›åŠŸèƒ½ï¼Œå¦‚æœæŸä¸ªç»„ä»¶è¦ä½œè°ƒæ•´ï¼Œåªéœ€ä¿®æ”¹ä¸€å¤„ï¼Œå°±å¯ä»¥å…¨å±€é€šç”¨ã€‚</p>
<p>é€‚åº¦ä½¿ç”¨ç»§æ‰¿ï¼Œå¯ä»¥åœ¨æ˜“ç»´æŠ¤å’Œä¾¿åˆ©ä¸Šè¾¾åˆ°å¹³è¡¡ï¼Œæ¯”å¦‚ FBTableViewController, FBDialog ç­‰ï¼Œè‡ªå®šä¹‰çš„ç»„ä»¶å¯ä»¥åœ¨å®ƒä»¬çš„åŸºç¡€ä¸Šè¿›è¡Œå¼€å‘ã€‚ç»§æ‰¿çš„å±‚æ¬¡ä¸€èˆ¬ä¸è¶…è¿‡ 2 å±‚ï¼Œæ¯”å¦‚ UITableViewController &lt;- FBTableViewController &lt;- FBFriendsNearbyTableViewController</p>
<h3 id="yi-lai-zhu-ru">ä¾èµ–æ³¨å…¥</h3>
<p>å‰é¢è®²è¿‡ï¼Œç»„åˆå¾€å¾€å’Œä¾èµ–æ³¨å…¥æ­é…ä½¿ç”¨ï¼ŒFacebook ä¸»è¦æ˜¯é€šè¿‡ FBProvider, FBProviderMapData, FBProviderMap æ¥å®ç°ä¾èµ–æ³¨å…¥çš„ã€‚</p>
<p>Provider ä¼šäº§ç”Ÿä¸€ä¸ª Objectï¼Œæ¯”å¦‚ CameraControllerProvider è°ƒç”¨ get æ–¹æ³•åï¼Œä¼šç”Ÿæˆä¸€ä¸ª MNCameraController çš„å®ä¾‹ã€‚åŒæ—¶ Provider è¿˜æœ‰ä¸¤ä¸ªå­ç±» SingletonProvider å’Œ BlockProviderï¼Œå‰è€…ç”¨æ¥ç”Ÿæˆä¸€ä¸ªå•ä¾‹ï¼Œåè€…ç”¨åœ¨éœ€è¦åˆå§‹åŒ–å‚æ•°çš„æƒ…æ™¯ã€‚</p>
<p>ProviderMap è·Ÿ ProviderMapData æœ‰äº›é‡å¤ï¼Œå®ƒä»¬ä¹‹é—´çš„å…³ç³»æˆ‘ä¹Ÿæ²¡æœ‰æ‹æ¸…ï¼Œæ„Ÿè§‰ ProviderMap åƒæ˜¯ä¸€ä¸ª Managerï¼Œæ³¨å†Œäº†ä¸€å † Providerï¼Œç„¶åå¯ä»¥é€šè¿‡ Provider çš„ ID æ¥æ‰¾åˆ°ä¹‹å‰æ³¨å†Œçš„ Providerã€‚</p>
<h3 id="mo-kuai-hua">æ¨¡å—åŒ–</h3>
<p>ä¸å…‰æ˜¯åœ¨ Cocoa å¼€å‘é¢†åŸŸï¼Œå…¶ä»–çš„ç¼–ç¨‹é¢†åŸŸä¹Ÿä¸€æ ·ï¼Œæ¨¡å—åŒ–æ˜¯ä¸€ä¸ªç†æƒ³çš„çŠ¶æ€ï¼Œé«˜å†…èšï¼Œä½è€¦åˆã€‚åƒ shell å‘½ä»¤ä¸€æ ·ï¼Œæ¥å—å‚æ•°æˆ–æ ‡å‡†è¾“å…¥ï¼Œç”Ÿæˆæ ¼å¼åŒ–çš„æ ‡å‡†è¾“å‡ºï¼Œé€šè¿‡ç®¡é“ä¼ é€’ç»™å…¶ä»–æ”¯æŒæ ‡å‡†è¾“å…¥çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</p>
<p>ä½†ç°å®åœºæ™¯è¦å¤æ‚çš„å¤šï¼Œæ¨¡å—åŒ–çš„å®ç°ä¹Ÿæ›´åŠ å›°éš¾ã€‚Facebook æœ‰ä¸€ä¸ª FBAppModule åè®®</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@protocol </span><span>FBAppModule &lt;NSObject&gt;
</span><span>+ (</span><span style="color:#8959a8;">id </span><span>&lt;FBAppModule&gt;)</span><span style="color:#4271ae;">instanceForSession:</span><span>(FBSession </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">arg1 </span><span style="color:#4271ae;">providerMap:</span><span>(FBProviderMap </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">arg2</span><span>;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#c99e00;">NSArray </span><span style="color:#3e999f;">*</span><span>supportedURLSchemes;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#c99e00;">NSArray </span><span style="color:#3e999f;">*</span><span>supportedKeys;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">retain</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#8959a8;">id </span><span>&lt;FBMenuItem&gt; activeMenuItem;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>defaultIcon;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>ID;
</span><span>- (UIViewController </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#4271ae;">viewControllerForMenuItem:</span><span>(</span><span style="color:#8959a8;">id </span><span>&lt;FBMenuItem&gt;)</span><span style="color:#f07219;">arg1</span><span>;
</span></code></pre>
<p>åˆå§‹åŒ–æ—¶ä¼ å…¥ä¸€ä¸ª FBSession (åé¢ä¼šè®²åˆ°) å’Œ ProviderMapï¼Œç„¶åè®¾ç½®æ”¯æŒçš„ url schemesï¼Œkeys(å…·ä½“ä½œç”¨æœªçŸ¥)ï¼Œå¯¹åº”çš„ menuItemï¼Œicon(ç”¨äºåœ¨ menuItem æ˜¾ç¤º) å’Œ ID</p>
<p>æœ‰äº† Module ï¼Œè‡ªç„¶è¿˜æœ‰ ModuleManagerï¼Œå®ƒçš„ä½œç”¨æ˜¯æ³¨å†Œ Moduleï¼Œå½“ä¸€ä¸ª url è¿‡æ¥æ—¶ï¼Œå¯ä»¥éå† Moduleï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æœ‰æ¨¡å—å¯ä»¥å¤„ç†è¿™ä¸ª urlï¼Œæœ‰çš„è¯ï¼Œå°±è°ƒç”¨è¯¥ Module çš„ openURL: æ–¹æ³•ã€‚å½“ç„¶ä¹Ÿå¯ä»¥æ ¹æ® ModuleID æ¥è·å– Moduleã€‚</p>
<p>FBAppModule æ˜¯ä¸€ä¸ª Protocolï¼ŒFBNativeAppModule æ˜¯å¯¹è¯¥åè®®çš„å®ç°ï¼Œæ‰€ä»¥å…·ä½“çš„æ¨¡å—éƒ½ç»§æ‰¿è¯¥ç±»ã€‚</p>
<h3 id="dao-hang-guan-li">å¯¼èˆªç®¡ç†</h3>
<p>ä¸€èˆ¬æ¥è¯´ç³»ç»Ÿçš„ UINavigationController å·²ç»å¤Ÿä½¿ç”¨äº†ï¼Œå¦‚æœéœ€è¦æ›´å¤§çš„è‡ªç”±åº¦å’Œæ›´é«˜çš„å¯å®šåˆ¶æ€§ï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå¯¼èˆªç®¡ç†å™¨ï¼ŒFacebook ä½¿ç”¨äº† FBUINavigationController (Protocol) æ¥å®ç°è‡ªå®šä¹‰å¯¼èˆªçš„ç®¡ç†ï¼Œå±æ€§å’Œæ–¹æ³•è·Ÿç³»ç»Ÿçš„å·®ä¸å¤šã€‚ å®ƒæœ‰å¤šä¸ªå®ç°ï¼šFBTariffedNavigationController, FBSwipeNavigationController, FBCustomNavigationController, FBNavigationControllerã€‚å‰é¢è®²è¿‡ç»§æ‰¿ä¸€èˆ¬ä¸è¶…è¿‡ 2 å±‚ï¼Œè¿™é‡Œæ˜¯ä¸€èˆ¬ä¹‹å¤–çš„æƒ…å†µï¼Œæœ‰ 3 å±‚ã€‚</p>
<h3 id="mvvm">MVVM</h3>
<p>MVVM æ˜¯è§£å†³ Massive View Controller çš„ä¸€ä¸ªæœ‰æ•ˆæ–¹æ³•ï¼Œç‹¬ç«‹å‡ºä¸€ä¸ª ViewModel ä½œä¸º View çš„æ•°æ®æºï¼Œä»¥åŠå¤„ç† View çš„ä¸€äº›äº¤äº’æ“ä½œï¼Œè€Œ VC åªéœ€è¦å°† ViewModel å’Œ View å…³è”èµ·æ¥å³å¯ã€‚ä¸€èˆ¬ä¼šæ­é…æŸç§ç»‘å®šçš„å®ç°ï¼ŒKVO æˆ– ReactiveCocoa éƒ½å¯ä»¥ï¼Œè¿™æ · ViewModel çš„æ•°æ®æœ‰å˜åŒ–å°±å¯ä»¥è‡ªåŠ¨æ˜ å°„åˆ° View ä¸Šã€‚</p>
<p>Facebook ä¹Ÿé‡‡ç”¨äº†è¿™ç§æ–¹å¼ï¼Œæœ‰ä¸€ä¸ª FBViewModel åŸºç±»</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@interface </span><span>FBViewModel : </span><span style="color:#839c00;">NSObject
</span><span>
</span><span style="color:#8e908c;">// çœç•¥äº†ä¸€äº›ç›¸å…³æ€§ä¸å¤§çš„å±æ€§å’Œæ–¹æ³•
</span><span style="color:#8959a8;">@property</span><span> __weak FBViewModelManager </span><span style="color:#3e999f;">*</span><span>viewModelManager; </span><span style="color:#8e908c;">// @synthesize viewModelManager=_viewModelManager;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#8959a8;">unsigned int</span><span> viewModelSource; </span><span style="color:#8e908c;">// @synthesize viewModelSource=_viewModelSource;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">retain</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) FBViewModelConfiguration </span><span style="color:#3e999f;">*</span><span>viewModelConfiguration; </span><span style="color:#8e908c;">// @synthesize viewModelConfiguration=_viewModelConfiguration;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#8959a8;">unsigned int</span><span> viewModelVersion; </span><span style="color:#8e908c;">// @synthesize viewModelVersion=_viewModelVersion;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>viewModelUUID; </span><span style="color:#8e908c;">// @synthesize viewModelUUID=_viewModelUUID;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">retain</span><span>) FBMemModelObject </span><span style="color:#3e999f;">*</span><span>memModel; </span><span style="color:#8e908c;">// @synthesize memModel=_memModel;
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">setNilValueForKey:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">initWithViewModelUUID:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1 </span><span style="color:#4271ae;">viewModelVersion:</span><span>(</span><span style="color:#8959a8;">unsigned int</span><span>)</span><span style="color:#f07219;">arg2</span><span>;
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">setViewModelVersion:</span><span>(</span><span style="color:#8959a8;">unsigned int</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">humanDescription</span><span>;
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">loadPermanentDataModelObjectIDFromDataModelObjectID:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1 </span><span style="color:#4271ae;">block:</span><span>(CDUnknownBlockType)</span><span style="color:#f07219;">arg2</span><span>;
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">didUpdateWithChangedProperties:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span style="color:#8959a8;">@property</span><span> __weak FBViewModelController </span><span style="color:#3e999f;">*</span><span>modelController;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#8959a8;">int</span><span> loadState;
</span><span>
</span><span style="color:#8959a8;">@end
</span></code></pre>
<p>Facebook è‡ªå·±å®ç°äº†ä¸€å¥— ViewModel çš„æ›´æ–°é€šçŸ¥æœºåˆ¶ï¼Œå› ä¸º ViewModel éƒ½æ˜¯ Immutable çš„ï¼Œæ‰€ä»¥æ— æ³•æ”¹å˜ï¼Œé‚£ä¹ˆå°±éœ€è¦æœ‰ä¸€ä¸ªåœ°æ–¹å»é›†ä¸­ç®¡ç†è¿™äº› ViewModelï¼Œæœ‰æ›´æ–°æ—¶å¯ä»¥åŠæ—¶é€šçŸ¥åˆ°ï¼Œ FBViewModelController åº”è¯¥å°±æ˜¯å¹²è¿™äº‹çš„ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªæ–¹æ³• <code>- (void)_notifyViewModel:(id)arg1 didUpdateWithChanges:(id)arg2;</code> ã€‚ä½† FBViewModelManager çœ‹èµ·æ¥æ›´åˆé€‚ï¼ŒäºŒè€…çš„åŠŸèƒ½æ²¡æœ‰å¤ªç†æ¸…æ¥šã€‚</p>
<p>FBViewModelController è¿˜æœ‰ä¸€ä¸ª Delegateï¼Œä¸»è¦æœ‰ 3 ä¸ªæ–¹æ³• <code>didUpdate[Delegate][Insert]ViewModel:</code>ï¼Œå¯ä»¥åšä¸€äº›äº‹åçš„æ“ä½œã€‚</p>
<h3 id="builder-pattern">Builder Pattern</h3>
<p>åœ¨å®šä¹‰ä¸€ä¸ª ViewController æ—¶ï¼Œå¾€å¾€éœ€è¦æ¥æ”¶å¾ˆå¤šä¸ªå‚æ•°ï¼Œä»¥ <code>initWith:</code> è¿™ç§å½¢å¼å‡ºç°ä¸å¤ªåˆé€‚ï¼Œé™¤éä½ èƒ½å®¹å¿ä¸€ä¸ª 10 è¡Œçš„æ–¹æ³•å£°æ˜ã€‚é€šå¸¸çš„åšæ³•æ˜¯æŠŠè¿™äº›å‚æ•°å£°æ˜ä¸º propertyï¼Œç„¶ååœ¨åˆå§‹åŒ– VC åï¼Œå¯¹è¿™äº› property èµ‹å€¼ï¼Œç„¶ååœ¨ ViewDidLoad é‡Œä½¿ç”¨è¿™äº› propertyã€‚è¿™æ ·åšæœ‰å‡ ä¸ªé—®é¢˜ï¼š1) ä¸çŸ¥é“å“ªäº›æ˜¯éœ€è¦åœ¨ ViewDidLoad å‰è®¾ç½®çš„ï¼Œä¼šå‡ºç°å¿˜äº†è®¾ç½®çš„ç°è±¡ã€‚2) è¿™äº›å±æ€§å¯ä»¥åœ¨å¤–éƒ¨è¢«æ”¹åŠ¨ã€‚ 3) ä»£ç ä¸å¤Ÿä¼˜é›…ã€‚</p>
<p>Builder Pattern å°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼Œå®ƒè·Ÿå·¥å‚æ¨¡å¼æœ‰ç‚¹åƒã€‚Facebook ä¹Ÿç”¨åˆ°äº†è¿™ä¸ªæ¨¡å¼ï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ª FBMUserFetchStatus ç±»ï¼Œè¯¥ç±»åˆå§‹åŒ–æ—¶éœ€è¦ä¸€äº›å‚æ•°ï¼Œäºæ˜¯å°±æœ‰äº† FBMUserFetchStatusBuilder ç±»</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@interface </span><span>FBMUserFetchStatusBuilder : </span><span style="color:#839c00;">NSObject
</span><span>
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">aMUserFetchStatusFromExistingMUserFetchStatus:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">aMUserFetchStatus</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">withIdentifiers:</span><span>(</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">withImageUrls:</span><span>(</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">withHasVerifiedPhone:</span><span>(</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">withCanInstallMessenger:</span><span>(</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">withHasMessenger:</span><span>(</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">withIsFriend:</span><span>(</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">withNickname:</span><span>(</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">withPhoneticName:</span><span>(</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">withName:</span><span>(</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">withUserId:</span><span>(</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">build</span><span>;
</span><span>
</span><span style="color:#8959a8;">@end
</span></code></pre>
<p>æœ€åçš„ build æ–¹æ³•ä¼šç”Ÿæˆä¸€ä¸ª FBMUserFetchStatus å®ä¾‹ï¼Œæœ‰äº†è¿™ä¸ª Builder å°±çŸ¥é“æœ‰å“ªäº›å‚æ•°æ˜¯å¯ä»¥åœ¨åˆå§‹åŒ–æ—¶è¿›è¡Œè®¾ç½®çš„ã€‚</p>
<h3 id="data-manager">Data Manager</h3>
<p>è¿™æ˜¯é‡å¤´æˆï¼Œæ‰€ä»¥çœ‹èµ·æ¥ç•¥ç´¯ï¼Œä¸œè¥¿å¾ˆå¤šï¼Œå¾ˆå¯èƒ½æ¨æ–­é”™è¯¯ã€‚</p>
<p>å…ˆæ¥çœ‹çœ‹å®ä½“ç±»ï¼Œé¦–å…ˆæ˜¯ FBEntityRequest</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@protocol </span><span>FBEntityRequestParse
</span><span>@optional
</span><span>+ (</span><span style="color:#8959a8;">BOOL</span><span>)</span><span style="color:#4271ae;">canParse:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1 </span><span style="color:#4271ae;">error:</span><span>(</span><span style="color:#8959a8;">id </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">arg2</span><span>;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">retain</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#c99e00;">NSError </span><span style="color:#3e999f;">*</span><span>syncError;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">nonatomic</span><span>, </span><span style="color:#8959a8;">getter</span><span>=isSyncing) </span><span style="color:#8959a8;">BOOL</span><span> syncing;
</span><span>- (</span><span style="color:#8959a8;">unsigned int</span><span>)</span><span style="color:#4271ae;">parse:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1 </span><span style="color:#4271ae;">request:</span><span>(</span><span style="color:#8959a8;">id </span><span>&lt;FBRequest&gt;)</span><span style="color:#f07219;">arg2 </span><span style="color:#4271ae;">error:</span><span>(</span><span style="color:#8959a8;">id </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">arg3</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id </span><span>&lt;FBRequest&gt;)</span><span style="color:#4271ae;">request</span><span>;
</span><span style="color:#8959a8;">@end
</span></code></pre>
<p>æ‰€ä»¥å®ä½“éƒ½æ˜¯å¯ä»¥è¢«è§£æå’ŒåŒæ­¥çš„ï¼Œè¿˜è‡ªå¸¦äº†ä¸€ä¸ª Requestã€‚</p>
<p>å†æ¥çœ‹çœ‹ FBEntity</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@protocol </span><span>FBEntity &lt;FBEntityRequestParse, NSObject&gt;
</span><span>+ (</span><span style="color:#c99e00;">NSURL </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#4271ae;">entityURLForFBID:</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#c99e00;">NSURL </span><span style="color:#3e999f;">*</span><span>entityURL;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>, </span><span style="color:#8959a8;">getter</span><span>=isDataStale) </span><span style="color:#8959a8;">BOOL</span><span> dataStale;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">retain</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#c99e00;">NSDate </span><span style="color:#3e999f;">*</span><span>lastSyncTime;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">retain</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>fbid;
</span><span>
</span><span>@optional
</span><span>+ (</span><span style="color:#8959a8;">unsigned int</span><span>)</span><span style="color:#4271ae;">collection:</span><span>(FBEntityCollection </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">arg1 </span><span style="color:#4271ae;">parse:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg2 </span><span style="color:#4271ae;">request:</span><span>(</span><span style="color:#8959a8;">id </span><span>&lt;FBRequest&gt;)</span><span style="color:#f07219;">arg3 </span><span style="color:#4271ae;">error:</span><span>(</span><span style="color:#8959a8;">id </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">arg4</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id </span><span>&lt;FBRequest&gt;)</span><span style="color:#4271ae;">collectionRequest:</span><span>(FBEntityCollection </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) FBEntityDownloader </span><span style="color:#3e999f;">*</span><span>entityDownloader;
</span><span>- (</span><span style="color:#c99e00;">NSSet </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#4271ae;">parentEdges</span><span>;
</span><span>- (</span><span style="color:#c99e00;">NSSet </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#4271ae;">parentCollections</span><span>;
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">entityInitializeWithFBID:</span><span>(</span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span style="color:#8959a8;">@end
</span></code></pre>
<p>æ¯ä¸ª Entity éƒ½æœ‰ä¸€ä¸ª entityURLï¼Œæˆ–è®¸å¯ä»¥ç”¨æ¥åŒæ­¥ï¼Ÿ dataStale åº”è¯¥æ˜¯ç”¨æ¥è¡¨ç¤ºæ•°æ®æ˜¯å¦ dirtyï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œå¯èƒ½éœ€è¦åŒæ­¥ã€‚ è¿˜å¯ä»¥è¯·æ±‚ Collectionã€‚</p>
<p>FBEntityCollection è·Ÿ FBEntity ç±»ä¼¼ï¼Œä¸è¿‡å¤šäº† syncAll / memberClass / allObjects è¿™äº›å±æ€§/æ–¹æ³•ã€‚</p>
<p>å†æ¥çœ‹çœ‹æ•°æ®è¯·æ±‚ï¼Œé¦–å…ˆæ˜¯ FBRequestï¼Œä¸å¤ªæ˜ç™½è¿™ä¸ª Class çš„å…·ä½“åŠŸèƒ½ï¼Œå› ä¸ºæ²¡æœ‰ URLï¼Œä¸€ä¸ªæ²¡æœ‰ URL çš„ Request èƒ½åšä»€ä¹ˆï¼Ÿ ç„¶åçœ‹åˆ°äº† FBRequesterï¼Œè¿™ä¸ªçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªæ•°æ®è¯·æ±‚ç±»ï¼Œæœ‰ URL, responseHandler, connection çŠ¶æ€, delegate ç­‰ã€‚ä½†è¿™åªæ˜¯å•ä¸ªçš„è¯·æ±‚ï¼Œå¦‚ä½•å¯¹å¤šä¸ªè¯·æ±‚è¿›è¡Œç®¡ç†å‘¢ï¼Œè¿™æ—¶çœ‹åˆ°äº† FBNetworkerï¼Œå®ƒæœ‰ +sharedNetworker, requestQueue, cancelRequests:, addRequest: æ‰€ä»¥å°±æ˜¯å®ƒäº†ã€‚ç­‰ç­‰ï¼Œä¸ºä»€ä¹ˆä¸‹é¢è¿˜æœ‰ä¸€ä¸ª FBNetworkerRequest ï¼Ÿçœ‹èµ·æ¥åƒæ˜¯ FBNetworker çš„ Delegateï¼Œä½†ä¸ç¡®å®šã€‚</p>
<p>ä¸ºäº†é¿å… URI æ•£è½åœ¨å„å¤„ï¼ŒFacebook è¿˜ä¸“é—¨ä¸º NSURL å†™äº†ä¸ª Category æ¥ç»Ÿä¸€ç®¡ç† URIã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@interface </span><span>NSURL (FBFoundation)
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">friendsNearbyURL</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">codeGeneratorURL</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">tagApprovalURLWithTagId:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">tagApprovalURL</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">pokesURL</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">personExpandedAboutURLWithFBID:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span style="color:#8e908c;">// ...
</span></code></pre>
<p>è¿˜æœ‰ä¸€ä¸ª URL ç”Ÿæˆç±»ï¼ŒFBURLRequestGeneratorï¼Œè¯¥ç±»ä¿å­˜äº† appSecret å’Œ appVersionï¼Œç”Ÿæˆçš„ URL ä¼šè‡ªåŠ¨å¸¦ä¸Šè¿™äº›å±æ€§ã€‚</p>
<p>å…¶å®è¿˜æœ‰å¾ˆå¤šï¼Œå®åœ¨çœ‹ä¸ä¸‹æ¥äº†Â·Â·Â·</p>
<h3 id="smarter-views">Smarter Views</h3>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ ViewController è‡ªå¸¦äº†ä¸€ä¸ª viewï¼Œå¯ä»¥ç›´æ¥åœ¨è¿™ä¸ª view ä¸Š addSubviewï¼Œæ­£æ˜¯ç”±äºè¿™ä¸ªä¾¿åˆ©æ€§ï¼Œå¾ˆå¤šåˆ›å»º View çš„ä»£ç ä¹ŸæŒ¤åœ¨äº† VC é‡Œï¼Œå®åœ¨æ˜¯ä¸é›…è§‚ã€‚</p>
<p>æ›´å¥½çš„æ–¹æ³•æ˜¯æ›¿æ¢ VC çš„ view ä¸ºè‡ªå®šä¹‰çš„ Viewï¼Œç„¶åæŠŠè¿™ä¸ªè‡ªå®šä¹‰ View ç‹¬ç«‹å‡ºå»ã€‚æ¯”å¦‚åœ¨ <code>-loadView</code> æ—¶è¦†ç›– view</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@implementation </span><span>MyProfileViewController
</span><span>
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">loadView </span><span>{
</span><span>    </span><span style="color:#c82728;">self</span><span>.</span><span style="color:#c82728;">view </span><span style="color:#3e999f;">= </span><span>[MyProfileView </span><span style="color:#4271ae;">new</span><span>];
</span><span>}
</span></code></pre>
<p>å¯ä»¥åŒæ—¶é‡å®šä¹‰ view çš„ç±»å‹ï¼Œå¦‚ <code>@property (nonatomic) MyProfileView *view</code>ï¼Œè®©ç¼–è¯‘å™¨æ˜ç™½ view çš„ç±»å‹å·²ç»å˜äº†ã€‚</p>
<p>å› ä¸ºçœ‹åˆ°äº†ä¸å°‘ VC ä¸­éƒ½æœ‰ <code>-loadView</code> æ–¹æ³•ï¼Œæ‰€ä»¥æ¨æ–­å¯èƒ½ä½¿ç”¨äº†è¿™é¡¹æŠ€æœ¯ã€‚</p>
<h3 id="fbsession">FBSession</h3>
<p>åœ¨ Web å¼€å‘é¢†åŸŸï¼ŒSession æ˜¯ç”¨æ¥ä¿å­˜ç”¨æˆ·ç›¸å…³çš„ä¿¡æ¯çš„ï¼ŒFBSession è‡ªç„¶ä¹Ÿä¸ä¾‹å¤–ï¼Œä¸è¿‡å®ƒä¿å­˜çš„å†…å®¹è¿˜çœŸæ˜¯å¤šå‘¢ã€‚</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@interface </span><span>FBSession : </span><span style="color:#839c00;">NSObject </span><span>&lt;FBInvalidating&gt;
</span><span>
</span><span>+ (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">setCurrentSession:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">_globalSessionForDebugging</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">DO_NOT_USE_OR_YOU_WILL_BE_FIREDcurrentSession</span><span>;
</span><span>
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>) FBAPISessionStore </span><span style="color:#3e999f;">*</span><span>apiSessionStore; </span><span style="color:#8e908c;">// @synthesize apiSessionStore=_apiSessionStore;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>) FBSessionDiskStore </span><span style="color:#3e999f;">*</span><span>sessionDiskStore; </span><span style="color:#8e908c;">// @synthesize sessionDiskStore=_sessionDiskStore;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>) FBStore </span><span style="color:#3e999f;">*</span><span>store; </span><span style="color:#8e908c;">// @synthesize store=_store;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>) </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>appSecret; </span><span style="color:#8e908c;">// @synthesize appSecret=_appSecret;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>, </span><span style="color:#8959a8;">getter</span><span>=isValid) </span><span style="color:#8959a8;">BOOL</span><span> valid;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>) </span><span style="color:#8959a8;">BOOL</span><span> hasUser;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>) </span><span style="color:#c99e00;">NSString </span><span style="color:#3e999f;">*</span><span>userFBID;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">retain</span><span>) FBViewerContext </span><span style="color:#3e999f;">*</span><span>viewerContext;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">retain</span><span>) FBUserPreferences </span><span style="color:#3e999f;">*</span><span>userPreferences;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">retain</span><span>) FBPreferences </span><span style="color:#3e999f;">*</span><span>sessionPreferences;
</span><span>
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">updateAccessToken:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">updateActingViewer:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">clearPreferences</span><span>;
</span><span>- (</span><span style="color:#8959a8;">void</span><span>)</span><span style="color:#4271ae;">invalidate</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">DO_NOT_USE_OR_YOU_WILL_BE_FIREDvalueForKeyRequiresUser:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1 </span><span style="color:#4271ae;">withInitializer:</span><span>(CDUnknownBlockType)</span><span style="color:#f07219;">arg2</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">valueForKey:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1 </span><span style="color:#4271ae;">withInitializer:</span><span>(CDUnknownBlockType)</span><span style="color:#f07219;">arg2</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">valueForKey:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>- (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">initWithAppSecret:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1 </span><span style="color:#4271ae;">store:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg2 </span><span style="color:#4271ae;">apiSessionStore:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg3</span><span>;
</span><span>
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) FBReactionController </span><span style="color:#3e999f;">*</span><span>reactionController;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) FBLocationPingback </span><span style="color:#3e999f;">*</span><span>locationPingback;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) FBAppSectionManager </span><span style="color:#3e999f;">*</span><span>appSectionManager;
</span><span style="color:#8959a8;">@property</span><span>(</span><span style="color:#8959a8;">readonly</span><span>, </span><span style="color:#8959a8;">nonatomic</span><span>) FBBookmarkManager </span><span style="color:#3e999f;">*</span><span>bookmarkManager;
</span><span>
</span><span style="color:#8e908c;">// and many more...
</span></code></pre>
<p>Session æ˜¯å¯ä»¥ä¿å­˜åˆ°æœ¬åœ°çš„ï¼Œæœ‰ä¸€ä¸ªçŠ¶æ€å˜é‡ç”¨æ¥æ ‡è¯†æ˜¯å¦æœ‰æ•ˆ(valid)ï¼Œæ˜¯å¦å·²ç™»å½•(hasUser)ï¼Œç”¨æˆ·çš„ä¸€äº›è®¾ç½®(è¿™äº›è®¾ç½®ä¼šä¿å­˜åˆ°æœ¬åœ°)ï¼Œå¯ä»¥æ›´æ–° AccessTokenï¼Œè¿˜å¸¦äº†å„ç§ Controller å’Œ Managerï¼Œæ‰€ä»¥ä¸œè¥¿è¿˜æ˜¯æŒºå¤šçš„ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªç‰¹æ®Šæ–¹æ³•ï¼Œä½¿ç”¨åä¼šè¢« FireÂ·Â·Â·</p>
<h3 id="services">Services</h3>
<p>Service é¡¾åæ€ä¹‰ï¼Œæä¾›æŸç§æœåŠ¡ï¼Œå¾€å¾€è·Ÿç•Œé¢æ— å…³ã€‚ä»ç›®å½•å±‚çº§ä¸Šçœ‹ï¼ŒService å¹¶ä¸åœ¨ Module é‡Œé¢ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äºŒè€…æ˜¯ç‹¬ç«‹çš„ï¼Œæ¯”å¦‚ FBTimelineModule å¹¶ä¸åŒ…å« FBTimelineServiceã€‚</p>
<p>Service ä¹‹é—´å¯ä»¥æœ‰ä¾èµ–ï¼Œè¿™é‡Œæ˜¯é€šè¿‡ <code>startAppServiceWithDependencies:</code> æ¥å®ç°çš„ï¼Œä¸è¿‡ä¸æ¸…æ¥š Service è‡ªèº«å¦‚ä½•å£°æ˜ä¾èµ–å“ªäº›å…¶ä»–çš„ Servicesã€‚</p>
<h3 id="style">Style</h3>
<p>App çš„ Style æ˜¯ä¸€ä¸ªå®¹æ˜“è¢«å¿½è§†çš„åœ°æ–¹ï¼Œå¼€å‘å¾€å¾€çœ‹ç€è®¾è®¡å›¾å°±å¼€å§‹å†™äº†ï¼Œè¿™æ ·å¾ˆå®¹æ˜“é€ æˆæ ·å¼ä¸ç»Ÿä¸€ï¼Œä¸”å°†æ¥è°ƒæ•´èµ·æ¥ä¹Ÿä¸æ–¹ä¾¿ã€‚</p>
<p>Facebook æ˜¯é€šè¿‡ Category æ¥è‡ªå®šä¹‰æ ·å¼çš„ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<pre data-lang="m" style="background-color:#f9f9f9;color:#111111;" class="language-m "><code class="language-m" data-lang="m"><span style="color:#8959a8;">@interface </span><span>UIButton (FBMediaKit)
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">fb_buttonTypeSystemWithTitle:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">fb_buttonWithNormalImage:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1 </span><span style="color:#4271ae;">highlightedImage:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg2 </span><span style="color:#4271ae;">selectedImage:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg3</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">fb_buttonWithTemplateImage:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">fb_buttonWithStyle:</span><span>(</span><span style="color:#8959a8;">int</span><span>)</span><span style="color:#f07219;">arg1 </span><span style="color:#4271ae;">title:</span><span>(</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#f07219;">arg2</span><span>;
</span><span style="color:#8959a8;">@end
</span><span>
</span><span style="color:#8959a8;">@interface </span><span>UIButton (FBUIKit)
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">fb_moreOptionsNavBarButton</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">fb_backArrowButtonWithText</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">fb_backArrowButtonWithRightPadding:</span><span>(</span><span style="color:#8959a8;">float</span><span>)</span><span style="color:#f07219;">arg1</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">fb_backArrowButton</span><span>;
</span><span style="color:#8959a8;">@end
</span><span>
</span><span style="color:#8959a8;">@interface </span><span>UIButton (MNLoginFormAppearanceHelpers)
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">phoneFormHeaderButton</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">singleSignOnButton</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">skipButton</span><span>;
</span><span>+ (</span><span style="color:#8959a8;">id</span><span>)</span><span style="color:#4271ae;">formFieldButtonInvertedColors</span><span>;
</span><span style="color:#8959a8;">@end
</span></code></pre>
<p>è¿™æ ·ä¹Ÿä¸ç”¨å…³å¿ƒ fontColorï¼Œmarginï¼ŒbackgroundColor ç­‰ï¼Œç›´æ¥æ‹¿æ¥ç”¨å³å¯ã€‚</p>
<h3 id="qi-ta">å…¶ä»–</h3>
<p>ä»ç›®å½•ç»“æ„ä¸Šæ¥çœ‹ï¼ŒFacebook æœ‰ FBUIKit, FBFoundation, FBAppKit, Moduleã€‚å…¶ä¸­ FBUIKit å’Œ FBFoundation æ˜¯ä¸šåŠ¡æ— å…³çš„ï¼Œå¯ä»¥ç”¨åœ¨å…¶ä»– App ä¸Šï¼ŒFBAppKit å’Œ Module æ˜¯ä¸šåŠ¡ç›¸å…³çš„ã€‚</p>
<p>Module è‡ªå¸¦èµ„æºï¼Œå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ª mini appã€‚</p>
<p>ä½¿ç”¨äº† EGODatabase, SDWebImage, SSZipArchive, CocoaLumberjack è¿™å‡ ä¸ªå¼€æºç±»åº“ï¼ˆå¯èƒ½è¿˜æœ‰æ›´å¤šï¼‰ã€‚</p>
<p>æ—¶é—´å’Œèƒ½åŠ›æœ‰é™ï¼Œåªèƒ½æŒ–æ˜å‡ºè¿™äº›ä¿¡æ¯ï¼Œå¸Œæœ›èƒ½å¸¦æ¥äº›å¸®åŠ©ã€‚</p>

  </div>


  <ul class="tags flex flex-wrap justify-center items-center gap-4 mt-5 mb-8 text-lg">
    
    
    <li
      class="px-4 pb-[2px] leading-8 rounded-full border text-gray-700 border-gray-700 hover:text-gray-100 hover:border-gray-900 hover:bg-gray-900 transition-all">
      <a class="inline-block" href="https://limboy.me/tags/programming/">programming</a>
    </li>
    
    <li
      class="px-4 pb-[2px] leading-8 rounded-full border text-gray-700 border-gray-700 hover:text-gray-100 hover:border-gray-900 hover:bg-gray-900 transition-all">
      <a class="inline-block" href="https://limboy.me/tags/ios/">iOS</a>
    </li>
    
    
  </ul>

  
  <script src="https://giscus.app/client.js" data-repo="limboy/telescope"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzODEwOTA2MTg=" data-category="General"
    data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMzMDY2MTQy" data-mapping="title" data-reactions-enabled="1"
    data-emit-metadata="0" data-theme="light" data-lang="en" crossorigin="anonymous" async>
    </script>
  

  

</div>

      </div>
    </div>
    
    <footer
      class="flex border-t border-gray-300 text-gray-600 bg-gray-50 items-center justify-center h-12 text-sm mt-2">
      <div class="flex inner justify-center gap-4">
        <a class="hover:underline" href="https://github.com/limboy" target="_blank">GitHub</a>
        <a class="hover:underline" href="https://twitter.com/_limboy" target="_blank">Twitter</a>
        <a class="hover:underline" href="https://limboy.me/index.xml">RSS</a>
      </div>
    </footer>
    
  </div>

  
  

  <script>
    // éƒ½æ˜¯ä¸ºäº† iOS...
    document.querySelector("#wrapper").style.minHeight = `calc(${window.innerHeight}px - 6.5rem)`
    window.addEventListener('resize', () => {
      document.querySelector("#wrapper").style.minHeight = `calc(${window.innerHeight}px - 6.5rem)`
    })
  </script>
</body>

</html>